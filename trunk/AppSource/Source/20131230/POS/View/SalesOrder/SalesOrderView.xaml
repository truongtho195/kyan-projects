<UserControl x:Class="CPC.POS.View.SalesOrderView"
             xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             xmlns:Anno="http://schemas.microsoft.com/expression/blend/extensions/annotations/2008"
             xmlns:command="clr-namespace:CPC.Toolkit.Command"
             xmlns:converter="clr-namespace:CPC.Converter"
             xmlns:cpcAddressControl="clr-namespace:CPCToolkitExt.AddressControl;assembly=CPCToolkitExt"
             xmlns:cpcAutoComplete="clr-namespace:CPCToolkitExt.AutoCompleteControl;assembly=CPCToolkitExt"
             xmlns:cpcBehavior="clr-namespace:CPC.Toolkit.Behavior"
             xmlns:cpcComboBox="clr-namespace:CPCToolkitExt.ComboBoxControl;assembly=CPCToolkitExt"
             xmlns:cpcControl="clr-namespace:CPC.Control"
             xmlns:cpcDataGrid="clr-namespace:CPCToolkitExt.DataGridControl;assembly=CPCToolkitExt"
             xmlns:cpcOtherControl="clr-namespace:CPCToolkitExt.OtherControl;assembly=CPCToolkitExt"
             xmlns:cpcTextBox="clr-namespace:CPCToolkitExt.TextBoxControl;assembly=CPCToolkitExt"
             xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
             xmlns:ed="http://schemas.microsoft.com/expression/2010/drawing"
             xmlns:helper="clr-namespace:CPC.Helper"
             xmlns:i="clr-namespace:System.Windows.Interactivity;assembly=System.Windows.Interactivity"
             xmlns:local="clr-namespace:CPC.POS"
             xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
             xmlns:sys="clr-namespace:System;assembly=mscorlib"
             xmlns:wpfToolkit="clr-namespace:Xceed.Wpf.Toolkit;assembly=WPFToolkit.Extended"
             x:Name="ucSaleOrderView"
             Background="{DynamicResource UserControlBackground}"
             helper:ValidationHelper.IsEnabled="True"
             helper:ValidationHelper.IsValid="{Binding IsValid, Mode=OneWayToSource}"
             mc:Ignorable="d Anno">
    <UserControl.Resources>
        <sys:Int32 x:Key="SubTotalMaxLength">10</sys:Int32>
        <sys:Int32 x:Key="DiscountAmountMaxLength">10</sys:Int32>
        <sys:Int32 x:Key="FreightMaxLength">8</sys:Int32>
        <sys:Int32 x:Key="TotalMaxLength">10</sys:Int32>
        <!--  #Region Converter  -->
        <converter:BoolToVisibilityConverter x:Key="boolToVisibilityConverter" />
        <converter:ComboxItemToTextConverter x:Key="comboxItemToTextConverter" />
        <converter:EnumToBoolConverter x:Key="enumToBoolConverter" />
        <converter:ReserseBoolConverter x:Key="reserseBoolConverter" />
        <converter:NullToDefaultValueConverter x:Key="NullToDefaultValueConverter" />
        <converter:StringToImageSourceConverter x:Key="stringToImageSourceConverter" />
        <converter:IntergerToVisibilityConverter x:Key="intergerToVisibilityConverter" />
        <converter:StringFormatConverter x:Key="stringFormatConverter" />
        <converter:PermissionConverter x:Key="permissionConverter" />
        <converter:IntegerToBooleanConverter x:Key="integerToBooleanConverter" />
        <!--  #EndRegion Converter  -->

        <!--  #region ContextMenu  -->
        <ContextMenu x:Key="SaleOrderDetailContextMenu">
            <MenuItem Header="{DynamicResource C126}"
                      Command="{Binding DataContext.EditProductCommand, RelativeSource={RelativeSource AncestorType={x:Type UserControl}, Mode=FindAncestor}}"
                      CommandParameter="{Binding .}"
                      IsEnabled="{Binding ., Converter={StaticResource permissionConverter}, ConverterParameter=SO100-04-14}">
                <MenuItem.Icon>
                    <Rectangle Width="16"
                               Height="16"
                               Fill="{DynamicResource EditItem}"
                               Stretch="Fill" />
                </MenuItem.Icon>
            </MenuItem>
            <MenuItem Header="{DynamicResource C129}"
                      Command="{Binding DataContext.SerialTrackingDetailCommand, RelativeSource={RelativeSource AncestorType={x:Type UserControl}, Mode=FindAncestor}}"
                      CommandParameter="{Binding .}">
                <MenuItem.Visibility>
                    <Binding Path="ProductModel.IsSerialTracking"
                             Mode="OneWay"
                             UpdateSourceTrigger="PropertyChanged">
                        <Binding.Converter>
                            <converter:BoolToVisibilityConverter FalseToVisibility="Collapsed" />
                        </Binding.Converter>
                    </Binding>
                </MenuItem.Visibility>
                <MenuItem.Icon>
                    <Rectangle Width="16"
                               Height="16"
                               Fill="{DynamicResource EditItem}"
                               Stretch="Fill" />
                </MenuItem.Icon>
            </MenuItem>
            <MenuItem Header="{DynamicResource C177}"
                      Command="{Binding DataContext.DeleteSaleOrderDetailCommand, RelativeSource={RelativeSource AncestorType={x:Type UserControl}, Mode=FindAncestor}}"
                      CommandParameter="{Binding .}">
                <MenuItem.Icon>
                    <Rectangle Width="16"
                               Height="16"
                               Fill="{DynamicResource DeleteItem}"
                               Stretch="Fill" />
                </MenuItem.Icon>
            </MenuItem>
        </ContextMenu>
        <ContextMenu x:Key="SaleOrderShipContextMenu">
            <MenuItem Header="{DynamicResource C126}"
                      Command="{Binding DataContext.EditSaleOrderShipCommand, RelativeSource={RelativeSource AncestorType={x:Type UserControl}, Mode=FindAncestor}}"
                      CommandParameter="{Binding .}">
                <MenuItem.Visibility>
                    <Binding Path="IsShipped"
                             Mode="OneWay">
                        <Binding.Converter>
                            <converter:BoolToVisibilityConverter FalseToVisibility="Visible" />
                        </Binding.Converter>
                    </Binding>
                </MenuItem.Visibility>
                <MenuItem.Icon>
                    <Rectangle Width="16"
                               Height="16"
                               Fill="{DynamicResource EditItem}"
                               Stretch="Fill" />
                </MenuItem.Icon>
            </MenuItem>
            <MenuItem Header="{DynamicResource SO_Message_ViewPnPDetail}"
                      Command="{Binding DataContext.ViewPnPDetailCommand, RelativeSource={RelativeSource AncestorType={x:Type UserControl}, Mode=FindAncestor}}"
                      CommandParameter="{Binding .}"
                      ToolTip="{Binding .}">
                <MenuItem.Visibility>
                    <Binding Path="IsShipped"
                             Mode="OneWay">
                        <Binding.Converter>
                            <converter:BoolToVisibilityConverter FalseToVisibility="Collapsed" />
                        </Binding.Converter>
                    </Binding>
                </MenuItem.Visibility>
                <MenuItem.Icon>
                    <Rectangle Width="16"
                               Height="16"
                               Fill="{DynamicResource View}"
                               Stretch="Fill" />
                </MenuItem.Icon>
            </MenuItem>
            <MenuItem Header="{DynamicResource C177}"
                      Command="{Binding DataContext.DeleteSaleOrderShipCommand, RelativeSource={RelativeSource AncestorType={x:Type UserControl}, Mode=FindAncestor}}"
                      CommandParameter="{Binding .}">
                <MenuItem.Icon>
                    <Rectangle Width="16"
                               Height="16"
                               Fill="{DynamicResource DeleteItem}"
                               Stretch="Fill" />
                </MenuItem.Icon>
            </MenuItem>
        </ContextMenu>
        <ContextMenu x:Key="SaleOrderReturnContextMenu">
            <MenuItem Header="{DynamicResource C177}"
                      Command="{Binding DataContext.DeleteReturnDetailCommand, RelativeSource={RelativeSource AncestorType={x:Type UserControl}, Mode=FindAncestor}}"
                      CommandParameter="{Binding .}">
                <MenuItem.Icon>
                    <Rectangle Width="16"
                               Height="16"
                               Fill="{DynamicResource DeleteItem}"
                               Stretch="Fill" />
                </MenuItem.Icon>
            </MenuItem>
        </ContextMenu>

        <ContextMenu x:Key="PaymentContextMenu">
            <MenuItem Header="{DynamicResource Text_ViewPaymentHistory}"
                      Command="{Binding DataContext.PaymentHistoryDetailCommand, RelativeSource={RelativeSource AncestorType={x:Type UserControl}, Mode=FindAncestor}}"
                      CommandParameter="{Binding .}">
                <MenuItem.Icon>
                    <Rectangle Width="16"
                               Height="16"
                               Fill="{DynamicResource View}"
                               Stretch="Fill" />
                </MenuItem.Icon>
            </MenuItem>
        </ContextMenu>


        <!--  #Endregion ContextMenu  -->

        <!--  #Region DataTemplate  -->
        <DataTemplate x:Key="RowDetailDataTemplateOrderInvoice">
            <Grid x:Name="grdTemplateCustomer"
                  Height="Auto"
                  Margin="0"
                  Background="{DynamicResource DatagridRow_Child_Background}">
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="50" />
                    <ColumnDefinition Width="*" />
                </Grid.ColumnDefinitions>
                <Grid.RowDefinitions>
                    <RowDefinition Height="25" />
                </Grid.RowDefinitions>
                <StackPanel Grid.Row="1"
                            Grid.Column="1"
                            Orientation="Horizontal">
                    <StackPanel x:Name="stkpDiscount"
                                Margin="0,0,10,0"
                                HorizontalAlignment="Left"
                                Orientation="Horizontal">
                        <StackPanel.Visibility>
                            <Binding Path="ProductModel.IsCoupon"
                                     Mode="OneWay">
                                <Binding.Converter>
                                    <converter:BoolToVisibilityConverter FalseToVisibility="Visible" />
                                </Binding.Converter>
                            </Binding>
                        </StackPanel.Visibility>
                        <TextBlock x:Name="txtblTemplatePrice"
                                   Margin="0"
                                   HorizontalAlignment="Left"
                                   VerticalAlignment="Center"
                                   FontStyle="Italic"
                                   Foreground="Red"
                                   Text="Regular Price:"
                                   TextWrapping="NoWrap" />
                        <TextBlock x:Name="txtblBindingRegularPrice"
                                   Margin="5,0,0,0"
                                   HorizontalAlignment="Left"
                                   VerticalAlignment="Center"
                                   FontStyle="Italic"
                                   Foreground="Red"
                                   Text="{Binding RegularPrice, Mode=OneWay, ConverterCulture={x:Static local:Define.ConverterCulture}, StringFormat={x:Static local:Define.CurrencyFormat}}"
                                   TextWrapping="NoWrap" />
                        <TextBlock x:Name="txtblUnitDiscount"
                                   Margin="20,0,0,0"
                                   HorizontalAlignment="Left"
                                   VerticalAlignment="Center"
                                   FontStyle="Italic"
                                   Foreground="Red"
                                   Text="Unit Discount:"
                                   TextWrapping="NoWrap" />
                        <TextBlock x:Name="txtblBindingUnitDiscount"
                                   Margin="5,0,0,0"
                                   HorizontalAlignment="Left"
                                   VerticalAlignment="Center"
                                   FontStyle="Italic"
                                   Foreground="Red"
                                   Text="{Binding UnitDiscount, ConverterCulture={x:Static local:Define.ConverterCulture}, StringFormat={x:Static local:Define.CurrencyFormat}}"
                                   TextWrapping="NoWrap" />
                        <TextBlock x:Name="txtblTotalDiscount"
                                   Margin="20,0,0,0"
                                   HorizontalAlignment="Left"
                                   VerticalAlignment="Center"
                                   FontStyle="Italic"
                                   Foreground="Red"
                                   Text="Total Discount:"
                                   TextWrapping="NoWrap" />
                        <TextBlock x:Name="txtblBindingTotalDiscount"
                                   Margin="5,0,0,0"
                                   HorizontalAlignment="Left"
                                   VerticalAlignment="Center"
                                   FontStyle="Italic"
                                   Foreground="Red"
                                   Text="{Binding TotalDiscount, ConverterCulture={x:Static local:Define.ConverterCulture}, StringFormat={x:Static local:Define.CurrencyFormat}}"
                                   TextWrapping="NoWrap" />
                    </StackPanel>
                    <StackPanel x:Name="stkSerial"
                                Height="25"
                                HorizontalAlignment="Left"
                                Orientation="Horizontal">
                        <StackPanel.Visibility>
                            <Binding Path="ProductModel.IsCoupon"
                                     Mode="OneWay">
                                <Binding.Converter>
                                    <converter:BoolToVisibilityConverter FalseToVisibility="Visible" />
                                </Binding.Converter>
                            </Binding>
                        </StackPanel.Visibility>
                        <TextBlock x:Name="txtblTemplateSerialNo"
                                   Margin="0"
                                   HorizontalAlignment="Left"
                                   VerticalAlignment="Center"
                                   FontStyle="Italic"
                                   Foreground="#FF0010FF"
                                   Text="S/N: "
                                   TextDecorations="Underline"
                                   TextWrapping="NoWrap" />
                        <TextBlock x:Name="txSerial"
                                   Margin="0"
                                   HorizontalAlignment="Left"
                                   VerticalAlignment="Center"
                                   FontStyle="Italic"
                                   Foreground="#FF0010FF"
                                   Text="{Binding SerialTrackingDisplay, Mode=OneWay}"
                                   TextDecorations="Underline"
                                   TextWrapping="NoWrap" />
                    </StackPanel>
                    <StackPanel x:Name="stkCoupon"
                                Height="25"
                                HorizontalAlignment="Left"
                                Orientation="Horizontal">
                        <StackPanel.Visibility>
                            <Binding Path="ProductModel.IsCoupon"
                                     Mode="OneWay">
                                <Binding.Converter>
                                    <converter:BoolToVisibilityConverter FalseToVisibility="Collapsed" />
                                </Binding.Converter>
                            </Binding>
                        </StackPanel.Visibility>
                        <TextBlock x:Name="txtblTemplateCoupon"
                                   Margin="0"
                                   HorizontalAlignment="Left"
                                   VerticalAlignment="Center"
                                   FontStyle="Italic"
                                   Foreground="#FF0010FF"
                                   TextDecorations="Underline"
                                   TextWrapping="NoWrap">
                            <Run Text="{Binding ItemName, Mode=OneWay}" /> <Run Text=":" />
                        </TextBlock>
                        <TextBlock x:Name="txCoupon"
                                   Margin="0"
                                   HorizontalAlignment="Left"
                                   VerticalAlignment="Center"
                                   FontStyle="Italic"
                                   Foreground="#FF0010FF"
                                   Text="{Binding SerialTracking, Mode=OneWay}"
                                   TextDecorations="Underline"
                                   TextWrapping="NoWrap" />
                    </StackPanel>
                </StackPanel>
            </Grid>
            <DataTemplate.Triggers>
                <DataTrigger Binding="{Binding SerialTracking}"
                             Value="{x:Static sys:String.Empty}">
                    <Setter TargetName="stkSerial"
                            Property="Visibility"
                            Value="Collapsed" />
                </DataTrigger>
                <DataTrigger Binding="{Binding DiscountPercent}"
                             Value="0">
                    <Setter TargetName="stkpDiscount"
                            Property="Visibility"
                            Value="Collapsed" />
                </DataTrigger>
            </DataTemplate.Triggers>
        </DataTemplate>

        <!--  #EndRegion DataTemplate  -->

        <!--  #Region Style  -->
        <Style x:Key="DataGridDetailRowStyle"
               BasedOn="{StaticResource {x:Type DataGridRow}}"
               TargetType="{x:Type DataGridRow}">
            <Setter Property="cpcBehavior:DataGridCellFocusHelper.CellFocus"
                    Value="{Binding IsAllowChange, Mode=OneWay}" />
            <Setter Property="cpcBehavior:DataGridCellFocusHelper.ItemSource"
                    Value="{Binding ., RelativeSource={RelativeSource Self}}" />
            <Setter Property="ContextMenu"
                    Value="{StaticResource SaleOrderDetailContextMenu}" />
            <Setter Property="Template">
                <Setter.Value>
                    <ControlTemplate TargetType="{x:Type DataGridRow}">
                        <Border x:Name="DGR_Border"
                                Background="{TemplateBinding Background}"
                                BorderBrush="{TemplateBinding BorderBrush}"
                                BorderThickness="{TemplateBinding BorderThickness}">
                            <SelectiveScrollingGrid>
                                <SelectiveScrollingGrid.ColumnDefinitions>
                                    <ColumnDefinition Width="Auto" />
                                    <ColumnDefinition Width="*" />
                                </SelectiveScrollingGrid.ColumnDefinitions>
                                <SelectiveScrollingGrid.RowDefinitions>
                                    <RowDefinition Height="*" />
                                    <RowDefinition Height="Auto" />
                                </SelectiveScrollingGrid.RowDefinitions>
                                <DataGridCellsPresenter Grid.Column="1"
                                                        ItemsPanel="{TemplateBinding ItemsPanel}"
                                                        SnapsToDevicePixels="{TemplateBinding SnapsToDevicePixels}" />
                                <!--  Visibility="{TemplateBinding DetailsVisibility}">  -->
                                <DataGridDetailsPresenter Grid.Row="1"
                                                          Grid.Column="1"
                                                          SelectiveScrollingGrid.SelectiveScrollingOrientation="{Binding AreRowDetailsFrozen, ConverterParameter={x:Static SelectiveScrollingOrientation.Vertical}, Converter={x:Static DataGrid.RowDetailsScrollingConverter}, RelativeSource={RelativeSource AncestorType={x:Type DataGrid}}}">
                                    <DataGridDetailsPresenter.Visibility>
                                        <Binding Path="IsVisibleRowDetail"
                                                 Mode="OneWay">
                                            <Binding.Converter>
                                                <converter:BoolToVisibilityConverter FalseToVisibility="Collapsed" />
                                            </Binding.Converter>
                                        </Binding>
                                    </DataGridDetailsPresenter.Visibility>
                                </DataGridDetailsPresenter>
                                <DataGridRowHeader Grid.RowSpan="2"
                                                   SelectiveScrollingGrid.SelectiveScrollingOrientation="Vertical"
                                                   Style="{DynamicResource DataGridRowHeaderStyle}" />
                            </SelectiveScrollingGrid>
                        </Border>
                    </ControlTemplate>
                </Setter.Value>
            </Setter>
            <Style.Triggers>
                <!--  Set Color for parent item  -->
                <DataTrigger Binding="{Binding ItemType, Converter={StaticResource integerToBooleanConverter}, ConverterParameter=1}"
                             Value="True">

                    <Setter Property="Background"
                            Value="{DynamicResource DatagridRow_Group_Background}" />
                    <Setter Property="FontWeight"
                            Value="Bold" />
                    <Setter Property="Foreground"
                            Value="#FFFF0000" />
                </DataTrigger>
                <!--  Set Color for Children item  -->
                <DataTrigger Binding="{Binding ItemType, Converter={StaticResource integerToBooleanConverter}, ConverterParameter=2}"
                             Value="True">
                    <Setter Property="Background"
                            Value="{DynamicResource DatagridRow_Child_Background}" />

                </DataTrigger>
            </Style.Triggers>
        </Style>

        <Style x:Key="DataGridShipMenuContextRowStyle"
               BasedOn="{StaticResource {x:Type DataGridRow}}"
               TargetType="{x:Type DataGridRow}">
            <Setter Property="cpcBehavior:DataGridCellFocusHelper.CellFocus"
                    Value="{Binding IsShipped, Mode=OneWay, Converter={StaticResource reserseBoolConverter}}" />
            <Setter Property="cpcBehavior:DataGridCellFocusHelper.ItemSource"
                    Value="{Binding ., RelativeSource={RelativeSource Self}}" />
            <Setter Property="ContextMenu"
                    Value="{StaticResource SaleOrderShipContextMenu}" />
            <Setter Property="Template">
                <Setter.Value>
                    <ControlTemplate TargetType="{x:Type DataGridRow}">
                        <Border x:Name="DGR_Border"
                                Background="{TemplateBinding Background}"
                                BorderBrush="{TemplateBinding BorderBrush}"
                                BorderThickness="{TemplateBinding BorderThickness}"
                                SnapsToDevicePixels="True">
                            <SelectiveScrollingGrid>
                                <SelectiveScrollingGrid.ColumnDefinitions>
                                    <ColumnDefinition Width="Auto" />
                                    <ColumnDefinition Width="*" />
                                </SelectiveScrollingGrid.ColumnDefinitions>
                                <SelectiveScrollingGrid.RowDefinitions>
                                    <RowDefinition Height="*" />
                                    <RowDefinition Height="Auto" />
                                </SelectiveScrollingGrid.RowDefinitions>
                                <DataGridCellsPresenter Grid.Column="1"
                                                        ItemsPanel="{TemplateBinding ItemsPanel}"
                                                        SnapsToDevicePixels="{TemplateBinding SnapsToDevicePixels}" />
                                <DataGridDetailsPresenter Grid.Row="1"
                                                          Grid.Column="1"
                                                          Visibility="{TemplateBinding DetailsVisibility}" />
                                <DataGridRowHeader Grid.RowSpan="2"
                                                   SelectiveScrollingGrid.SelectiveScrollingOrientation="Vertical"
                                                   Style="{DynamicResource DataGridRowHeaderStyle}" />
                            </SelectiveScrollingGrid>
                        </Border>
                    </ControlTemplate>
                </Setter.Value>
            </Setter>
        </Style>

        <Style x:Key="DataGridPaymentRowStyle"
               BasedOn="{StaticResource {x:Type DataGridRow}}"
               TargetType="{x:Type DataGridRow}">
            <Style.Triggers>
                <DataTrigger Binding="{Binding IsDeposit, Mode=OneWay}"
                             Value="True">
                    <Setter Property="Foreground"
                            Value="Red" />
                    <Setter Property="TextElement.FontStyle"
                            Value="Italic" />
                </DataTrigger>
            </Style.Triggers>
            <Setter Property="ContextMenu"
                    Value="{StaticResource PaymentContextMenu}" />
            <Setter Property="Template">
                <Setter.Value>
                    <ControlTemplate TargetType="{x:Type DataGridRow}">
                        <Border x:Name="DGR_Border"
                                Background="{TemplateBinding Background}"
                                BorderBrush="{TemplateBinding BorderBrush}"
                                BorderThickness="{TemplateBinding BorderThickness}"
                                SnapsToDevicePixels="True">
                            <SelectiveScrollingGrid>
                                <SelectiveScrollingGrid.ColumnDefinitions>
                                    <ColumnDefinition Width="Auto" />
                                    <ColumnDefinition Width="*" />
                                </SelectiveScrollingGrid.ColumnDefinitions>
                                <SelectiveScrollingGrid.RowDefinitions>
                                    <RowDefinition Height="*" />
                                    <RowDefinition Height="Auto" />
                                </SelectiveScrollingGrid.RowDefinitions>
                                <DataGridCellsPresenter Grid.Column="1"
                                                        ItemsPanel="{TemplateBinding ItemsPanel}"
                                                        SnapsToDevicePixels="{TemplateBinding SnapsToDevicePixels}" />
                                <DataGridDetailsPresenter Grid.Row="1"
                                                          Grid.Column="1"
                                                          Visibility="{TemplateBinding DetailsVisibility}" />
                                <DataGridRowHeader Grid.RowSpan="2"
                                                   SelectiveScrollingGrid.SelectiveScrollingOrientation="Vertical"
                                                   Style="{DynamicResource DataGridRowHeaderStyle}" />
                            </SelectiveScrollingGrid>
                        </Border>
                    </ControlTemplate>
                </Setter.Value>
            </Setter>
        </Style>
        <Style x:Key="DataGridReturnRowStyle"
               BasedOn="{StaticResource {x:Type DataGridRow}}"
               TargetType="{x:Type DataGridRow}">
            <Setter Property="cpcBehavior:DataGridCellFocusHelper.CellFocus"
                    Value="{Binding IsReturned, Mode=OneWay, Converter={StaticResource reserseBoolConverter}}" />
            <Setter Property="cpcBehavior:DataGridCellFocusHelper.ItemSource"
                    Value="{Binding ., RelativeSource={RelativeSource Self}}" />
            <Setter Property="ContextMenu"
                    Value="{StaticResource SaleOrderReturnContextMenu}" />
            <Setter Property="Template">
                <Setter.Value>
                    <ControlTemplate TargetType="{x:Type DataGridRow}">
                        <Border x:Name="DGR_Border"
                                Background="{TemplateBinding Background}"
                                BorderBrush="{TemplateBinding BorderBrush}"
                                BorderThickness="{TemplateBinding BorderThickness}"
                                SnapsToDevicePixels="True">
                            <SelectiveScrollingGrid>
                                <SelectiveScrollingGrid.ColumnDefinitions>
                                    <ColumnDefinition Width="Auto" />
                                    <ColumnDefinition Width="*" />
                                </SelectiveScrollingGrid.ColumnDefinitions>
                                <SelectiveScrollingGrid.RowDefinitions>
                                    <RowDefinition Height="*" />
                                    <RowDefinition Height="Auto" />
                                </SelectiveScrollingGrid.RowDefinitions>
                                <DataGridCellsPresenter Grid.Column="1"
                                                        ItemsPanel="{TemplateBinding ItemsPanel}"
                                                        SnapsToDevicePixels="{TemplateBinding SnapsToDevicePixels}" />
                                <DataGridDetailsPresenter x:Name="dgDetails"
                                                          Grid.Row="1"
                                                          Grid.Column="1"
                                                          Visibility="{TemplateBinding DetailsVisibility}" />
                                <DataGridRowHeader Grid.RowSpan="2"
                                                   SelectiveScrollingGrid.SelectiveScrollingOrientation="Vertical"
                                                   Style="{DynamicResource DataGridRowHeaderStyle}" />
                            </SelectiveScrollingGrid>
                        </Border>

                    </ControlTemplate>
                </Setter.Value>
            </Setter>

        </Style>
        <Style x:Key="ComboBoxTextStyle"
               TargetType="{x:Type ComboBox}">
            <Setter Property="Focusable"
                    Value="False" />
            <Setter Property="cpcBehavior:MoveFocusHelper.MoveFocus"
                    Value="True" />
            <!--
                <Setter Property="FocusVisualStyle"
                Value="{StaticResource ComboBoxFocusVisual}" />
            -->
            <Setter Property="Foreground"
                    Value="{DynamicResource {x:Static SystemColors.WindowTextBrushKey}}" />
            <Setter Property="Background"
                    Value="{DynamicResource {x:Static SystemColors.WindowBrushKey}}" />
            <Setter Property="BorderThickness"
                    Value="1" />
            <Setter Property="Padding"
                    Value="1" />
            <Setter Property="ScrollViewer.HorizontalScrollBarVisibility"
                    Value="Auto" />
            <Setter Property="ScrollViewer.VerticalScrollBarVisibility"
                    Value="Auto" />
            <Setter Property="ScrollViewer.CanContentScroll"
                    Value="true" />
            <Setter Property="ScrollViewer.PanningMode"
                    Value="Both" />
            <Setter Property="Stylus.IsFlicksEnabled"
                    Value="False" />
            <Setter Property="VerticalContentAlignment"
                    Value="Center" />
            <Setter Property="Validation.ErrorTemplate"
                    Value="{x:Null}" />
            <Setter Property="Template">
                <Setter.Value>
                    <ControlTemplate TargetType="{x:Type ComboBox}">
                        <Grid SnapsToDevicePixels="true">
                            <Border x:Name="Bd"
                                    Background="{TemplateBinding Background}"
                                    BorderBrush="{TemplateBinding BorderBrush}"
                                    BorderThickness="{TemplateBinding BorderThickness}">
                                <Grid Grid.IsSharedSizeScope="true">
                                    <Grid.ColumnDefinitions>
                                        <ColumnDefinition Width="1" />
                                        <ColumnDefinition />
                                        <ColumnDefinition Width="0"
                                                          SharedSizeGroup="ComboBoxButton" />
                                    </Grid.ColumnDefinitions>
                                    <Border x:Name="SelectedItemBorder"
                                            Grid.ColumnSpan="2"
                                            Margin="{TemplateBinding Padding}" />
                                    <ContentPresenter Grid.Column="1"
                                                      Margin="{TemplateBinding Padding}"
                                                      HorizontalAlignment="{TemplateBinding HorizontalContentAlignment}"
                                                      VerticalAlignment="{TemplateBinding VerticalContentAlignment}"
                                                      Content="{TemplateBinding SelectionBoxItem}"
                                                      ContentStringFormat="{TemplateBinding SelectionBoxItemStringFormat}"
                                                      ContentTemplate="{TemplateBinding SelectionBoxItemTemplate}"
                                                      ContentTemplateSelector="{TemplateBinding ItemTemplateSelector}"
                                                      SnapsToDevicePixels="{TemplateBinding SnapsToDevicePixels}" />
                                    <ToggleButton Grid.ColumnSpan="3"
                                                  IsChecked="{Binding IsDropDownOpen, Mode=TwoWay, RelativeSource={RelativeSource TemplatedParent}}"
                                                  Style="{StaticResource ComboBoxTransparentButtonStyle}" />
                                </Grid>
                            </Border>
                        </Grid>
                        <ControlTemplate.Triggers>
                            <Trigger Property="HasItems"
                                     Value="false" />
                            <Trigger Property="IsEnabled"
                                     Value="false">
                                <Setter Property="Foreground"
                                        Value="{DynamicResource {x:Static SystemColors.GrayTextBrushKey}}" />
                                <Setter TargetName="Bd"
                                        Property="Background"
                                        Value="{DynamicResource {x:Static SystemColors.ControlBrushKey}}" />
                            </Trigger>
                            <Trigger Property="IsGrouping"
                                     Value="true">
                                <Setter Property="ScrollViewer.CanContentScroll"
                                        Value="false" />
                            </Trigger>
                            <Trigger Property="Validation.HasError"
                                     Value="True">
                                <Setter TargetName="Bd"
                                        Property="BorderBrush"
                                        Value="#FFFF0000" />
                            </Trigger>
                        </ControlTemplate.Triggers>
                    </ControlTemplate>
                </Setter.Value>
            </Setter>
            <Setter Property="FontSize"
                    Value="11" />
            <Setter Property="BorderBrush"
                    Value="{DynamicResource TextBoxCanlendarComboboxBorderBrush}" />
            <Style.Triggers>
                <Trigger Property="IsEditable"
                         Value="true">
                    <Setter Property="IsTabStop"
                            Value="false" />
                    <Setter Property="Padding"
                            Value="0,1" />
                    <Setter Property="Template"
                            Value="{StaticResource ComboBoxEditableTemplate}" />
                </Trigger>
            </Style.Triggers>
        </Style>
        <Style x:Key="NumberTextBlock"
               TargetType="{x:Type TextBlock}">
            <Setter Property="HorizontalAlignment"
                    Value="Right" />
        </Style>
        <Style x:Key="CenterTextColumn"
               TargetType="{x:Type TextBlock}">
            <Setter Property="HorizontalAlignment"
                    Value="Center" />
        </Style>
        <Style x:Key="ReturnedTextBlockStyle"
               BasedOn="{StaticResource TextBlockNormal}"
               TargetType="{x:Type TextBlock}">
            <Setter Property="Foreground"
                    Value="Green" />
            <Setter Property="HorizontalAlignment"
                    Value="Center" />
            <Setter Property="FontWeight"
                    Value="Bold" />
            <Style.Triggers>
                <DataTrigger Binding="{Binding IsReturned, Mode=OneWay}"
                             Value="True">
                    <Setter Property="Foreground"
                            Value="Red" />
                </DataTrigger>
            </Style.Triggers>
        </Style>
        <Style x:Key="DataGridPriceCellStyle"
               BasedOn="{StaticResource DataGridCellDisableStyle}"
               TargetType="{x:Type DataGridCell}">
            <Setter Property="cpcBehavior:DataGridCellFocusHelper.CellFocus"
                    Value="{Binding ProductModel.IsOpenItem}" />
            <Setter Property="cpcBehavior:DataGridCellFocusHelper.ItemSource"
                    Value="{Binding ., RelativeSource={RelativeSource Self}}" />

            <Style.Triggers>
                <Trigger Property="IsSelected"
                         Value="True">
                    <Setter Property="BorderThickness"
                            Value="0" />
                    <Setter Property="Foreground"
                            Value="{DynamicResource DatagridCell_IsSelected_Foreground}" />
                    <Setter Property="Background"
                            Value="{DynamicResource DatagridCell_IsSelected_Background}" />
                </Trigger>
                <DataTrigger Binding="{Binding ProductModel.IsOpenItem}"
                             Value="True">
                    <Setter Property="Foreground"
                            Value="{DynamicResource ForegroundGreenBrush}" />
                    <Setter Property="FontWeight"
                            Value="Bold" />
                </DataTrigger>
                <!--
                    <DataTrigger Binding="{Binding ProductModel.IsOpenItem}"
                    Value="False">
                    <Setter Property="Foreground"
                    Value="{DynamicResource DatagridCell_IsSelected_Foreground}" />
                    </DataTrigger>
                -->
            </Style.Triggers>
        </Style>
        <Style x:Key="DataGridQuantityCellStyle"
               BasedOn="{StaticResource DataGridCellDisableStyle}"
               TargetType="{x:Type DataGridCell}">
            <Setter Property="cpcBehavior:DataGridCellFocusHelper.CellFocus"
                    Value="{Binding ProductModel.IsCoupon, Mode=OneWay, Converter={StaticResource reserseBoolConverter}}" />
            <Setter Property="cpcBehavior:DataGridCellFocusHelper.ItemSource"
                    Value="{Binding ., RelativeSource={RelativeSource Self}}" />
            <Style.Triggers>
                <Trigger Property="IsSelected"
                         Value="True">
                    <Setter Property="BorderThickness"
                            Value="0" />
                    <Setter Property="Foreground"
                            Value="{DynamicResource DatagridCell_IsSelected_Foreground}" />
                    <Setter Property="Background"
                            Value="{DynamicResource DatagridCell_IsSelected_Background}" />
                </Trigger>
                <DataTrigger Binding="{Binding ProductModel.IsOpenItem}"
                             Value="True">
                    <Setter Property="Foreground"
                            Value="{DynamicResource ForegroundGreenBrush}" />
                    <Setter Property="FontWeight"
                            Value="Bold" />
                </DataTrigger>
                <!--
                    <DataTrigger Binding="{Binding ProductModel.IsOpenItem}"
                    Value="False">
                    <Setter Property="Foreground"
                    Value="{DynamicResource DatagridCell_IsSelected_Foreground}" />
                    </DataTrigger>
                -->
            </Style.Triggers>
        </Style>
        <Style x:Key="DataGridUOMCellStyle"
               BasedOn="{StaticResource DataGridCellDisableStyle}"
               TargetType="{x:Type DataGridCell}">
            <Setter Property="cpcBehavior:DataGridCellFocusHelper.CellFocus"
                    Value="{Binding IsReadOnlyUOM, Mode=OneWay, Converter={StaticResource reserseBoolConverter}}" />
            <Setter Property="cpcBehavior:DataGridCellFocusHelper.ItemSource"
                    Value="{Binding ., RelativeSource={RelativeSource Self}}" />
            <Style.Triggers>
                <Trigger Property="IsSelected"
                         Value="True">
                    <Setter Property="BorderThickness"
                            Value="0" />
                    <Setter Property="Foreground"
                            Value="{DynamicResource DatagridCell_IsSelected_Foreground}" />
                    <Setter Property="Background"
                            Value="{DynamicResource DatagridCell_IsSelected_Background}" />
                </Trigger>
            </Style.Triggers>
        </Style>
        <Style x:Key="ListViewItemColorStyle"
               TargetType="{x:Type ListViewItem}">
            <!--
                <Setter Property="VerticalContentAlignment"
                Value="Center" />
            -->
            <Style.Triggers>
                <DataTrigger Binding="{Binding IsOpenItem}"
                             Value="True">
                    <Setter Property="Foreground"
                            Value="{DynamicResource ForegroundGreenBrush}" />
                    <Setter Property="FontWeight"
                            Value="Bold" />
                </DataTrigger>
            </Style.Triggers>
        </Style>


        <!--  #EndRegion Style  -->
    </UserControl.Resources>
    <UserControl.InputBindings>
        <KeyBinding Command="{Binding HelpCommand}"
                    Gesture="F1" />
    </UserControl.InputBindings>
    <wpfToolkit:BusyIndicator IsBusy="{Binding IsBusy, Mode=OneWay}">
        <Grid x:Name="GridLayout">
            <Rectangle x:Name="UserControl_Background_Image"
                       Fill="{DynamicResource UserControl_Background_Image}" />
            <Grid x:Name="grdSaleOrder">
                <!--  Search Grid  -->
                <Grid x:Name="grdContentSearch"
                      d:IsHidden="True">
                    <Grid.Visibility>
                        <Binding Path="IsSearchMode"
                                 Mode="OneWay"
                                 UpdateSourceTrigger="PropertyChanged">
                            <Binding.Converter>
                                <converter:BoolToVisibilityConverter FalseToVisibility="Collapsed" />
                            </Binding.Converter>
                        </Binding>
                    </Grid.Visibility>
                    <Grid.RowDefinitions>
                        <RowDefinition Height="85" />
                        <RowDefinition />
                    </Grid.RowDefinitions>
                    <GroupBox x:Name="gbSearch"
                              Margin="10,10,10,0">
                        <GroupBox.Header>
                            <TextBlock x:Name="txtblSearch"
                                       Style="{DynamicResource GroupboxTextBlock}"
                                       Text="{DynamicResource C113}"
                                       TextWrapping="NoWrap" />
                        </GroupBox.Header>
                        <Grid x:Name="grdgbSearch"
                              Margin="0,4,0,0">
                            <Grid x:Name="grdgbContentSearch">
                                <Grid.RowDefinitions>
                                    <RowDefinition Height="25" />
                                    <RowDefinition Height="25" />
                                    <RowDefinition Height="Auto" />
                                </Grid.RowDefinitions>
                                <wpfToolkit:WatermarkTextBox x:Name="txtKeyword"
                                                             Margin="10,2,0,2"
                                                             VerticalContentAlignment="Center"
                                                             BorderBrush="{DynamicResource TextBoxCanlendarComboboxBorderBrush}"
                                                             Padding="24,0,5,0"
                                                             Text="{Binding FilterText, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}"
                                                             TextWrapping="NoWrap"
                                                             Watermark="{DynamicResource C135}">
                                    <i:Interaction.Behaviors>
                                        <cpcBehavior:AutoFocusBehavior />
                                    </i:Interaction.Behaviors>
                                    <wpfToolkit:WatermarkTextBox.InputBindings>
                                        <KeyBinding Key="Enter"
                                                    Command="{Binding SearchCommand}"
                                                    CommandParameter="{Binding Text, ElementName=txtKeyword}" />
                                    </wpfToolkit:WatermarkTextBox.InputBindings>
                                </wpfToolkit:WatermarkTextBox>
                                <Rectangle x:Name="imgFind1"
                                           Width="19"
                                           Height="19"
                                           Margin="13,3,0,3"
                                           HorizontalAlignment="Left"
                                           Fill="{DynamicResource Find}" />
                                <Button x:Name="btnAdvanceSearch"
                                        Command="{Binding SaleOrderAdvanceSearchCommand}"
                                        Grid.Row="1"
                                        Width="100"
                                        Height="20"
                                        Margin="10,0,0,0"
                                        HorizontalAlignment="Left"
                                        VerticalAlignment="Center"
                                        Content="{DynamicResource C104}"
                                        Style="{DynamicResource ButtonAdvanceSearch}" />
                            </Grid>
                        </Grid>
                    </GroupBox>
                    <cpcDataGrid:DataGridControl x:Name="dtgrdSearch"
                                                 Command="{Binding LoadStepCommand}"
                                                 Grid.Row="3"
                                                 Margin="10,10.2,10,10"
                                                 VerticalAlignment="Stretch"
                                                 AutoGenerateColumns="False"
                                                 CanUserAddRows="False"
                                                 CanUserDeleteRows="False"
                                                 cpcBehavior:DoubleClickCommandBehavior.CanDoubleClickOnChild="False"
                                                 cpcBehavior:DoubleClickCommandBehavior.DoubleClickCommand="{Binding DoubleClickViewCommand}"
                                                 cpcBehavior:DoubleClickCommandBehavior.DoubleClickCommandParameter="{Binding SelectedItem, ElementName=dtgrdSearch}"
                                                 DeleteCommandParameter="{Binding SelectedItems, ElementName=dtgrdSearch}"
                                                 DeleteItemCommand="{Binding DeleteItemsWithKeyCommand}"
                                                 DisplayItems="{Binding NumberOfDisplayItems}"
                                                 IsPaging="True"
                                                 IsReadOnly="True"
                                                 IsRollBackData="False"
                                                 ItemsSource="{Binding SaleOrderCollection, IsAsync=True}"
                                                 NumberOfItems="{Binding TotalSaleOrder}"
                                                 SelectionMode="Extended"
                                                 Style="{DynamicResource DatagridWithRowHeader}">
                        <cpcDataGrid:DataGridControl.ContextMenu>
                            <ContextMenu Tag="{Binding PlacementTarget, RelativeSource={RelativeSource Mode=Self}}">
                                <MenuItem Header="New Item"
                                          Command="{Binding NewCommand}"
                                          IsEnabled="{Binding ., ConverterParameter=SO100-04-02, Converter={StaticResource permissionConverter}}">
                                    <MenuItem.Icon>
                                        <Rectangle Width="16"
                                                   Height="16"
                                                   Fill="{DynamicResource NewItem}"
                                                   Stretch="Fill" />
                                    </MenuItem.Icon>
                                </MenuItem>
                                <MenuItem Header="Edit Item"
                                          Command="{Binding EditItemCommand}"
                                          CommandParameter="{Binding Tag, RelativeSource={RelativeSource AncestorType={x:Type ContextMenu}, Mode=FindAncestor}}">
                                    <MenuItem.Icon>
                                        <Rectangle Width="16"
                                                   Height="16"
                                                   Fill="{DynamicResource EditItem}"
                                                   Stretch="Fill" />
                                    </MenuItem.Icon>
                                </MenuItem>
                                <MenuItem Header="Delete Item (s)"
                                          Command="{Binding DeleteItemsCommand}"
                                          CommandParameter="{Binding Tag, RelativeSource={RelativeSource AncestorType={x:Type ContextMenu}, Mode=FindAncestor}}"
                                          IsEnabled="{Binding ., ConverterParameter=SO100-04-03, Converter={StaticResource permissionConverter}}">
                                    <MenuItem.Icon>
                                        <Rectangle Width="16"
                                                   Height="16"
                                                   Fill="{DynamicResource DeleteItem}"
                                                   Stretch="Fill" />
                                    </MenuItem.Icon>
                                </MenuItem>
                                <!--
                                    <MenuItem Command="{Binding DuplicateItemCommand}"
                                    CommandParameter="{Binding Tag,
                                    RelativeSource={RelativeSource AncestorType={x:Type ContextMenu},
                                    Mode=FindAncestor}}"
                                    Header="Duplicate Item"
                                    IsEnabled="{Binding .,
                                    ConverterParameter=SO100-04-02,
                                    Converter={StaticResource permissionConverter}}">
                                    <MenuItem.Icon>
                                    <Rectangle Width="16"
                                    Height="16"
                                    Fill="{DynamicResource DuplicateItem}"
                                    Stretch="Fill" />
                                    </MenuItem.Icon>
                                    </MenuItem>
                                -->
                            </ContextMenu>
                        </cpcDataGrid:DataGridControl.ContextMenu>
                        <cpcDataGrid:DataGridControl.Columns>

                            <DataGridTextColumn Binding="{Binding SONumber, Mode=OneWay}"
                                                Width="85"
                                                IsReadOnly="True">
                                <DataGridTextColumn.Header>
                                    <TextBlock Text="{DynamicResource SO_TextBlock_SaleOrderNum}" />
                                </DataGridTextColumn.Header>
                            </DataGridTextColumn>
                            <DataGridTextColumn Binding="{Binding OrderDate, Mode=OneWay, StringFormat={x:Static local:Define.DateFormat}}"
                                                Width="70"
                                                ElementStyle="{StaticResource CenterTextColumn}"
                                                IsReadOnly="True"
                                                SortDirection="Descending"
                                                SortMemberPath="OrderDate">
                                <DataGridTextColumn.Header>
                                    <TextBlock Text="{DynamicResource C148}" />
                                </DataGridTextColumn.Header>
                            </DataGridTextColumn>
                            <DataGridTextColumn Binding="{Binding ItemStatus.Text, Mode=OneWay, IsAsync=True}"
                                                Width="100"
                                                IsReadOnly="True">
                                <DataGridTextColumn.Header>
                                    <TextBlock Text="{DynamicResource C151}" />
                                </DataGridTextColumn.Header>
                            </DataGridTextColumn>
                            <DataGridTextColumn Binding="{Binding GuestModel.LegalName, Mode=OneWay}"
                                                Width="150"
                                                IsReadOnly="True">
                                <DataGridTextColumn.Header>
                                    <TextBlock Text="{DynamicResource SO_TextBlock_Customer}" />
                                </DataGridTextColumn.Header>
                            </DataGridTextColumn>
                            <DataGridTemplateColumn Width="80"
                                                    IsReadOnly="True">
                                <DataGridTemplateColumn.Header>
                                    <TextBlock Text="{DynamicResource C103}" />
                                </DataGridTemplateColumn.Header>
                                <DataGridTemplateColumn.CellTemplate>
                                    <DataTemplate>
                                        <TextBlock HorizontalAlignment="Right"
                                                   Text="{Binding Total, ConverterCulture={x:Static local:Define.ConverterCulture}, Mode=OneWay, StringFormat={x:Static local:Define.CurrencyFormat}}" />
                                    </DataTemplate>
                                </DataGridTemplateColumn.CellTemplate>
                            </DataGridTemplateColumn>
                            <DataGridTemplateColumn Width="80"
                                                    IsReadOnly="True">
                                <DataGridTemplateColumn.Header>
                                    <TextBlock Text="{DynamicResource C107}" />
                                </DataGridTemplateColumn.Header>
                                <DataGridTemplateColumn.CellTemplate>
                                    <DataTemplate>
                                        <TextBlock HorizontalAlignment="Right"
                                                   Text="{Binding Paid, ConverterCulture={x:Static local:Define.ConverterCulture}, Mode=OneWay, StringFormat={x:Static local:Define.CurrencyFormat}}" />
                                    </DataTemplate>
                                </DataGridTemplateColumn.CellTemplate>
                            </DataGridTemplateColumn>
                            <DataGridTemplateColumn Width="80"
                                                    IsReadOnly="True">
                                <DataGridTemplateColumn.Header>
                                    <TextBlock Text="{DynamicResource SO_TextBlock_Deposit}" />
                                </DataGridTemplateColumn.Header>
                                <DataGridTemplateColumn.CellTemplate>
                                    <DataTemplate>
                                        <TextBlock HorizontalAlignment="Right"
                                                   Text="{Binding Deposit, ConverterCulture={x:Static local:Define.ConverterCulture}, Mode=OneWay, StringFormat={x:Static local:Define.CurrencyFormat}}" />
                                    </DataTemplate>
                                </DataGridTemplateColumn.CellTemplate>
                            </DataGridTemplateColumn>
                            <DataGridTemplateColumn Width="80"
                                                    IsReadOnly="True">
                                <DataGridTemplateColumn.Header>
                                    <TextBlock Text="{DynamicResource C108}" />
                                </DataGridTemplateColumn.Header>
                                <DataGridTemplateColumn.CellTemplate>
                                    <DataTemplate>
                                        <TextBlock HorizontalAlignment="Right"
                                                   Text="{Binding Balance, ConverterCulture={x:Static local:Define.ConverterCulture}, Mode=OneWay, StringFormat={x:Static local:Define.CurrencyFormat}}" />
                                    </DataTemplate>
                                </DataGridTemplateColumn.CellTemplate>
                            </DataGridTemplateColumn>
                            <DataGridTemplateColumn Width="80"
                                                    IsReadOnly="True">
                                <DataGridTemplateColumn.Header>
                                    <TextBlock Text="{DynamicResource SO_TextBlock_RefundFee}" />
                                </DataGridTemplateColumn.Header>
                                <DataGridTemplateColumn.CellTemplate>
                                    <DataTemplate>
                                        <TextBlock HorizontalAlignment="Right"
                                                   Text="{Binding RefundedAmount, ConverterCulture={x:Static local:Define.ConverterCulture}, Mode=OneWay, StringFormat={x:Static local:Define.CurrencyFormat}}" />
                                    </DataTemplate>
                                </DataGridTemplateColumn.CellTemplate>
                            </DataGridTemplateColumn>
                            <DataGridTextColumn Binding="{Binding PriceLevelItem.Text, Mode=OneWay}"
                                                Width="80">
                                <DataGridTextColumn.Header>
                                    <TextBlock Text="{DynamicResource C157}" />
                                </DataGridTextColumn.Header>
                            </DataGridTextColumn>
                            <DataGridTemplateColumn Width="100">
                                <DataGridTemplateColumn.Header>
                                    <TextBlock Text="{DynamicResource C155}" />
                                </DataGridTemplateColumn.Header>
                                <DataGridTemplateColumn.CellTemplate>
                                    <DataTemplate>
                                        <ComboBox x:Name="cmbStoreCode"
                                                  Grid.Row="2"
                                                  Grid.Column="5"
                                                  Width="110"
                                                  Margin="0,2"
                                                  HorizontalAlignment="Left"
                                                  VerticalAlignment="Stretch"
                                                  Background="Transparent"
                                                  BorderBrush="Transparent"
                                                  DisplayMemberPath="Name"
                                                  ItemsSource="{Binding DataContext.StoreCollection, IsAsync=True, RelativeSource={RelativeSource AncestorType={x:Type UserControl}, Mode=FindAncestor}}"
                                                  SelectedIndex="{Binding StoreCode, IsAsync=True, Mode=OneWay}"
                                                  SelectedValuePath="Id"
                                                  Style="{DynamicResource ComboBoxTextStyle}" />
                                    </DataTemplate>
                                </DataGridTemplateColumn.CellTemplate>
                            </DataGridTemplateColumn>
                            <DataGridTemplateColumn Width="100">
                                <DataGridTemplateColumn.Header>
                                    <TextBlock Text="{DynamicResource SO_TextBlock_TaxLocation}" />
                                </DataGridTemplateColumn.Header>
                                <DataGridTemplateColumn.CellTemplate>
                                    <DataTemplate>
                                        <Grid>
                                            <TextBlock x:Name="tbTaxLocation"
                                                       Text="{Binding TaxLocationModel.Name}"
                                                       Visibility="Collapsed" />
                                            <TextBlock x:Name="tbTaxExemption"
                                                       Text="{DynamicResource SO_TextBlock_TaxExemptionDisplay}" />
                                        </Grid>
                                        <DataTemplate.Triggers>
                                            <DataTrigger Binding="{Binding TaxExemption}"
                                                         Value="{x:Static sys:String.Empty}">
                                                <Setter TargetName="tbTaxLocation"
                                                        Property="Visibility"
                                                        Value="Visible" />
                                                <Setter TargetName="tbTaxExemption"
                                                        Property="Visibility"
                                                        Value="Collapsed" />
                                            </DataTrigger>
                                        </DataTemplate.Triggers>
                                    </DataTemplate>
                                </DataGridTemplateColumn.CellTemplate>
                            </DataGridTemplateColumn>
                            <DataGridTemplateColumn Width="80">
                                <DataGridTemplateColumn.Header>
                                    <TextBlock Text="{DynamicResource C144}" />
                                </DataGridTemplateColumn.Header>
                                <DataGridTemplateColumn.CellTemplate>
                                    <DataTemplate>
                                        <Grid>
                                            <TextBlock x:Name="tbTaxCode"
                                                       Text="{Binding TaxCode}"
                                                       Visibility="Collapsed" />
                                            <TextBlock x:Name="tbTaxExemption"
                                                       Text="{Binding TaxExemption}" />
                                        </Grid>
                                        <DataTemplate.Triggers>
                                            <DataTrigger Binding="{Binding TaxExemption}"
                                                         Value="{x:Static sys:String.Empty}">
                                                <Setter TargetName="tbTaxCode"
                                                        Property="Visibility"
                                                        Value="Visible" />
                                                <Setter TargetName="tbTaxExemption"
                                                        Property="Visibility"
                                                        Value="Collapsed" />
                                            </DataTrigger>
                                        </DataTemplate.Triggers>
                                    </DataTemplate>
                                </DataGridTemplateColumn.CellTemplate>
                            </DataGridTemplateColumn>
                            <DataGridTextColumn Binding="{Binding RequestShipDate, StringFormat={x:Static local:Define.DateFormat}}"
                                                Width="70"
                                                ElementStyle="{StaticResource CenterTextColumn}"
                                                IsReadOnly="True">
                                <DataGridTextColumn.Header>
                                    <TextBlock Text="{DynamicResource C149}" />
                                </DataGridTextColumn.Header>
                            </DataGridTextColumn>
                            <DataGridTextColumn Binding="{Binding SOCard, Mode=OneWay}"
                                                Width="90"
                                                IsReadOnly="True">
                                <DataGridTextColumn.Header>
                                    <TextBlock Text="{DynamicResource SO_TextBlock_ScanCode}" />
                                </DataGridTextColumn.Header>
                            </DataGridTextColumn>
                            <DataGridTemplateColumn Width="20"
                                                    IsReadOnly="True">
                                <DataGridTemplateColumn.CellTemplate>
                                    <DataTemplate>
                                        <Rectangle Width="16"
                                                   Height="16"
                                                   Fill="{DynamicResource Return}">
                                            <Rectangle.Visibility>
                                                <Binding Path="IsReturned"
                                                         Mode="OneWay"
                                                         UpdateSourceTrigger="PropertyChanged">
                                                    <Binding.Converter>
                                                        <converter:BoolToVisibilityConverter />
                                                    </Binding.Converter>
                                                </Binding>
                                            </Rectangle.Visibility>
                                        </Rectangle>
                                    </DataTemplate>
                                </DataGridTemplateColumn.CellTemplate>
                            </DataGridTemplateColumn>
                        </cpcDataGrid:DataGridControl.Columns>
                    </cpcDataGrid:DataGridControl>
                </Grid>

                <Grid x:Name="grdContentSalesOrder1"
                      Grid.Column="1">
                    <Grid.Visibility>
                        <Binding Path="IsSearchMode"
                                 Mode="OneWay"
                                 UpdateSourceTrigger="PropertyChanged">
                            <Binding.Converter>
                                <converter:BoolToVisibilityConverter FalseToVisibility="Visible" />
                            </Binding.Converter>
                        </Binding>
                    </Grid.Visibility>
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="22" />
                        <ColumnDefinition />
                    </Grid.ColumnDefinitions>
                    <Button x:Name="btnBarSearch"
                            Command="{Binding DoubleClickViewCommand}"
                            BorderThickness="1"
                            Style="{DynamicResource ButtonBarSearch}">
                        <TextBlock x:Name="txtblShowSearchSalesOrder"
                                   HorizontalAlignment="Center"
                                   VerticalAlignment="Center"
                                   Style="{DynamicResource ButtonBarSearchTextBlock}"
                                   Text="Search"
                                   TextWrapping="NoWrap">
                            <TextBlock.LayoutTransform>
                                <TransformGroup>
                                    <ScaleTransform />
                                    <SkewTransform />
                                    <RotateTransform Angle="-90" />
                                    <TranslateTransform />
                                </TransformGroup>
                            </TextBlock.LayoutTransform>
                        </TextBlock>
                    </Button>
                    <Rectangle x:Name="grdSpliter"
                               Grid.Column="1"
                               Width="1"
                               HorizontalAlignment="Left"
                               Fill="{DynamicResource Spilter_Line_Background}" />
                    <Grid x:Name="grdSubSalesOrder"
                          Grid.Column="2">
                        <Grid.RowDefinitions>
                            <RowDefinition Height="60" />
                            <RowDefinition Height="90" />
                            <RowDefinition />
                        </Grid.RowDefinitions>
                        <StackPanel x:Name="stkpBtn"
                                    Height="Auto"
                                    Margin="20,0,0,5"
                                    HorizontalAlignment="Left"
                                    VerticalAlignment="Bottom"
                                    IsEnabled="{Binding SelectedSaleOrder.IsLocked, Converter={StaticResource reserseBoolConverter}, Mode=OneWay}"
                                    Orientation="Horizontal">
                            <Button x:Name="btnNew"
                                    Command="{Binding NewCommand}"
                                    Width="40"
                                    Height="40"
                                    Margin="0"
                                    IsEnabled="{Binding ., ConverterParameter=SO100-04-02, Converter={StaticResource permissionConverter}}"
                                    Style="{DynamicResource ButtonSystem}"
                                    ToolTip="New Item"
                                    Visibility="Visible">
                                <StackPanel x:Name="stkpBtnNew"
                                            HorizontalAlignment="Center"
                                            VerticalAlignment="Center">
                                    <Rectangle x:Name="imgNew"
                                               Width="30"
                                               Height="30"
                                               Fill="{DynamicResource New}" />
                                    <TextBlock x:Name="txtblNew"
                                               VerticalAlignment="Center"
                                               Style="{DynamicResource ButtonSystemTextBlock}"
                                               Text="New"
                                               TextWrapping="NoWrap"
                                               Visibility="Collapsed" />
                                </StackPanel>
                            </Button>
                            <Button x:Name="btnSave"
                                    Command="{Binding SaveCommand}"
                                    Width="40"
                                    Height="40"
                                    Style="{DynamicResource ButtonSystem}"
                                    ToolTip="Save Current Item"
                                    Visibility="Visible">
                                <StackPanel x:Name="stkpBtnSave"
                                            HorizontalAlignment="Center"
                                            VerticalAlignment="Center"
                                            Orientation="Horizontal">
                                    <Rectangle x:Name="imgSave"
                                               Width="30"
                                               Height="30"
                                               Fill="{DynamicResource Save}" />
                                    <TextBlock x:Name="txtblSave"
                                               Margin="5,0,0,0"
                                               VerticalAlignment="Center"
                                               Style="{DynamicResource ButtonSystemTextBlock}"
                                               Text="Save"
                                               TextWrapping="NoWrap"
                                               Visibility="Collapsed" />
                                </StackPanel>
                            </Button>
                            <Button x:Name="btnDelete"
                                    Command="{Binding DeleteCommand}"
                                    Width="40"
                                    Height="40"
                                    IsEnabled="{Binding ., ConverterParameter=SO100-04-03, Converter={StaticResource permissionConverter}}"
                                    Style="{DynamicResource ButtonSystem}"
                                    ToolTip="Delete Current Item">
                                <StackPanel x:Name="stkpBtnVoid"
                                            HorizontalAlignment="Center"
                                            VerticalAlignment="Center">
                                    <Rectangle x:Name="imgVoid"
                                               Width="30"
                                               Height="30"
                                               Fill="{DynamicResource Void}" />
                                    <TextBlock x:Name="txtblVoid"
                                               Margin="5,0,0,0"
                                               VerticalAlignment="Center"
                                               Style="{DynamicResource ButtonSystemTextBlock}"
                                               Text="Close"
                                               TextWrapping="NoWrap"
                                               Visibility="Collapsed" />
                                </StackPanel>
                            </Button>
                            <Grid x:Name="grdPrint"
                                  Width="40"
                                  Height="40"
                                  IsEnabled="{Binding ., ConverterParameter=SO100-04-03, Converter={StaticResource permissionConverter}}">
                                <ComboBox x:Name="cmbPrint"
                                          Width="40"
                                          Height="40"
                                          HorizontalAlignment="Center"
                                          VerticalAlignment="Center"
                                          IsEnabled="{Binding SelectedSaleOrder.IsNew, Mode=OneWay, UpdateSourceTrigger=PropertyChanged, Converter={StaticResource reserseBoolConverter}}"
                                          Style="{DynamicResource RemarkComboboxStyle}"
                                          ToolTip="Print Current Item">

                                    <ComboBoxItem>
                                        <Button Command="{Binding PrintCommand}"
                                                CommandParameter="SaleOrder"
                                                Width="90"
                                                Content="Sales Order"
                                                Style="{DynamicResource ButtonComboboxItemRemark}" />
                                    </ComboBoxItem>
                                    <ComboBoxItem>
                                        <Button Command="{Binding PrintCommand}"
                                                CommandParameter="PickPack"
                                                Width="90"
                                                Content="Pick &amp; Pack"
                                                Style="{DynamicResource ButtonComboboxItemRemark}" />
                                    </ComboBoxItem>
                                    <ComboBoxItem>
                                        <Button Command="{Binding PrintCommand}"
                                                CommandParameter="Invoice"
                                                Width="90"
                                                Content="Sales Invoice"
                                                Style="{DynamicResource ButtonComboboxItemRemark}" />
                                    </ComboBoxItem>
                                    <ComboBoxItem>
                                        <Button Command="{Binding PrintCommand}"
                                                CommandParameter="Receipt"
                                                Width="90"
                                                Content="Sales Reciept"
                                                Style="{DynamicResource ButtonComboboxItemRemark}" />
                                    </ComboBoxItem>
                                    <ComboBoxItem>
                                        <Button Command="{Binding PrintCommand}"
                                                CommandParameter="Return"
                                                Width="90"
                                                Content="Sales Return"
                                                Style="{DynamicResource ButtonComboboxItemRemark}" />
                                    </ComboBoxItem>
                                </ComboBox>
                                <Rectangle x:Name="imgPrint1"
                                           Width="30"
                                           Height="30"
                                           Fill="{DynamicResource Print}"
                                           IsHitTestVisible="False" />
                            </Grid>

                            <Button x:Name="btnPayment"
                                    Command="{Binding PaymentCommand}"
                                    Width="40"
                                    Height="40"
                                    VerticalAlignment="Center"
                                    IsEnabled="{Binding ., ConverterParameter=SO100-04-06, Converter={StaticResource permissionConverter}}"
                                    Style="{DynamicResource ButtonSystem}"
                                    ToolTip="Payment Current Item"
                                    Visibility="Visible">
                                <StackPanel x:Name="stkpBtnPayment"
                                            HorizontalAlignment="Center"
                                            VerticalAlignment="Center"
                                            Orientation="Horizontal">
                                    <Rectangle x:Name="imgPayment"
                                               Width="30"
                                               Height="30"
                                               Fill="{DynamicResource Payment}" />
                                    <TextBlock x:Name="txtblPayment"
                                               Margin="5,0,0,0"
                                               VerticalAlignment="Center"
                                               Style="{DynamicResource ButtonSystemTextBlock}"
                                               Text="Preview"
                                               TextWrapping="NoWrap"
                                               Visibility="Collapsed" />
                                </StackPanel>
                            </Button>
                            <Button x:Name="btnRefund"
                                    Command="{Binding SaleOrderRefundedCommand}"
                                    Width="40"
                                    Height="40"
                                    VerticalAlignment="Center"
                                    IsEnabled="{Binding ., ConverterParameter=SO100-04-07, Converter={StaticResource permissionConverter}}"
                                    Style="{DynamicResource ButtonSystem}"
                                    ToolTip="Refund Current Item">
                                <StackPanel x:Name="stkpBtnRefund"
                                            HorizontalAlignment="Center"
                                            VerticalAlignment="Center"
                                            Orientation="Horizontal">
                                    <Rectangle x:Name="imgRefund"
                                               Width="30"
                                               Height="30"
                                               Fill="{DynamicResource Refund}" />
                                    <TextBlock x:Name="txtblRefund1"
                                               Margin="5,0,0,0"
                                               VerticalAlignment="Center"
                                               Style="{DynamicResource ButtonSystemTextBlock}"
                                               Text="Preview"
                                               TextWrapping="NoWrap"
                                               Visibility="Collapsed" />
                                </StackPanel>
                            </Button>
                            <Button x:Name="btnSOLock"
                                    Command="{Binding LockOrderCommand}"
                                    Width="40"
                                    Height="40"
                                    VerticalAlignment="Center"
                                    IsEnabled="{Binding ., ConverterParameter=SO100-04-08, Converter={StaticResource permissionConverter}}"
                                    Style="{DynamicResource ButtonSystem}"
                                    ToolTip="Lock Current Item">
                                <Button.Visibility>
                                    <Binding Path="SelectedSaleOrder.FullPayment"
                                             Mode="OneWay"
                                             UpdateSourceTrigger="PropertyChanged">
                                        <Binding.Converter>
                                            <converter:BoolToVisibilityConverter FalseToVisibility="Visible" />
                                        </Binding.Converter>
                                    </Binding>
                                </Button.Visibility>
                                <StackPanel x:Name="stkpBtnSOLock"
                                            HorizontalAlignment="Center"
                                            VerticalAlignment="Center"
                                            Orientation="Horizontal">
                                    <Rectangle x:Name="imgSOLock"
                                               Width="30"
                                               Height="30"
                                               Fill="{DynamicResource SOLock}" />
                                    <TextBlock x:Name="txtblSOLock"
                                               Margin="5,0,0,0"
                                               VerticalAlignment="Center"
                                               Style="{DynamicResource ButtonSystemTextBlock}"
                                               Text="SOLock"
                                               TextWrapping="NoWrap"
                                               Visibility="Collapsed" />
                                </StackPanel>
                            </Button>
                        </StackPanel>
                        <TextBlock x:Name="txtblBindingWorkOrder"
                                   Margin="0,0,20,7"
                                   HorizontalAlignment="Right"
                                   VerticalAlignment="Bottom"
                                   FontFamily="Times New Roman"
                                   Style="{DynamicResource TextBlockTitleFormView}"
                                   Text="Sales Order"
                                   TextWrapping="NoWrap" />
                        <Rectangle x:Name="Line"
                                   Grid.Row="1"
                                   Height="1"
                                   Margin="2,0"
                                   HorizontalAlignment="Stretch"
                                   VerticalAlignment="Top"
                                   Fill="White" />

                        <AdornerDecorator Grid.Row="1"
                                          Margin="0,10,0,0"
                                          HorizontalAlignment="Left"
                                          VerticalAlignment="Top">
                            <Grid x:Name="grdSalesOrderInformation"
                                  Width="747"
                                  Height="80"
                                  IsEnabled="{Binding IsAllowChangeOrder, Mode=OneWay}">
                                <Grid.RowDefinitions>
                                    <RowDefinition Height="25" />
                                    <RowDefinition Height="25" />
                                    <RowDefinition Height="25" />
                                </Grid.RowDefinitions>
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="76" />
                                    <ColumnDefinition Width="174" />
                                    <ColumnDefinition Width="*" />
                                    <ColumnDefinition Width="85" />
                                    <ColumnDefinition Width="174" />
                                    <ColumnDefinition Width="*" />
                                    <ColumnDefinition Width="51" />
                                    <ColumnDefinition Width="120" />
                                </Grid.ColumnDefinitions>
                                <TextBlock x:Name="txtblCustomer"
                                           Margin="10,0,0,0"
                                           HorizontalAlignment="Left"
                                           VerticalAlignment="Center"
                                           Style="{DynamicResource TextBlockNormal}"
                                           Text="{DynamicResource SO_TextBlock_Customer}"
                                           TextWrapping="NoWrap" />
                                <cpcComboBox:ComboBoxControl Grid.Column="1"
                                                             Margin="0,2,26,2"
                                                             AddItemCommand="{Binding AddNewCustomerCommand}"
                                                             AutoHiddenItem="False"
                                                             cpcBehavior:AutoFocusBehavior.IsFocused="{Binding IsForceFocused, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}"
                                                             DisplayMemberPath="LegalName"
                                                             IsEnabled="{Binding SelectedSaleOrder.AnyShipped, Converter={StaticResource reserseBoolConverter}, Mode=OneWay}"
                                                             ItemsSource="{Binding CustomerCollection}"
                                                             SelectedItem="{Binding SelectedCustomer, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}"
                                                             SelectedValuePath="Resource"
                                                             Style="{DynamicResource ComboBoxControl_CheckedItemIsHiddenStyle}"
                                                             Tag="{Binding SelectedSaleOrder.CustomerResource, Mode=TwoWay, NotifyOnValidationError=True, UpdateSourceTrigger=PropertyChanged, ValidatesOnDataErrors=True}"
                                                             VisibilityAddItem="{Binding UserPermissions.AllowAddCustomer, Converter={StaticResource boolToVisibilityConverter}, Mode=OneWay}">
                                    <i:Interaction.Behaviors>
                                        <cpcBehavior:AutoFocusBehavior />
                                    </i:Interaction.Behaviors>
                                </cpcComboBox:ComboBoxControl>

                                <Button x:Name="btnBarcodeMembership"
                                        Command="{Binding CustomerSearchCommand}"
                                        Grid.Column="1"
                                        Width="21"
                                        Height="21"
                                        Margin="0"
                                        HorizontalAlignment="Right"
                                        VerticalAlignment="Center"
                                        Visibility="Visible">
                                    <Rectangle x:Name="imgBarcodeMembership"
                                               Width="16"
                                               Height="16"
                                               Fill="{DynamicResource Find}" />
                                </Button>
                                <TextBlock x:Name="txtblBookingChanal"
                                           Grid.Column="3"
                                           Margin="0"
                                           HorizontalAlignment="Left"
                                           VerticalAlignment="Center"
                                           Style="{DynamicResource TextBlockNormal}"
                                           Text="{DynamicResource SO_TextBlock_BookingChannel}"
                                           TextWrapping="NoWrap" />
                                <ComboBox x:Name="cmbTransType"
                                          Grid.Column="4"
                                          Margin="0,2"
                                          VerticalAlignment="Stretch"
                                          DisplayMemberPath="Text"
                                          ItemsSource="{x:Static helper:Common.BookingChannel}"
                                          SelectedValue="{Binding SelectedSaleOrder.BookingChanel, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}"
                                          SelectedValuePath="ObjValue" />
                                <TextBlock x:Name="txtblSONo"
                                           Grid.Column="6"
                                           Margin="0"
                                           HorizontalAlignment="Left"
                                           VerticalAlignment="Center"
                                           Style="{DynamicResource TextBlockNormal}"
                                           Text="{DynamicResource SO_TextBlock_SONum}"
                                           TextWrapping="NoWrap" />
                                <TextBlock x:Name="txtblBindingSONo"
                                           Grid.Column="7"
                                           HorizontalAlignment="Left"
                                           VerticalAlignment="Center"
                                           Style="{DynamicResource TextBlockBasic}"
                                           Text="{Binding SelectedSaleOrder.SONumber, Mode=TwoWay, NotifyOnValidationError=True, UpdateSourceTrigger=PropertyChanged, ValidatesOnDataErrors=True}"
                                           TextWrapping="NoWrap" />
                                <TextBlock x:Name="txtblBillAddress"
                                           Grid.Row="1"
                                           Margin="10,0,0,0"
                                           HorizontalAlignment="Left"
                                           VerticalAlignment="Center"
                                           Style="{DynamicResource TextBlockNormal}"
                                           Text="{DynamicResource SO_TextBlock_BillAddress}"
                                           TextWrapping="NoWrap" />

                                <TextBox x:Name="txtBillAddress"
                                         Grid.Row="1"
                                         Grid.RowSpan="2"
                                         Grid.Column="1"
                                         Margin="0,2"
                                         HorizontalContentAlignment="Left"
                                         VerticalContentAlignment="Top"
                                         Cursor="Hand"
                                         IsReadOnly="True"
                                         Padding="2"
                                         Text="{Binding SelectedSaleOrder.BillAddress, Mode=OneWay, NotifyOnValidationError=True, UpdateSourceTrigger=PropertyChanged, ValidatesOnDataErrors=True}"
                                         TextWrapping="Wrap"
                                         ToolTip="Click to view detail"
                                         VerticalScrollBarVisibility="Disabled">
                                    <TextBox.InputBindings>
                                        <KeyBinding Key="Enter"
                                                    Command="{Binding AddressPopupCommand}"
                                                    CommandParameter="{Binding SelectedSaleOrder.BillAddressModel}" />
                                    </TextBox.InputBindings>
                                    <i:Interaction.Triggers>
                                        <i:EventTrigger EventName="PreviewMouseDown">
                                            <command:EventToCommand Command="{Binding AddressPopupCommand}"
                                                                    CommandParameter="{Binding SelectedSaleOrder.BillAddressModel}" />
                                        </i:EventTrigger>
                                    </i:Interaction.Triggers>
                                </TextBox>

                                <TextBlock x:Name="txtblShipAddress"
                                           Grid.Row="1"
                                           Grid.Column="3"
                                           Margin="0"
                                           HorizontalAlignment="Left"
                                           VerticalAlignment="Center"
                                           Style="{DynamicResource TextBlockNormal}"
                                           Text="{DynamicResource C147}"
                                           TextWrapping="NoWrap" />
                                <TextBox x:Name="txtShipAddress"
                                         Grid.Row="1"
                                         Grid.RowSpan="2"
                                         Grid.Column="4"
                                         Margin="0,2"
                                         HorizontalContentAlignment="Left"
                                         VerticalContentAlignment="Top"
                                         Cursor="Hand"
                                         IsReadOnly="True"
                                         Padding="2"
                                         Text="{Binding SelectedSaleOrder.ShipAddress, Mode=OneWay, NotifyOnValidationError=True, UpdateSourceTrigger=PropertyChanged, ValidatesOnDataErrors=True}"
                                         TextWrapping="Wrap"
                                         ToolTip="Click to view detail"
                                         VerticalScrollBarVisibility="Disabled">
                                    <TextBox.InputBindings>
                                        <KeyBinding Key="Enter"
                                                    Command="{Binding AddressPopupCommand}"
                                                    CommandParameter="{Binding SelectedSaleOrder.ShipAddressModel}" />
                                    </TextBox.InputBindings>
                                    <i:Interaction.Triggers>
                                        <i:EventTrigger EventName="PreviewMouseDown">
                                            <command:EventToCommand Command="{Binding AddressPopupCommand}"
                                                                    CommandParameter="{Binding SelectedSaleOrder.ShipAddressModel}" />
                                        </i:EventTrigger>
                                    </i:Interaction.Triggers>
                                </TextBox>
                                <TextBlock x:Name="txtblSODate"
                                           Grid.Row="1"
                                           Grid.Column="6"
                                           Margin="0"
                                           HorizontalAlignment="Left"
                                           VerticalAlignment="Center"
                                           Style="{DynamicResource TextBlockNormal}"
                                           Text="{DynamicResource SO_TextBlock_SODate}"
                                           TextWrapping="NoWrap" />
                                <DatePicker x:Name="dtpOrderDate"
                                            Grid.Row="1"
                                            Grid.Column="7"
                                            Width="90"
                                            Margin="0,2"
                                            HorizontalAlignment="Left"
                                            Background="White"
                                            IsEnabled="False"
                                            SelectedDate="{Binding SelectedSaleOrder.OrderDate, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}" />
                                <TextBlock x:Name="txtblStatus"
                                           Grid.Row="2"
                                           Grid.Column="6"
                                           Margin="0"
                                           HorizontalAlignment="Left"
                                           VerticalAlignment="Center"
                                           Style="{DynamicResource TextBlockNormal}"
                                           Text="{DynamicResource C151}"
                                           TextWrapping="NoWrap" />
                                <ComboBox x:Name="cmbStatus"
                                          Grid.Row="2"
                                          Grid.Column="7"
                                          Width="90"
                                          Margin="0,2"
                                          HorizontalAlignment="Left"
                                          VerticalAlignment="Stretch"
                                          DisplayMemberPath="Text"
                                          IsEnabled="False"
                                          ItemsSource="{x:Static helper:Common.StatusSalesOrders}"
                                          SelectedIndex="0"
                                          SelectedValue="{Binding SelectedSaleOrder.OrderStatus, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}"
                                          SelectedValuePath="ObjValue" />

                            </Grid>
                        </AdornerDecorator>
                        <Grid x:Name="grdContentSalesOrder"
                              Grid.Row="2"
                              Margin="0,0,0,10">
                            <!--  TabControlChangedCommand  -->
                            <cpcOtherControl:CPCTabControl x:Name="TabSalesOrder"
                                                           Grid.Row="3"
                                                           Margin="10,10,10,0"
                                                           DataChanged="{Binding SelectedSaleOrder}"
                                                           IsValid="{Binding IsValidTab, Mode=OneWayToSource}"
                                                           SelectedIndex="{Binding SelectedTabIndex, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}">

                                <cpcOtherControl:CPCTabItemControl x:Name="tabitemOrder"
                                                                   Header="{DynamicResource SO_TextBlock_Order}"
                                                                   IsCheckError="True">
                                    <AdornerDecorator>
                                        <Grid x:Name="grdOrder">
                                            <Grid.RowDefinitions>
                                                <RowDefinition Height="30" />
                                                <RowDefinition Height="Auto"
                                                               MinHeight="5.2" />
                                                <RowDefinition />
                                                <RowDefinition Height="150.003" />
                                            </Grid.RowDefinitions>
                                            <TextBlock x:Name="txtblSelectItem"
                                                       Margin="10.1,0,0,0"
                                                       HorizontalAlignment="Left"
                                                       VerticalAlignment="Center"
                                                       Style="{DynamicResource TextBlockNormal}"
                                                       Text="{DynamicResource C100}"
                                                       TextWrapping="NoWrap" />
                                            <wpfToolkit:WatermarkTextBox x:Name="txtBarcodeProduct"
                                                                         Grid.Column="1"
                                                                         Width="350"
                                                                         Height="21"
                                                                         Margin="75,0,0,0"
                                                                         HorizontalAlignment="Left"
                                                                         VerticalAlignment="Center"
                                                                         VerticalContentAlignment="Center"
                                                                         BorderBrush="{DynamicResource TextBoxCanlendarComboboxBorderBrush}"
                                                                         cpcBehavior:AutoFocusBehavior.IsFocused="{Binding IsSelected, ElementName=tabitemOrder, Mode=OneWay}"
                                                                         IsEnabled="{Binding IsAllowChangeOrder, Mode=OneWay}"
                                                                         Text="{Binding BarcodeProduct, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}"
                                                                         TextWrapping="NoWrap"
                                                                         Watermark="Input barcode and press enter">
                                                <i:Interaction.Behaviors>
                                                    <cpcBehavior:AutoFocusBehavior />
                                                </i:Interaction.Behaviors>
                                                <wpfToolkit:WatermarkTextBox.InputBindings>
                                                    <KeyBinding Key="Enter"
                                                                Command="{Binding SearchProductCommand}" />
                                                </wpfToolkit:WatermarkTextBox.InputBindings>
                                            </wpfToolkit:WatermarkTextBox>

                                            <!--
                                                <cpcAutoComplete:AutoCompleteTextBox Grid.Column="1"
                                                Width="350"
                                                Height="21"
                                                Margin="75,0,0,0"
                                                HorizontalAlignment="Left"
                                                
                                                VerticalAlignment="Center"
                                                AutoChangeSelectedItem="False"
                                                cpcBehavior:AutoFocusBehavior.IsFocused="{Binding IsSelected,
                                                ElementName=tabitemOrder,
                                                Mode=OneWay}"
                                                FieldShow="ProductName"
                                                FieldSource="{Binding ProductFieldCollection}"
                                                FilterMode="Contains"
                                                IsEnabled="{Binding IsAllowChangeOrder,
                                                Mode=OneWay}"
                                                IsTextCompletionEnabled="False"
                                                ItemsSource="{Binding ProductCollection}"
                                                ListViewItemStyle="{StaticResource ListViewItemColorStyle}"
                                                SelectedItemResult="{Binding SelectedProduct,
                                                Mode=TwoWay,
                                                UpdateSourceTrigger=PropertyChanged}"
                                                Style="{DynamicResource AutoCompleteWaterMarkStyle}">
                                                <cpcAutoComplete:AutoCompleteTextBox.Columns>
                                                <GridViewColumn Width="150"
                                                DisplayMemberBinding="{Binding ProductName}"
                                                Header="{DynamicResource C175}" />
                                                <GridViewColumn Width="70"
                                                DisplayMemberBinding="{Binding Attribute}"
                                                Header="{DynamicResource C116}" />
                                                <GridViewColumn Width="70"
                                                DisplayMemberBinding="{Binding Size}"
                                                Header="{DynamicResource C117}" />
                                                <GridViewColumn Width="100" Header="{DynamicResource C119}">
                                                <GridViewColumn.CellTemplate>
                                                <DataTemplate>
                                                <TextBlock HorizontalAlignment="Stretch"
                                                Text="{Binding RegularPrice,
                                                ConverterCulture={x:Static local:Define.ConverterCulture},
                                                StringFormat={x:Static local:Define.CurrencyFormat}}"
                                                TextAlignment="Right" />
                                                </DataTemplate>
                                                </GridViewColumn.CellTemplate>
                                                </GridViewColumn>
                                                </cpcAutoComplete:AutoCompleteTextBox.Columns>
                                                </cpcAutoComplete:AutoCompleteTextBox>
                                            -->
                                            <Rectangle x:Name="imgIssueNewReward"
                                                       Grid.Column="1"
                                                       Width="30"
                                                       Height="30"
                                                       Margin="550,0,0,0"
                                                       HorizontalAlignment="Left"
                                                       Fill="{DynamicResource IssueReward}">
                                                <Rectangle.Visibility>
                                                    <Binding Path="SelectedSaleOrder.IsApplyReward"
                                                             Mode="OneWay">
                                                        <Binding.Converter>
                                                            <converter:BoolToVisibilityConverter FalseToVisibility="Collapsed" />
                                                        </Binding.Converter>
                                                    </Binding>
                                                </Rectangle.Visibility>
                                                <!--
                                                    <Rectangle.ToolTip>
                                                    <ToolTip Background="Transparent" BorderBrush="Transparent">
                                                    <Border x:Name="brdRewardTooltip"
                                                    Grid.Row="2"
                                                    Width="250"
                                                    HorizontalAlignment="Stretch"
                                                    Background="{DynamicResource UserControlBackground}"
                                                    BorderBrush="{DynamicResource TitleBarBorder}"
                                                    BorderThickness="1,1,1,1"
                                                    CornerRadius="5,5,5,5">
                                                    <Grid x:Name="grdReward" Margin="5">
                                                    <Grid.RowDefinitions>
                                                    <RowDefinition Height="25" />
                                                    <RowDefinition Height="25" />
                                                    <RowDefinition Height="30" />
                                                    </Grid.RowDefinitions>
                                                    <TextBlock x:Name="txtblRewardMember"
                                                    HorizontalAlignment="Left"
                                                    VerticalAlignment="Center"
                                                    Style="{DynamicResource TextBlockNormal}"
                                                    Text="Reward Member"
                                                    TextWrapping="NoWrap" />
                                                    <TextBlock x:Name="txtblRewardHas"
                                                    Grid.Row="1"
                                                    HorizontalAlignment="Left"
                                                    VerticalAlignment="Center"
                                                    Style="{DynamicResource TextBlockNormal}"
                                                    TextWrapping="Wrap">
                                                    <TextBlock.Text>
                                                    <Binding Mode="OneWay"
                                                    Path="SelectedCustomer.GuestRewardCollection.Count"
                                                    StringFormat="Reward has {0} rewards available for redemption" />
                                                    </TextBlock.Text>
                                                    </TextBlock>
                                                    <StackPanel Grid.Row="2"
                                                    Margin="3"
                                                    Orientation="Horizontal">
                                                    <Rectangle x:Name="imgReward"
                                                    Width="15"
                                                    Height="15"
                                                    Margin="0,7.5,0,0"
                                                    HorizontalAlignment="Left"
                                                    VerticalAlignment="Top"
                                                    Fill="{DynamicResource RewardGold}" />
                                                    <TextBlock x:Name="txtblRewardHas1"
                                                    Margin="5,0,0,0"
                                                    HorizontalAlignment="Left"
                                                    VerticalAlignment="Center"
                                                    Style="{DynamicResource TextBlockNormal}"
                                                    Text="{Binding SelectedCustomer.RequirePurchaseNextReward,
                                                    Mode=OneWay,
                                                    ConverterCulture={x:Static local:Define.ConverterCulture},
                                                    StringFormat={x:Static local:Define.CurrencyFormat}}"
                                                    TextWrapping="Wrap" />
                                                    <TextBlock x:Name="txtblRewardHasText"
                                                    Margin="5,0,0,0"
                                                    HorizontalAlignment="Left"
                                                    VerticalAlignment="Center"
                                                    Style="{DynamicResource TextBlockNormal}"
                                                    Text=" until the next reward is earned"
                                                    TextWrapping="Wrap" />
                                                    </StackPanel>
                                                    </Grid>
                                                    </Border>
                                                    </ToolTip>
                                                    </Rectangle.ToolTip>
                                                -->
                                            </Rectangle>
                                            <Button x:Name="btnAdvanceSearch1"
                                                    Command="{Binding SearchProductAdvanceCommand}"
                                                    Width="90"
                                                    Height="21"
                                                    Margin="429,0,0,0"
                                                    HorizontalAlignment="Left"
                                                    VerticalAlignment="Center"
                                                    IsEnabled="{Binding IsAllowChangeOrder, Mode=OneWay}">
                                                <TextBlock x:Name="txtblAdvanceSearch"
                                                           VerticalAlignment="Center"
                                                           Style="{DynamicResource ButtonTextBlock}"
                                                           Text="{DynamicResource C104}"
                                                           TextWrapping="NoWrap" />
                                            </Button>

                                            <cpcDataGrid:DataGridControl x:Name="dtgrdOrderDetail"
                                                                         Grid.Row="2"
                                                                         Margin="5,0,5,5"
                                                                         AutoGenerateColumns="False"
                                                                         CanUserAddRows="False"
                                                                         CanUserDeleteRows="False"
                                                                         CanUserSortColumns="False"
                                                                         cpcBehavior:DataGridHiddenColunmHelper.ColunmIndex="0"
                                                                         cpcBehavior:DataGridHiddenColunmHelper.IsHiddenColunm="{Binding SelectedSaleOrder.IsHiddenErrorColumn, Mode=OneWay}"
                                                                         DeleteCommandParameter="{Binding SelectedItem, ElementName=dtgrdOrderDetail}"
                                                                         DeleteItemCommand="{Binding DeleteSaleOrderDetailWithKeyCommand}"
                                                                         HorizontalScrollBarVisibility="Auto"
                                                                         IsReadOnly="{Binding IsAllowChangeOrder, Converter={StaticResource reserseBoolConverter}, Mode=OneWay}"
                                                                         IsRollBackData="False"
                                                                         ItemsSource="{Binding SelectedSaleOrder.SaleOrderDetailCollection, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}"
                                                                         RowDetailsTemplate="{DynamicResource RowDetailDataTemplateOrderInvoice}"
                                                                         RowDetailsVisibilityMode="Visible"
                                                                         RowStyle="{DynamicResource DataGridDetailRowStyle}"
                                                                         SelectedItem="{Binding SelectedSaleOrderDetail, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}"
                                                                         Style="{DynamicResource DatagridWithRowHeader}"
                                                                         VisibilityNavigationBar="Collapsed">
                                                <i:Interaction.Behaviors>
                                                    <cpcBehavior:DatagridScrollToViewBehaviors />
                                                </i:Interaction.Behaviors>
                                                <cpcDataGrid:DataGridControl.Columns>
                                                    <DataGridTemplateColumn>
                                                        <DataGridTemplateColumn.CellTemplate>
                                                            <DataTemplate>
                                                                <Rectangle x:Name="rtRowError"
                                                                           Width="16"
                                                                           Height="16"
                                                                           Fill="{DynamicResource Warning}"
                                                                           Stretch="Fill"
                                                                           ToolTip="{Binding Error, Mode=OneWay}"
                                                                           Visibility="Collapsed" />
                                                                <DataTemplate.Triggers>
                                                                    <DataTrigger Binding="{Binding IsQuantityAccepted, Mode=OneWay, UpdateSourceTrigger=PropertyChanged}"
                                                                                 Value="False">
                                                                        <Setter TargetName="rtRowError"
                                                                                Property="Visibility"
                                                                                Value="Visible" />
                                                                    </DataTrigger>
                                                                </DataTemplate.Triggers>
                                                            </DataTemplate>
                                                        </DataGridTemplateColumn.CellTemplate>
                                                    </DataGridTemplateColumn>
                                                    <DataGridTextColumn Binding="{Binding ItemName}"
                                                                        Width="*"
                                                                        IsReadOnly="True">
                                                        <DataGridTextColumn.Header>
                                                            <TextBlock Text="{DynamicResource C115}" />
                                                        </DataGridTextColumn.Header>
                                                    </DataGridTextColumn>
                                                    <DataGridTextColumn Binding="{Binding ItemAtribute, Mode=OneWay}"
                                                                        Width="80"
                                                                        IsReadOnly="True">
                                                        <DataGridTextColumn.Header>
                                                            <TextBlock Text="{DynamicResource C116}" />
                                                        </DataGridTextColumn.Header>
                                                    </DataGridTextColumn>
                                                    <DataGridTextColumn Binding="{Binding ItemSize, Mode=OneWay}"
                                                                        Width="80"
                                                                        IsReadOnly="True">
                                                        <DataGridTextColumn.Header>
                                                            <TextBlock Text="{DynamicResource C117}" />
                                                        </DataGridTextColumn.Header>
                                                    </DataGridTextColumn>
                                                    <DataGridTemplateColumn Width="75"
                                                                            CellStyle="{StaticResource DataGridQuantityCellStyle}">
                                                        <DataGridTemplateColumn.Header>
                                                            <TextBlock Text="{DynamicResource C120}" />
                                                        </DataGridTemplateColumn.Header>
                                                        <DataGridTemplateColumn.CellTemplate>
                                                            <DataTemplate>
                                                                <TextBlock HorizontalAlignment="Right"
                                                                           Text="{Binding Qty, ConverterCulture={x:Static local:Define.ConverterCulture}, Mode=OneWay, StringFormat={x:Static local:Define.NumericFormat}, UpdateSourceTrigger=PropertyChanged}" />
                                                            </DataTemplate>
                                                        </DataGridTemplateColumn.CellTemplate>
                                                        <DataGridTemplateColumn.CellEditingTemplate>
                                                            <DataTemplate>
                                                                <Grid>
                                                                    <cpcTextBox:TextBoxNumeric x:Name="txtQuantity"
                                                                                               MinWidth="60"
                                                                                               ConverterCulture="{x:Static local:Define.ConverterCulture}"
                                                                                               NumericStringFormat="{x:Static local:Define.NumericFormat}"
                                                                                               Style="{DynamicResource TextBoxNumericInsideDataGridStyle}"
                                                                                               Tag="{Binding IsQuantityAccepted, Mode=OneWay}"
                                                                                               Value="{Binding Qty, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}">
                                                                        <i:Interaction.Triggers>
                                                                            <i:EventTrigger EventName="LostFocus">
                                                                                <command:EventToCommand Command="{Binding DataContext.QtyChangedCommand, RelativeSource={RelativeSource AncestorType={x:Type UserControl}, Mode=FindAncestor}}"
                                                                                                        CommandParameter="{Binding Qty}" />
                                                                            </i:EventTrigger>
                                                                        </i:Interaction.Triggers>
                                                                    </cpcTextBox:TextBoxNumeric>
                                                                </Grid>
                                                            </DataTemplate>
                                                        </DataGridTemplateColumn.CellEditingTemplate>
                                                    </DataGridTemplateColumn>
                                                    <DataGridTemplateColumn Width="80"
                                                                            CellStyle="{StaticResource DataGridPriceCellStyle}">
                                                        <DataGridTemplateColumn.Header>
                                                            <TextBlock Text="{DynamicResource C119}" />
                                                        </DataGridTemplateColumn.Header>
                                                        <DataGridTemplateColumn.CellTemplate>
                                                            <DataTemplate>
                                                                <TextBlock HorizontalAlignment="Right"
                                                                           Text="{Binding SalePriceChange, ConverterCulture={x:Static local:Define.ConverterCulture}, Mode=OneWay, StringFormat={x:Static local:Define.CurrencyFormat}}" />
                                                            </DataTemplate>
                                                        </DataGridTemplateColumn.CellTemplate>
                                                        <DataGridTemplateColumn.CellEditingTemplate>
                                                            <DataTemplate>
                                                                <cpcTextBox:TextBoxMoney x:Name="txtSalePrice"
                                                                                         HorizontalAlignment="Right"
                                                                                         ConverterCulture="{x:Static local:Define.ConverterCulture}"
                                                                                         CurrencyStringFormat="{x:Static local:Define.CurrencyFormat}"
                                                                                         Style="{DynamicResource TextBoxMoneyInsideDataGridStyle}"
                                                                                         Value="{Binding SalePriceChange, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}">
                                                                    <i:Interaction.Triggers>
                                                                        <i:EventTrigger EventName="LostFocus">
                                                                            <command:EventToCommand Command="{Binding DataContext.ManualChangePriceCommand, RelativeSource={RelativeSource AncestorType={x:Type UserControl}, Mode=FindAncestor}}"
                                                                                                    CommandParameter="{Binding SalePriceChange}" />
                                                                        </i:EventTrigger>
                                                                    </i:Interaction.Triggers>
                                                                </cpcTextBox:TextBoxMoney>
                                                                <DataTemplate.Triggers>
                                                                    <DataTrigger Binding="{Binding ProductModel.IsOpenItem}"
                                                                                 Value="True">
                                                                        <Setter TargetName="txtSalePrice"
                                                                                Property="Foreground"
                                                                                Value="{DynamicResource ForegroundGreenBrush}" />
                                                                        <Setter TargetName="txtSalePrice"
                                                                                Property="FontWeight"
                                                                                Value="Bold" />
                                                                    </DataTrigger>
                                                                </DataTemplate.Triggers>
                                                            </DataTemplate>
                                                        </DataGridTemplateColumn.CellEditingTemplate>
                                                    </DataGridTemplateColumn>
                                                    <DataGridTemplateColumn Width="75"
                                                                            CellStyle="{StaticResource DataGridUOMCellStyle}">
                                                        <DataGridTemplateColumn.Header>
                                                            <TextBlock Text="{DynamicResource C118}" />
                                                        </DataGridTemplateColumn.Header>
                                                        <DataGridTemplateColumn.CellTemplate>
                                                            <DataTemplate>
                                                                <TextBlock Text="{Binding UOM, Mode=OneWay}" />
                                                            </DataTemplate>
                                                        </DataGridTemplateColumn.CellTemplate>
                                                        <DataGridTemplateColumn.CellEditingTemplate>
                                                            <DataTemplate>
                                                                <Grid>
                                                                    <ComboBox x:Name="cmbUnit"
                                                                              DisplayMemberPath="Name"
                                                                              ItemsSource="{Binding ProductUOMCollection, Mode=OneWay}"
                                                                              SelectedValue="{Binding UOMId, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}"
                                                                              SelectedValuePath="UOMId"
                                                                              Style="{DynamicResource ComboBoxInsideDataGridStyle}" />
                                                                </Grid>
                                                            </DataTemplate>
                                                        </DataGridTemplateColumn.CellEditingTemplate>
                                                    </DataGridTemplateColumn>
                                                    <DataGridTemplateColumn Width="80"
                                                                            IsReadOnly="True">
                                                        <DataGridTemplateColumn.Header>
                                                            <TextBlock Text="{DynamicResource C122}" />
                                                        </DataGridTemplateColumn.Header>
                                                        <DataGridTemplateColumn.CellTemplate>
                                                            <DataTemplate>
                                                                <TextBlock x:Name="tblSubTotal"
                                                                           HorizontalAlignment="Right"
                                                                           Text="{Binding SubTotal, ConverterCulture={x:Static local:Define.ConverterCulture}, Mode=OneWay, StringFormat={x:Static local:Define.CurrencyFormat}}" />
                                                            </DataTemplate>
                                                        </DataGridTemplateColumn.CellTemplate>
                                                    </DataGridTemplateColumn>
                                                    <DataGridTextColumn Width="75"
                                                                        IsReadOnly="True">
                                                        <DataGridTextColumn.Header>
                                                            <TextBlock Text="{DynamicResource C152}" />
                                                        </DataGridTextColumn.Header>
                                                        <DataGridTextColumn.ElementStyle>
                                                            <Style TargetType="{x:Type TextBlock}">
                                                                <Setter Property="HorizontalAlignment"
                                                                        Value="Right" />
                                                                <Setter Property="Text"
                                                                        Value="{Binding OnHandQty, ConverterCulture={x:Static local:Define.ConverterCulture}, Mode=OneWay, StringFormat={x:Static local:Define.DecimalFormat}}" />
                                                                <Style.Triggers>
                                                                    <DataTrigger Binding="{Binding OnHandQty, Mode=OneWay}"
                                                                                 Value="0">
                                                                        <Setter Property="Text"
                                                                                Value="{Binding OnHandQty, ConverterCulture={x:Static local:Define.ConverterCulture}, Mode=OneWay, StringFormat={x:Static local:Define.IntegerFormat}}" />
                                                                    </DataTrigger>
                                                                </Style.Triggers>
                                                            </Style>
                                                        </DataGridTextColumn.ElementStyle>
                                                    </DataGridTextColumn>
                                                </cpcDataGrid:DataGridControl.Columns>
                                            </cpcDataGrid:DataGridControl>
                                            <Grid x:Name="grdOrderSubTotal"
                                                  Grid.Row="3"
                                                  Margin="5,0"
                                                  VerticalAlignment="Top"
                                                  IsEnabled="{Binding IsAllowChangeOrder, Mode=OneWay}">
                                                <Grid.ColumnDefinitions>
                                                    <ColumnDefinition Width="220" />
                                                    <ColumnDefinition />
                                                    <ColumnDefinition Width="61" />
                                                    <ColumnDefinition Width="115" />
                                                    <ColumnDefinition Width="70" />
                                                    <ColumnDefinition Width="80" />
                                                </Grid.ColumnDefinitions>
                                                <Grid.RowDefinitions>
                                                    <RowDefinition Height="25" />
                                                    <RowDefinition Height="25" />
                                                    <RowDefinition Height="25" />
                                                    <RowDefinition Height="25" />
                                                    <RowDefinition Height="9" />
                                                    <RowDefinition Height="40" />
                                                </Grid.RowDefinitions>
                                                <TextBlock x:Name="txtblOrderTabPaymentTerms"
                                                           HorizontalAlignment="Left"
                                                           VerticalAlignment="Center"
                                                           Style="{DynamicResource TextBlockNormal}"
                                                           Text="{DynamicResource SO_TextBlock_PaymentTerms}"
                                                           TextWrapping="NoWrap" />
                                                <cpcTextBox:TextBox x:Name="txtTerm"
                                                                    Margin="100,2,23,2"
                                                                    IsReadOnly="True"
                                                                    Padding="2,0,2,0"
                                                                    Text="{Binding SelectedSaleOrder.PaymentTermDescription, Mode=OneWay, UpdateSourceTrigger=PropertyChanged}"
                                                                    TextWrapping="NoWrap" />
                                                <Button x:Name="btnAdd"
                                                        Command="{Binding AddTermCommand}"
                                                        Width="21"
                                                        Margin="24,2,0,2"
                                                        HorizontalAlignment="Right">
                                                    <StackPanel x:Name="stkpBtnAdd"
                                                                HorizontalAlignment="Center"
                                                                VerticalAlignment="Center"
                                                                Orientation="Horizontal">
                                                        <Rectangle x:Name="imgAdd"
                                                                   Width="13"
                                                                   Height="13"
                                                                   Fill="{DynamicResource EditTerm}" />
                                                        <TextBlock x:Name="txtblOK"
                                                                   Margin="5,0,0,0"
                                                                   VerticalAlignment="Center"
                                                                   Style="{DynamicResource ButtonTextBlock}"
                                                                   Text="Add"
                                                                   TextWrapping="NoWrap"
                                                                   Visibility="Collapsed" />
                                                    </StackPanel>
                                                </Button>
                                                <TextBlock x:Name="txtblOrderTabRequestShipDate"
                                                           Grid.Row="1"
                                                           HorizontalAlignment="Left"
                                                           VerticalAlignment="Center"
                                                           Style="{DynamicResource TextBlockNormal}"
                                                           Text="{DynamicResource SO_TextBlock_RequestShipDate}"
                                                           TextWrapping="NoWrap" />
                                                <DatePicker x:Name="dtpOrderTabRequestShipDate"
                                                            Grid.Row="1"
                                                            Margin="100,2,0,2"
                                                            SelectedDate="{Binding SelectedSaleOrder.RequestShipDate, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}" />
                                                <TextBlock x:Name="txtblStoreCode"
                                                           Grid.Row="2"
                                                           HorizontalAlignment="Left"
                                                           VerticalAlignment="Center"
                                                           Style="{DynamicResource TextBlockNormal}"
                                                           Text="{DynamicResource SO_TextBlock_StoreCode}"
                                                           TextWrapping="NoWrap" />
                                                <ComboBox x:Name="cmbStoreCode"
                                                          Grid.Row="2"
                                                          Margin="100,2,0,2"
                                                          DisplayMemberPath="Name"
                                                          IsEnabled="{Binding SelectedSaleOrder.AnyShipped, Converter={StaticResource reserseBoolConverter}, Mode=OneWay}"
                                                          ItemsSource="{Binding StoreCollection}"
                                                          SelectedIndex="{Binding SelectedSaleOrder.StoreCode, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}">
                                                    <ComboBox.Visibility>
                                                        <Binding Path="."
                                                                 Mode="OneWay"
                                                                 ConverterParameter="0"
                                                                 Source="{x:Static local:Define.StoreCode}">
                                                            <Binding.Converter>
                                                                <converter:IntergerToVisibilityConverter FalseToVisibility="Collapsed" />
                                                            </Binding.Converter>
                                                        </Binding>
                                                    </ComboBox.Visibility>
                                                </ComboBox>
                                                <ComboBox x:Name="cmbStoreCodeReadOnly"
                                                          Grid.Row="2"
                                                          Margin="100,2,0,2"
                                                          DisplayMemberPath="Name"
                                                          IsReadOnly="True"
                                                          ItemsSource="{Binding StoreCollection}"
                                                          SelectedIndex="{Binding SelectedSaleOrder.StoreCode, Mode=OneWay}"
                                                          Style="{StaticResource ComboBoxTextStyle}">
                                                    <ComboBox.Visibility>
                                                        <Binding Path="."
                                                                 Mode="OneWay"
                                                                 ConverterParameter="0"
                                                                 Source="{x:Static local:Define.StoreCode}">
                                                            <Binding.Converter>
                                                                <converter:IntergerToVisibilityConverter FalseToVisibility="Visible" />
                                                            </Binding.Converter>
                                                        </Binding>
                                                    </ComboBox.Visibility>
                                                </ComboBox>
                                                <TextBlock x:Name="txtblOrderTabSaleRep"
                                                           Grid.Row="3"
                                                           HorizontalAlignment="Left"
                                                           VerticalAlignment="Center"
                                                           Style="{DynamicResource TextBlockNormal}"
                                                           Text="{DynamicResource SO_TextBlock_SalesRep}"
                                                           TextWrapping="NoWrap">
                                                    <!--  when user choise booking channel is website, Sales rep will be collapsed  -->
                                                    <TextBlock.Visibility>
                                                        <Binding Path="SelectedItem.Flag"
                                                                 Mode="OneWay"
                                                                 UpdateSourceTrigger="PropertyChanged"
                                                                 ElementName="cmbTransType">
                                                            <Binding.Converter>
                                                                <converter:BoolToVisibilityConverter FalseToVisibility="Visible" />
                                                            </Binding.Converter>
                                                        </Binding>
                                                    </TextBlock.Visibility>
                                                </TextBlock>
                                                <TextBox x:Name="txtblSaleRep"
                                                         Grid.Row="3"
                                                         Width="120"
                                                         Height="21"
                                                         Margin="100,0,0,0"
                                                         HorizontalAlignment="Left"
                                                         VerticalAlignment="Center"
                                                         IsReadOnly="True"
                                                         Text="{Binding SelectedSaleOrder.SaleRep, Mode=OneWay}"
                                                         TextWrapping="NoWrap"
                                                         Visibility="{Binding Visibility, ElementName=txtblOrderTabSaleRep}" />
                                                <TextBlock x:Name="txtblRemark1"
                                                           Grid.Column="1"
                                                           Margin="20,0,0,0"
                                                           HorizontalAlignment="Left"
                                                           VerticalAlignment="Center"
                                                           Style="{DynamicResource TextBlockNormal}"
                                                           Text="{DynamicResource C102}"
                                                           TextWrapping="NoWrap" />
                                                <cpcTextBox:TextBox x:Name="txtRemark1"
                                                                    Grid.Row="1"
                                                                    Grid.RowSpan="3"
                                                                    Grid.Column="1"
                                                                    Margin="20,2"
                                                                    VerticalContentAlignment="Top"
                                                                    AcceptsReturn="True"
                                                                    HorizontalScrollBarVisibility="Auto"
                                                                    MaxLength="200"
                                                                    Padding="2"
                                                                    Text="{Binding SelectedSaleOrder.Remark, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}"
                                                                    TextWrapping="Wrap"
                                                                    VerticalScrollBarVisibility="Auto" />
                                                <StackPanel x:Name="stkpTaxLocationCode"
                                                            Grid.Row="5"
                                                            Grid.ColumnSpan="2"
                                                            Margin="0,0,0,7"
                                                            HorizontalAlignment="Left"
                                                            VerticalAlignment="Bottom"
                                                            Orientation="Horizontal">
                                                    <StackPanel.Visibility>
                                                        <Binding Path="SelectedSaleOrder.IsTaxExemption"
                                                                 Mode="OneWay"
                                                                 UpdateSourceTrigger="PropertyChanged">
                                                            <Binding.Converter>
                                                                <converter:BoolToVisibilityConverter FalseToVisibility="Visible" />
                                                            </Binding.Converter>
                                                        </Binding>
                                                    </StackPanel.Visibility>
                                                    <TextBlock x:Name="txtblTaxLocation2"
                                                               HorizontalAlignment="Left"
                                                               FontWeight="Bold"
                                                               Foreground="#FFFEFF00"
                                                               Style="{DynamicResource TextBlockNormal}"
                                                               Text="{DynamicResource SO_TextBlock_TaxLocation}"
                                                               TextWrapping="NoWrap" />
                                                    <TextBlock x:Name="txtblBindingTaxLocation"
                                                               Margin="10,0,0,0"
                                                               HorizontalAlignment="Left"
                                                               FontWeight="Bold"
                                                               Foreground="#FFFEFF00"
                                                               Style="{DynamicResource TextBlockNormal}"
                                                               Text="{Binding SelectedSaleOrder.TaxLocationModel.Name, Mode=OneWay}"
                                                               TextWrapping="NoWrap" />
                                                    <TextBlock x:Name="txtblTaxCode"
                                                               Margin="10,0,0,0"
                                                               HorizontalAlignment="Left"
                                                               FontWeight="Bold"
                                                               Foreground="#FFFEFF00"
                                                               Style="{DynamicResource TextBlockNormal}"
                                                               Text="{DynamicResource C144}"
                                                               TextWrapping="NoWrap" />
                                                    <TextBlock x:Name="txtblBindingTaxCode"
                                                               Margin="10,0,0,0"
                                                               HorizontalAlignment="Left"
                                                               FontWeight="Bold"
                                                               Foreground="#FFFEFF00"
                                                               Style="{DynamicResource TextBlockNormal}"
                                                               Text="{Binding SelectedSaleOrder.TaxCode, Mode=OneWay}"
                                                               TextWrapping="NoWrap" />
                                                </StackPanel>
                                                <StackPanel x:Name="stkpTaxExcemption"
                                                            Grid.Row="5"
                                                            Grid.ColumnSpan="2"
                                                            Margin="0,0,0,7"
                                                            HorizontalAlignment="Left"
                                                            VerticalAlignment="Bottom"
                                                            Orientation="Horizontal">
                                                    <StackPanel.Visibility>
                                                        <Binding Path="SelectedSaleOrder.IsTaxExemption"
                                                                 Mode="OneWay">
                                                            <Binding.Converter>
                                                                <converter:BoolToVisibilityConverter FalseToVisibility="Collapsed" />
                                                            </Binding.Converter>
                                                        </Binding>
                                                    </StackPanel.Visibility>
                                                    <TextBlock x:Name="txtblTaxExcemption"
                                                               HorizontalAlignment="Left"
                                                               FontWeight="Bold"
                                                               Foreground="#FFFEFF00"
                                                               Style="{DynamicResource TextBlockNormal}"
                                                               Text="{DynamicResource SO_TextBlock_TaxExcemption}"
                                                               TextWrapping="NoWrap" />
                                                    <TextBlock x:Name="txtblTaxExcemptionNo"
                                                               Margin="10,0,0,0"
                                                               HorizontalAlignment="Left"
                                                               FontWeight="Bold"
                                                               Foreground="#FFFEFF00"
                                                               Style="{DynamicResource TextBlockNormal}"
                                                               Text="{DynamicResource C144}"
                                                               TextWrapping="NoWrap" />
                                                    <TextBlock x:Name="txtblBindingTaxExcemptionNo"
                                                               Margin="10,0,0,0"
                                                               HorizontalAlignment="Left"
                                                               FontWeight="Bold"
                                                               Foreground="#FFFEFF00"
                                                               Style="{DynamicResource TextBlockNormal}"
                                                               Text="{Binding SelectedSaleOrder.TaxExemption, Mode=OneWay}"
                                                               TextWrapping="NoWrap" />
                                                </StackPanel>
                                                <TextBlock x:Name="txtblPriceLevel2"
                                                           Grid.Column="2"
                                                           HorizontalAlignment="Left"
                                                           VerticalAlignment="Center"
                                                           Style="{DynamicResource TextBlockNormal}"
                                                           Text="{DynamicResource C157}"
                                                           TextWrapping="NoWrap" />
                                                <ComboBox x:Name="cmbPriceLevel2"
                                                          Grid.Column="3"
                                                          Margin="0,2"
                                                          VerticalAlignment="Stretch"
                                                          DisplayMemberPath="Text"
                                                          IsEnabled="{Binding ., ConverterParameter=SO100-04-12, Converter={StaticResource permissionConverter}}"
                                                          ItemsSource="{x:Static helper:Common.MarkdownPriceLevels}"
                                                          SelectedValue="{Binding SelectedSaleOrder.PriceSchemaId, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}"
                                                          SelectedValuePath="ObjValue" />
                                                <TextBlock x:Name="txtblOrderTabSubTotal"
                                                           Grid.Column="4"
                                                           Margin="10,0,0,0"
                                                           HorizontalAlignment="Left"
                                                           VerticalAlignment="Center"
                                                           Style="{DynamicResource TextBlockNormal}"
                                                           Text="{DynamicResource C112}"
                                                           TextWrapping="NoWrap" />
                                                <cpcTextBox:TextBoxMoney x:Name="txtOrderTabSubTotal"
                                                                         Grid.RowSpan="1"
                                                                         Grid.Column="5"
                                                                         Height="21"
                                                                         Margin="0,0,0,2"
                                                                         HorizontalContentAlignment="Right"
                                                                         ConverterCulture="{x:Static local:Define.ConverterCulture}"
                                                                         CurrencyStringFormat="{x:Static local:Define.CurrencyFormat}"
                                                                         FontWeight="Bold"
                                                                         IsReadOnly="True"
                                                                         Padding="2,0,2,0"
                                                                         TextWrapping="NoWrap"
                                                                         Value="{Binding SelectedSaleOrder.SubTotal, Mode=OneWay}" />
                                                <TextBlock x:Name="txtblOrderTabDiscountleft"
                                                           Grid.Column="2"
                                                           HorizontalAlignment="Left"
                                                           VerticalAlignment="Center"
                                                           Text="{DynamicResource C121}"
                                                           TextWrapping="NoWrap">
                                                    <TextBlock.Style>
                                                        <Style BasedOn="{StaticResource TextBlockNormal}"
                                                               TargetType="{x:Type TextBlock}">
                                                            <Setter Property="Grid.Row"
                                                                    Value="1" />
                                                            <Style.Triggers>
                                                                <DataTrigger Binding="{Binding SelectedSaleOrder.TaxLocationModel.TaxCodeModel.IsTaxAfterDiscount}"
                                                                             Value="False">
                                                                    <Setter Property="Grid.Row"
                                                                            Value="2" />
                                                                </DataTrigger>
                                                                <DataTrigger Binding="{Binding SelectedSaleOrder.TaxLocationModel.TaxCodeModel.IsTaxAfterDiscount}"
                                                                             Value="True">
                                                                    <Setter Property="Grid.Row"
                                                                            Value="1" />
                                                                </DataTrigger>
                                                            </Style.Triggers>
                                                        </Style>
                                                    </TextBlock.Style>
                                                </TextBlock>
                                                <cpcTextBox:TextBoxNumeric x:Name="txtOrderDiscount"
                                                                           Grid.RowSpan="1"
                                                                           Grid.Column="3"
                                                                           Width="35"
                                                                           Height="21"
                                                                           Margin="0,2"
                                                                           HorizontalAlignment="Left"
                                                                           ConverterCulture="{x:Static local:Define.ConverterCulture}"
                                                                           NumericStringFormat="{}{0:N2}"
                                                                           Padding="2,0,2,0"
                                                                           TextWrapping="NoWrap"
                                                                           Value="{Binding SelectedSaleOrder.DiscountPercent, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}">
                                                    <cpcTextBox:TextBoxNumeric.Style>
                                                        <Style BasedOn="{StaticResource {x:Type cpcTextBox:TextBoxNumeric}}"
                                                               TargetType="{x:Type cpcTextBox:TextBoxNumeric}">
                                                            <Setter Property="Grid.Row"
                                                                    Value="1" />
                                                            <Style.Triggers>
                                                                <DataTrigger Binding="{Binding SelectedSaleOrder.TaxLocationModel.TaxCodeModel.IsTaxAfterDiscount}"
                                                                             Value="False">
                                                                    <Setter Property="Grid.Row"
                                                                            Value="2" />
                                                                </DataTrigger>
                                                                <DataTrigger Binding="{Binding SelectedSaleOrder.TaxLocationModel.TaxCodeModel.IsTaxAfterDiscount}"
                                                                             Value="True">
                                                                    <Setter Property="Grid.Row"
                                                                            Value="1" />
                                                                </DataTrigger>
                                                            </Style.Triggers>
                                                        </Style>
                                                    </cpcTextBox:TextBoxNumeric.Style>
                                                </cpcTextBox:TextBoxNumeric>
                                                <!--  {x:Static local:Define.DecimalFormat}  -->
                                                <TextBlock x:Name="txtblOrderDiscountPercent"
                                                           Grid.Row="1"
                                                           Grid.Column="3"
                                                           Margin="40,0,0,0"
                                                           HorizontalAlignment="Left"
                                                           VerticalAlignment="Center"
                                                           Style="{DynamicResource TextBlockNormal}"
                                                           Text="%"
                                                           TextWrapping="NoWrap" />
                                                <TextBlock x:Name="txtblOrderTabDiscountAmount"
                                                           Grid.Column="4"
                                                           Margin="10,0,0,0"
                                                           HorizontalAlignment="Left"
                                                           VerticalAlignment="Center"
                                                           Text="{DynamicResource C121}"
                                                           TextWrapping="NoWrap">
                                                    <TextBlock.Style>
                                                        <Style BasedOn="{StaticResource TextBlockNormal}"
                                                               TargetType="{x:Type TextBlock}">
                                                            <Setter Property="Grid.Row"
                                                                    Value="1" />
                                                            <Style.Triggers>
                                                                <DataTrigger Binding="{Binding SelectedSaleOrder.TaxLocationModel.TaxCodeModel.IsTaxAfterDiscount}"
                                                                             Value="False">
                                                                    <Setter Property="Grid.Row"
                                                                            Value="2" />
                                                                </DataTrigger>
                                                            </Style.Triggers>
                                                        </Style>
                                                    </TextBlock.Style>
                                                </TextBlock>
                                                <!--  Style="{DynamicResource TextBlockNormal}"  -->
                                                <cpcTextBox:TextBoxMoney x:Name="txtShowDiscount"
                                                                         Grid.RowSpan="1"
                                                                         Grid.Column="5"
                                                                         Margin="0,2"
                                                                         ConverterCulture="{x:Static local:Define.ConverterCulture}"
                                                                         CurrencyStringFormat="{x:Static local:Define.CurrencyFormat}"
                                                                         Padding="2,0,2,0"
                                                                         TextWrapping="NoWrap"
                                                                         Value="{Binding SelectedSaleOrder.DiscountAmount, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}">
                                                    <cpcTextBox:TextBoxMoney.Style>
                                                        <Style BasedOn="{StaticResource {x:Type cpcTextBox:TextBoxMoney}}"
                                                               TargetType="{x:Type cpcTextBox:TextBoxMoney}">
                                                            <Setter Property="Grid.Row"
                                                                    Value="1" />
                                                            <Style.Triggers>
                                                                <DataTrigger Binding="{Binding SelectedSaleOrder.TaxLocationModel.TaxCodeModel.IsTaxAfterDiscount}"
                                                                             Value="False">
                                                                    <Setter Property="Grid.Row"
                                                                            Value="2" />
                                                                </DataTrigger>
                                                                <DataTrigger Binding="{Binding SelectedSaleOrder.TaxLocationModel.TaxCodeModel.IsTaxAfterDiscount}"
                                                                             Value="True">
                                                                    <Setter Property="Grid.Row"
                                                                            Value="1" />
                                                                </DataTrigger>
                                                            </Style.Triggers>
                                                        </Style>
                                                    </cpcTextBox:TextBoxMoney.Style>
                                                </cpcTextBox:TextBoxMoney>
                                                <TextBlock x:Name="txtblOrderTabTaxleft"
                                                           Grid.Column="2"
                                                           HorizontalAlignment="Left"
                                                           VerticalAlignment="Center"
                                                           Text="{DynamicResource SO_TextBlock_Tax}"
                                                           TextWrapping="NoWrap">
                                                    <TextBlock.Style>
                                                        <Style BasedOn="{StaticResource TextBlockNormal}"
                                                               TargetType="{x:Type TextBlock}">
                                                            <Setter Property="Grid.Row"
                                                                    Value="2" />
                                                            <Style.Triggers>
                                                                <DataTrigger Binding="{Binding SelectedSaleOrder.TaxLocationModel.TaxCodeModel.IsTaxAfterDiscount}"
                                                                             Value="False">
                                                                    <Setter Property="Grid.Row"
                                                                            Value="1" />
                                                                </DataTrigger>
                                                                <DataTrigger Binding="{Binding SelectedSaleOrder.TaxLocationModel.TaxCodeModel.IsTaxAfterDiscount}"
                                                                             Value="True">
                                                                    <Setter Property="Grid.Row"
                                                                            Value="2" />
                                                                </DataTrigger>
                                                            </Style.Triggers>
                                                        </Style>
                                                    </TextBlock.Style>
                                                </TextBlock>
                                                <!--  Style="{DynamicResource TextBlockNormal}"  -->
                                                <cpcTextBox:TextBoxNumeric x:Name="txtOrderTabTaxPercent"
                                                                           Grid.RowSpan="1"
                                                                           Grid.Column="3"
                                                                           Width="35"
                                                                           Margin="0,2"
                                                                           HorizontalAlignment="Left"
                                                                           ConverterCulture="{x:Static local:Define.ConverterCulture}"
                                                                           IsReadOnly="True"
                                                                           NumericStringFormat="{}{0:N0}"
                                                                           Padding="2,0,2,0"
                                                                           TextWrapping="NoWrap"
                                                                           Value="{Binding SelectedSaleOrder.TaxPercent, Mode=OneWay}">
                                                    <cpcTextBox:TextBoxNumeric.Style>
                                                        <Style BasedOn="{StaticResource {x:Type cpcTextBox:TextBoxNumeric}}"
                                                               TargetType="{x:Type cpcTextBox:TextBoxNumeric}">
                                                            <Setter Property="Grid.Row"
                                                                    Value="2" />
                                                            <Style.Triggers>
                                                                <DataTrigger Binding="{Binding SelectedSaleOrder.TaxLocationModel.TaxCodeModel.IsTaxAfterDiscount}"
                                                                             Value="False">
                                                                    <Setter Property="Grid.Row"
                                                                            Value="1" />
                                                                </DataTrigger>
                                                                <DataTrigger Binding="{Binding SelectedSaleOrder.TaxLocationModel.TaxCodeModel.IsTaxAfterDiscount}"
                                                                             Value="True">
                                                                    <Setter Property="Grid.Row"
                                                                            Value="2" />
                                                                </DataTrigger>
                                                            </Style.Triggers>
                                                        </Style>
                                                    </cpcTextBox:TextBoxNumeric.Style>
                                                </cpcTextBox:TextBoxNumeric>
                                                <TextBlock x:Name="txtblOrderTabTaxPercent"
                                                           Grid.Row="2"
                                                           Grid.Column="3"
                                                           Margin="40,0,0,0"
                                                           HorizontalAlignment="Left"
                                                           VerticalAlignment="Center"
                                                           Style="{DynamicResource TextBlockNormal}"
                                                           Text="%"
                                                           TextWrapping="NoWrap" />
                                                <TextBlock x:Name="txtblOrderTabTaxAmount"
                                                           Grid.Column="4"
                                                           Margin="10,0,0,0"
                                                           HorizontalAlignment="Left"
                                                           VerticalAlignment="Center"
                                                           Text="{DynamicResource SO_TextBlock_Tax}"
                                                           TextWrapping="NoWrap">
                                                    <TextBlock.Style>
                                                        <Style BasedOn="{StaticResource TextBlockNormal}"
                                                               TargetType="{x:Type TextBlock}">
                                                            <Setter Property="Grid.Row"
                                                                    Value="2" />
                                                            <Style.Triggers>
                                                                <DataTrigger Binding="{Binding SelectedSaleOrder.TaxLocationModel.TaxCodeModel.IsTaxAfterDiscount}"
                                                                             Value="False">
                                                                    <Setter Property="Grid.Row"
                                                                            Value="1" />
                                                                </DataTrigger>
                                                            </Style.Triggers>
                                                        </Style>
                                                    </TextBlock.Style>
                                                </TextBlock>
                                                <cpcTextBox:TextBoxMoney x:Name="txtOrderTabTax"
                                                                         Grid.RowSpan="1"
                                                                         Grid.Column="5"
                                                                         Margin="0,2"
                                                                         HorizontalContentAlignment="Right"
                                                                         ConverterCulture="{x:Static local:Define.ConverterCulture}"
                                                                         CurrencyStringFormat="{x:Static local:Define.CurrencyFormat}"
                                                                         IsReadOnly="True"
                                                                         Padding="2,0,2,0"
                                                                         TextWrapping="NoWrap"
                                                                         Value="{Binding SelectedSaleOrder.TaxAmount, Mode=OneWay}">
                                                    <cpcTextBox:TextBoxMoney.Style>
                                                        <Style BasedOn="{StaticResource {x:Type cpcTextBox:TextBoxMoney}}"
                                                               TargetType="{x:Type cpcTextBox:TextBoxMoney}">
                                                            <Setter Property="Grid.Row"
                                                                    Value="2" />
                                                            <Style.Triggers>
                                                                <DataTrigger Binding="{Binding SelectedSaleOrder.TaxLocationModel.TaxCodeModel.IsTaxAfterDiscount}"
                                                                             Value="False">
                                                                    <Setter Property="Grid.Row"
                                                                            Value="1" />
                                                                </DataTrigger>
                                                                <DataTrigger Binding="{Binding SelectedSaleOrder.TaxLocationModel.TaxCodeModel.IsTaxAfterDiscount}"
                                                                             Value="True">
                                                                    <Setter Property="Grid.Row"
                                                                            Value="2" />
                                                                </DataTrigger>
                                                            </Style.Triggers>
                                                        </Style>
                                                    </cpcTextBox:TextBoxMoney.Style>
                                                </cpcTextBox:TextBoxMoney>
                                                <TextBlock x:Name="txtblOrderTabShippingHandling"
                                                           Grid.Row="3"
                                                           Grid.Column="4"
                                                           Margin="10,0,0,0"
                                                           HorizontalAlignment="Left"
                                                           VerticalAlignment="Center"
                                                           Style="{DynamicResource TextBlockNormal}"
                                                           Text="{DynamicResource SO_TextBlock_Shipping}"
                                                           TextWrapping="NoWrap" />
                                                <cpcTextBox:TextBoxMoney x:Name="txtOrderTabShippingHandling"
                                                                         Grid.Row="3"
                                                                         Grid.RowSpan="1"
                                                                         Grid.Column="5"
                                                                         Margin="0,2"
                                                                         HorizontalContentAlignment="Right"
                                                                         ConverterCulture="{x:Static local:Define.ConverterCulture}"
                                                                         CurrencyStringFormat="{x:Static local:Define.CurrencyFormat}"
                                                                         Padding="2,0,2,0"
                                                                         SymbolAlignment="Left"
                                                                         TextWrapping="NoWrap"
                                                                         Value="{Binding SelectedSaleOrder.Shipping, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}" />
                                                <Rectangle x:Name="LineOrderTotal"
                                                           Grid.Row="4"
                                                           Grid.Column="2"
                                                           Grid.ColumnSpan="4"
                                                           Height="1"
                                                           Margin="2,0,0,0"
                                                           HorizontalAlignment="Stretch"
                                                           VerticalAlignment="Center"
                                                           Fill="White" />
                                                <TextBlock x:Name="txtblOrderTotal"
                                                           Grid.Row="5"
                                                           Grid.Column="3"
                                                           HorizontalAlignment="Right"
                                                           VerticalAlignment="Center"
                                                           Style="{DynamicResource TextBlockNormal}"
                                                           Text="{DynamicResource C103}"
                                                           TextWrapping="NoWrap" />
                                                <cpcTextBox:TextBoxMoney x:Name="txtOrderTotal"
                                                                         Grid.Row="6"
                                                                         Grid.Column="4"
                                                                         Grid.ColumnSpan="2"
                                                                         Margin="10,2,0,7"
                                                                         HorizontalContentAlignment="Right"
                                                                         ConverterCulture="{x:Static local:Define.ConverterCulture}"
                                                                         CurrencyStringFormat="{x:Static local:Define.CurrencyFormat}"
                                                                         IsReadOnly="True"
                                                                         Padding="2,0,2,0"
                                                                         Style="{DynamicResource TextBoxTotal}"
                                                                         TextWrapping="NoWrap"
                                                                         Value="{Binding SelectedSaleOrder.Total, Mode=OneWay}" />
                                            </Grid>
                                        </Grid>
                                    </AdornerDecorator>
                                </cpcOtherControl:CPCTabItemControl>
                                <cpcOtherControl:CPCTabItemControl x:Name="tabitemShip"
                                                                   Header="{DynamicResource SO_TextBlock_Ship}"
                                                                   IsCheckError="True">
                                    <cpcOtherControl:CPCTabItemControl.Visibility>
                                        <Binding Path="AllowSOShipping"
                                                 Mode="OneWay">
                                            <Binding.Converter>
                                                <converter:BoolToVisibilityConverter FalseToVisibility="Collapsed" />
                                            </Binding.Converter>
                                        </Binding>
                                    </cpcOtherControl:CPCTabItemControl.Visibility>
                                    <AdornerDecorator>
                                        <Grid x:Name="grdShip">
                                            <Grid.RowDefinitions>
                                                <RowDefinition Height="30" />
                                                <RowDefinition Height="Auto"
                                                               MinHeight="5" />
                                                <RowDefinition />
                                                <RowDefinition Height="80" />
                                            </Grid.RowDefinitions>
                                            <Button x:Name="btnPickandPack"
                                                    Command="{Binding PickPackCommand}"
                                                    Width="100"
                                                    Height="21"
                                                    Margin="5,0,0,0"
                                                    HorizontalAlignment="Left"
                                                    VerticalAlignment="Center"
                                                    IsEnabled="{Binding ., ConverterParameter=SO100-04-04, Converter={StaticResource permissionConverter}}">
                                                <StackPanel x:Name="stkpBtnPickandPack"
                                                            HorizontalAlignment="Center"
                                                            VerticalAlignment="Center"
                                                            Orientation="Horizontal">
                                                    <Rectangle x:Name="imgPickandPack"
                                                               Width="20"
                                                               Height="20"
                                                               Fill="{DynamicResource PickPack}" />
                                                    <TextBlock x:Name="txtblPickandPack"
                                                               Margin="5,0,0,0"
                                                               VerticalAlignment="Center"
                                                               Style="{DynamicResource ButtonTextBlock}"
                                                               Text="{DynamicResource SO_TextBlock_PickNPack}"
                                                               TextWrapping="NoWrap" />
                                                </StackPanel>
                                            </Button>
                                            <cpcDataGrid:DataGridControl x:Name="dtgrdShip"
                                                                         Grid.Row="2"
                                                                         Margin="5,0,5,9.633"
                                                                         AutoGenerateColumns="False"
                                                                         CanUserAddRows="False"
                                                                         CanUserDeleteRows="False"
                                                                         CanUserSortColumns="False"
                                                                         DeleteCommandParameter="{Binding SelectedItem, ElementName=dtgrdShip}"
                                                                         DeleteItemCommand="{Binding DeleteSaleOrderShipWithKeyCommand}"
                                                                         IsReadOnly="{Binding SelectedSaleOrder.IsLocked, Mode=OneWay}"
                                                                         IsRollBackData="True"
                                                                         ItemsSource="{Binding SelectedSaleOrder.SaleOrderShipCollection}"
                                                                         RowDetailsVisibilityMode="Collapsed"
                                                                         RowStyle="{DynamicResource DataGridShipMenuContextRowStyle}"
                                                                         SelectedItem="{Binding SelectedSaleOrderShip}"
                                                                         Style="{DynamicResource DatagridWithRowHeader}"
                                                                         VisibilityNavigationBar="Collapsed">
                                                <cpcDataGrid:DataGridControl.Columns>
                                                    <DataGridTextColumn Binding="{Binding ShipDate, StringFormat={x:Static local:Define.DateFormat}}"
                                                                        Width="70"
                                                                        ElementStyle="{StaticResource CenterTextColumn}"
                                                                        IsReadOnly="True">
                                                        <DataGridTextColumn.Header>
                                                            <TextBlock Text="{DynamicResource C149}" />
                                                        </DataGridTextColumn.Header>
                                                    </DataGridTextColumn>
                                                    <DataGridTextColumn Binding="{Binding SaleOrderShipDetailCollection.Count}"
                                                                        Width="*"
                                                                        ElementStyle="{StaticResource CenterTextColumn}"
                                                                        IsReadOnly="True">
                                                        <DataGridTextColumn.Header>
                                                            <TextBlock Text="{DynamicResource SO_TextBlock_PackedQuantity}" />
                                                        </DataGridTextColumn.Header>
                                                    </DataGridTextColumn>
                                                    <DataGridTemplateColumn Width="*">
                                                        <DataGridTemplateColumn.Header>
                                                            <TextBlock Text="{DynamicResource SO_TextBlock_BoxNum}" />
                                                        </DataGridTemplateColumn.Header>
                                                        <DataGridTemplateColumn.CellTemplate>
                                                            <DataTemplate>
                                                                <TextBlock x:Name="tbBox"
                                                                           HorizontalAlignment="Center"
                                                                           Text="{Binding BoxNo}" />
                                                            </DataTemplate>
                                                        </DataGridTemplateColumn.CellTemplate>
                                                        <DataGridTemplateColumn.CellEditingTemplate>
                                                            <DataTemplate>
                                                                <cpcTextBox:TextBoxNumeric x:Name="txtBox"
                                                                                           HorizontalAlignment="Center"
                                                                                           HorizontalContentAlignment="Center"
                                                                                           ConverterCulture="{x:Static local:Define.ConverterCulture}"
                                                                                           NumericStringFormat="{}{0:N0}"
                                                                                           Style="{DynamicResource TextBoxNumericInsideDataGridStyle}"
                                                                                           Value="{Binding BoxNo, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}" />
                                                            </DataTemplate>
                                                        </DataGridTemplateColumn.CellEditingTemplate>
                                                    </DataGridTemplateColumn>
                                                    <DataGridTemplateColumn Width="*">
                                                        <DataGridTemplateColumn.Header>
                                                            <TextBlock Text="{DynamicResource SO_TextBlock_Weights}" />
                                                        </DataGridTemplateColumn.Header>
                                                        <DataGridTemplateColumn.CellTemplate>
                                                            <DataTemplate>
                                                                <TextBlock x:Name="tbWeights"
                                                                           HorizontalAlignment="Right"
                                                                           Text="{Binding Weight, ConverterCulture={x:Static local:Define.ConverterCulture}, Mode=OneWay, StringFormat={x:Static local:Define.NumericFormat}}" />
                                                            </DataTemplate>
                                                        </DataGridTemplateColumn.CellTemplate>
                                                        <DataGridTemplateColumn.CellEditingTemplate>
                                                            <DataTemplate>
                                                                <cpcTextBox:TextBoxNumeric x:Name="txtWeights"
                                                                                           HorizontalContentAlignment="Right"
                                                                                           ConverterCulture="{x:Static local:Define.ConverterCulture}"
                                                                                           MaxLength="30"
                                                                                           NumericStringFormat="{x:Static local:Define.NumericFormat}"
                                                                                           Style="{DynamicResource TextBoxNumericInsideDataGridStyle}"
                                                                                           Value="{Binding Weight, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}" />
                                                            </DataTemplate>
                                                        </DataGridTemplateColumn.CellEditingTemplate>
                                                    </DataGridTemplateColumn>
                                                    <DataGridTemplateColumn Width="*">
                                                        <DataGridTemplateColumn.Header>
                                                            <TextBlock Text="{DynamicResource SO_TextBlock_Carrier}" />
                                                        </DataGridTemplateColumn.Header>
                                                        <DataGridTemplateColumn.CellTemplate>
                                                            <DataTemplate>
                                                                <TextBlock x:Name="tbCarrier"
                                                                           HorizontalAlignment="Center"
                                                                           Text="{Binding Carrier}" />
                                                            </DataTemplate>
                                                        </DataGridTemplateColumn.CellTemplate>
                                                        <DataGridTemplateColumn.CellEditingTemplate>
                                                            <DataTemplate>
                                                                <cpcTextBox:TextBox x:Name="txtCarrier"
                                                                                    HorizontalAlignment="Stretch"
                                                                                    MaxLength="100"
                                                                                    Style="{DynamicResource TextBoxInsideDataGridStyle}"
                                                                                    Text="{Binding Carrier, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}" />
                                                            </DataTemplate>
                                                        </DataGridTemplateColumn.CellEditingTemplate>
                                                    </DataGridTemplateColumn>
                                                    <DataGridTemplateColumn Width="*">
                                                        <DataGridTemplateColumn.Header>
                                                            <TextBlock Text="{DynamicResource SO_TextBlock_TrackingNum}" />
                                                        </DataGridTemplateColumn.Header>
                                                        <DataGridTemplateColumn.CellTemplate>
                                                            <DataTemplate>
                                                                <TextBlock x:Name="tbTracking"
                                                                           HorizontalAlignment="Center"
                                                                           Text="{Binding TrackingNo}" />
                                                            </DataTemplate>
                                                        </DataGridTemplateColumn.CellTemplate>
                                                        <DataGridTemplateColumn.CellEditingTemplate>
                                                            <DataTemplate>
                                                                <cpcTextBox:TextBox x:Name="txtTracking"
                                                                                    HorizontalAlignment="Stretch"
                                                                                    MaxLength="30"
                                                                                    Style="{DynamicResource TextBoxInsideDataGridStyle}"
                                                                                    Text="{Binding TrackingNo, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}" />
                                                            </DataTemplate>
                                                        </DataGridTemplateColumn.CellEditingTemplate>
                                                    </DataGridTemplateColumn>
                                                    <DataGridTemplateColumn Width="30"
                                                                            MinWidth="30"
                                                                            CellStyle="{DynamicResource DataGridCellDisableStyle}">
                                                        <DataGridTemplateColumn.CellTemplate>
                                                            <DataTemplate>
                                                                <!--
                                                                    <CheckBox HorizontalAlignment="Center"
                                                                    VerticalAlignment="Center"
                                                                    Style="{DynamicResource CheckBoxInsideDataGridStyle}"
                                                                    IsChecked="{Binding IsChecked,
                                                                    Mode=OneWay,
                                                                    UpdateSourceTrigger=PropertyChanged}"
                                                                    IsEnabled="False">
                                                                    <i:Interaction.Triggers>
                                                                    <i:EventTrigger EventName="Click">
                                                                    <command:EventToCommand Command="{Binding DataContext.ShippedCommand, RelativeSource={RelativeSource AncestorType={x:Type DataGrid}}}"
                                                                    CommandParameter="{Binding .}" />
                                                                    </i:EventTrigger>
                                                                    </i:Interaction.Triggers>
                                                                    </CheckBox>
                                                                -->
                                                                <ToggleButton x:Name="tgShipped"
                                                                              Width="25"
                                                                              Height="25"
                                                                              HorizontalAlignment="Stretch"
                                                                              IsChecked="{Binding IsChecked, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}"
                                                                              IsEnabled="{Binding IsShipped, Converter={StaticResource reserseBoolConverter}, Mode=OneWay, UpdateSourceTrigger=PropertyChanged}"
                                                                              Style="{DynamicResource ToggleButtonTrueFalse}">
                                                                    <i:Interaction.Triggers>
                                                                        <i:EventTrigger EventName="Click">
                                                                            <command:EventToCommand Command="{Binding DataContext.ShippedCommand, RelativeSource={RelativeSource AncestorType={x:Type DataGrid}}}"
                                                                                                    CommandParameter="{Binding .}" />
                                                                        </i:EventTrigger>
                                                                    </i:Interaction.Triggers>
                                                                </ToggleButton>
                                                            </DataTemplate>
                                                        </DataGridTemplateColumn.CellTemplate>
                                                        <DataGridTemplateColumn.CellEditingTemplate>
                                                            <DataTemplate>
                                                                <ToggleButton x:Name="tgShipped"
                                                                              Width="25"
                                                                              Height="25"
                                                                              HorizontalAlignment="Stretch"
                                                                              IsChecked="{Binding IsChecked, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}"
                                                                              IsEnabled="{Binding IsShipped, Converter={StaticResource reserseBoolConverter}, Mode=OneWay, UpdateSourceTrigger=PropertyChanged}"
                                                                              Style="{DynamicResource ToggleButtonTrueFalse}">
                                                                    <i:Interaction.Triggers>
                                                                        <i:EventTrigger EventName="Click">
                                                                            <command:EventToCommand Command="{Binding DataContext.ShippedCommand, RelativeSource={RelativeSource AncestorType={x:Type DataGrid}}}"
                                                                                                    CommandParameter="{Binding .}" />
                                                                        </i:EventTrigger>
                                                                    </i:Interaction.Triggers>
                                                                </ToggleButton>
                                                                <!--
                                                                    <CheckBox HorizontalAlignment="Center"
                                                                    VerticalAlignment="Center"
                                                                    IsChecked="{Binding IsChecked,
                                                                    Mode=TwoWay,
                                                                    UpdateSourceTrigger=PropertyChanged}"
                                                                    IsEnabled="{Binding IsShipped,
                                                                    Mode=OneWay,
                                                                    UpdateSourceTrigger=PropertyChanged,
                                                                    Converter={StaticResource reserseBoolConverter}}">
                                                                    <i:Interaction.Triggers>
                                                                    <i:EventTrigger EventName="Click">
                                                                    <command:EventToCommand Command="{Binding DataContext.ShippedCommand, RelativeSource={RelativeSource AncestorType={x:Type DataGrid}}}"
                                                                    CommandParameter="{Binding .}" />
                                                                    </i:EventTrigger>
                                                                    </i:Interaction.Triggers>
                                                                    </CheckBox>
                                                                -->
                                                            </DataTemplate>
                                                        </DataGridTemplateColumn.CellEditingTemplate>
                                                    </DataGridTemplateColumn>
                                                </cpcDataGrid:DataGridControl.Columns>
                                            </cpcDataGrid:DataGridControl>
                                            <Grid x:Name="grdShipRemark"
                                                  Grid.Row="3"
                                                  Margin="5,0">
                                                <Grid.ColumnDefinitions>
                                                    <ColumnDefinition Width="110" />
                                                    <ColumnDefinition Width="132" />
                                                    <ColumnDefinition />
                                                    <ColumnDefinition Width="200" />
                                                </Grid.ColumnDefinitions>
                                                <Grid.RowDefinitions>
                                                    <RowDefinition Height="25" />
                                                    <RowDefinition Height="25" />
                                                    <RowDefinition Height="25" />
                                                </Grid.RowDefinitions>
                                                <TextBlock x:Name="txtblShipPackedBoxes"
                                                           Grid.Column="3"
                                                           Margin="0"
                                                           HorizontalAlignment="Left"
                                                           VerticalAlignment="Center"
                                                           Style="{DynamicResource TextBlockNormal}"
                                                           Text="{DynamicResource SO_TextBlock_PackedBoxes}"
                                                           TextWrapping="NoWrap" />
                                                <TextBlock x:Name="txtblBindingShipPackedBoxes"
                                                           Grid.Column="3"
                                                           Margin="0,0,65,0"
                                                           HorizontalAlignment="Right"
                                                           VerticalAlignment="Center"
                                                           Style="{DynamicResource TextBlockNormal}"
                                                           Text="{Binding SelectedSaleOrder.PackedQty, Mode=OneWay}"
                                                           TextWrapping="NoWrap" />
                                                <TextBlock x:Name="txtblShippedBoxes"
                                                           Grid.Row="1"
                                                           Grid.Column="3"
                                                           Margin="0"
                                                           HorizontalAlignment="Left"
                                                           VerticalAlignment="Center"
                                                           Style="{DynamicResource TextBlockNormal}"
                                                           Text="{DynamicResource SO_TextBlock_ShippedBoxes}"
                                                           TextWrapping="NoWrap" />
                                                <TextBlock x:Name="txtblBindingShippedBoxes"
                                                           Grid.Row="1"
                                                           Grid.Column="3"
                                                           Margin="0,0,65,0"
                                                           HorizontalAlignment="Right"
                                                           VerticalAlignment="Center"
                                                           Style="{DynamicResource TextBlockNormal}"
                                                           Text="{Binding SelectedSaleOrder.ShippedBox, Mode=OneWay}"
                                                           TextWrapping="NoWrap" />
                                                <TextBlock x:Name="txtblTotalWeight"
                                                           Grid.Row="2"
                                                           Grid.Column="3"
                                                           Margin="0"
                                                           HorizontalAlignment="Left"
                                                           VerticalAlignment="Center"
                                                           Style="{DynamicResource TextBlockNormal}"
                                                           Text="{DynamicResource SO_TextBlock_TotalWeight}"
                                                           TextWrapping="NoWrap" />
                                                <TextBlock x:Name="txtblBindingTotalWeight"
                                                           Grid.Row="2"
                                                           Grid.Column="3"
                                                           Margin="0,0,65,0"
                                                           HorizontalAlignment="Right"
                                                           VerticalAlignment="Center"
                                                           Style="{DynamicResource TextBlockNormal}"
                                                           Text="{Binding SelectedSaleOrder.TotalWeight, Mode=OneWay, StringFormat=\{0:00.00\}}"
                                                           TextWrapping="NoWrap" />
                                                <ComboBox x:Name="cmbTotalWeight"
                                                          Grid.Row="2"
                                                          Grid.Column="3"
                                                          Width="50"
                                                          Margin="0,2,10,2"
                                                          HorizontalAlignment="Right"
                                                          VerticalAlignment="Stretch"
                                                          DisplayMemberPath="Text"
                                                          ItemsSource="{x:Static helper:Common.ShipUnits}"
                                                          SelectedValue="{Binding SelectedSaleOrder.WeightUnit, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}"
                                                          SelectedValuePath="ObjValue" />
                                            </Grid>
                                        </Grid>
                                    </AdornerDecorator>
                                </cpcOtherControl:CPCTabItemControl>
                                <cpcOtherControl:CPCTabItemControl x:Name="tabitemPaymentHistory"
                                                                   Header="{DynamicResource SO_TextBlock_PaymentHistory}"
                                                                   IsCheckError="True">
                                    <cpcOtherControl:CPCTabItemControl.Visibility>
                                        <Binding Path="SelectedSaleOrder.PaymentProcess"
                                                 Mode="OneWay">
                                            <Binding.Converter>
                                                <converter:BoolToVisibilityConverter FalseToVisibility="Collapsed" />
                                            </Binding.Converter>
                                        </Binding>
                                    </cpcOtherControl:CPCTabItemControl.Visibility>
                                    <Grid x:Name="grdItemPayment">
                                        <Grid.RowDefinitions>
                                            <RowDefinition Height="Auto"
                                                           MinHeight="5" />
                                            <RowDefinition />
                                            <RowDefinition Height="85.139" />
                                        </Grid.RowDefinitions>
                                        <cpcDataGrid:DataGridControl x:Name="dtgrdPaymentHistory"
                                                                     Grid.Row="1"
                                                                     Margin="5,0,5,5"
                                                                     AutoGenerateColumns="False"
                                                                     CanUserAddRows="False"
                                                                     CanUserDeleteRows="False"
                                                                     cpcBehavior:DoubleClickCommandBehavior.DoubleClickCommand="{Binding PaymentHistoryDetailCommand}"
                                                                     cpcBehavior:DoubleClickCommandBehavior.DoubleClickCommandParameter="{Binding SelectedItem, ElementName=dtgrdPaymentHistory}"
                                                                     IsPaging="False"
                                                                     IsReadOnly="True"
                                                                     IsRollBackData="False"
                                                                     ItemsSource="{Binding SelectedSaleOrder.PaymentCollection, Mode=OneWay}"
                                                                     RowStyle="{DynamicResource DataGridPaymentRowStyle}"
                                                                     Style="{DynamicResource DatagridWithRowHeader}"
                                                                     VisibilityNavigationBar="Collapsed">
                                            <cpcDataGrid:DataGridControl.Columns>
                                                <DataGridTextColumn Binding="{Binding DateCreated, Mode=OneWay, StringFormat={x:Static local:Define.DateFormat}}"
                                                                    Width="70"
                                                                    ElementStyle="{StaticResource CenterTextColumn}"
                                                                    IsReadOnly="True">
                                                    <DataGridTextColumn.Header>
                                                        <TextBlock Text="{DynamicResource C105}" />
                                                    </DataGridTextColumn.Header>
                                                </DataGridTextColumn>
                                                <DataGridTextColumn Binding="{Binding TotalAmount, ConverterCulture={x:Static local:Define.ConverterCulture}, Mode=OneWay, StringFormat={x:Static local:Define.CurrencyFormat}}"
                                                                    Width="*"
                                                                    ElementStyle="{StaticResource NumberTextBlock}"
                                                                    IsReadOnly="True">
                                                    <DataGridTextColumn.Header>
                                                        <TextBlock Text="{DynamicResource SO_TextBlock_TotalAmount}" />
                                                    </DataGridTextColumn.Header>
                                                </DataGridTextColumn>
                                                <DataGridTextColumn Binding="{Binding TotalPaid, ConverterCulture={x:Static local:Define.ConverterCulture}, Mode=OneWay, StringFormat={x:Static local:Define.CurrencyFormat}}"
                                                                    Width="*"
                                                                    ElementStyle="{StaticResource NumberTextBlock}"
                                                                    IsReadOnly="True">
                                                    <DataGridTextColumn.Header>
                                                        <TextBlock Text="{DynamicResource SO_TextBlock_TotalPaid}" />
                                                    </DataGridTextColumn.Header>
                                                </DataGridTextColumn>
                                                <DataGridTextColumn Binding="{Binding Balance, ConverterCulture={x:Static local:Define.ConverterCulture}, Mode=OneWay, StringFormat={x:Static local:Define.CurrencyFormat}}"
                                                                    Width="*"
                                                                    ElementStyle="{StaticResource NumberTextBlock}"
                                                                    IsReadOnly="True">
                                                    <DataGridTextColumn.Header>
                                                        <TextBlock Text="{DynamicResource C108}" />
                                                    </DataGridTextColumn.Header>
                                                </DataGridTextColumn>
                                                <DataGridTextColumn Binding="{Binding Change, ConverterCulture={x:Static local:Define.ConverterCulture}, Mode=OneWay, StringFormat={x:Static local:Define.CurrencyFormat}}"
                                                                    Width="*"
                                                                    ElementStyle="{StaticResource NumberTextBlock}"
                                                                    IsReadOnly="True">
                                                    <DataGridTextColumn.Header>
                                                        <TextBlock Text="{DynamicResource SO_TextBlock_Change}" />
                                                    </DataGridTextColumn.Header>
                                                </DataGridTextColumn>
                                            </cpcDataGrid:DataGridControl.Columns>
                                        </cpcDataGrid:DataGridControl>
                                        <Grid x:Name="grdSubTotal"
                                              Grid.Row="2"
                                              Margin="5,0">
                                            <Grid.ColumnDefinitions>
                                                <ColumnDefinition Width="110" />
                                                <ColumnDefinition />
                                                <ColumnDefinition Width="50" />
                                                <ColumnDefinition Width="126" />
                                            </Grid.ColumnDefinitions>
                                            <Grid.RowDefinitions>
                                                <RowDefinition Height="25" />
                                                <RowDefinition Height="25" />
                                                <RowDefinition Height="35" />
                                                <RowDefinition Height="0" />
                                                <RowDefinition Height="0" />
                                            </Grid.RowDefinitions>
                                            <TextBlock x:Name="txtblTotal"
                                                       Grid.Column="2"
                                                       HorizontalAlignment="Left"
                                                       VerticalAlignment="Center"
                                                       Style="{DynamicResource TextBlockNormal}"
                                                       Text="{DynamicResource C103}"
                                                       TextWrapping="NoWrap" />
                                            <cpcTextBox:TextBoxMoney x:Name="txtTotal"
                                                                     Grid.RowSpan="1"
                                                                     Grid.Column="3"
                                                                     Height="21"
                                                                     Margin="0,0,0,2"
                                                                     ConverterCulture="{x:Static local:Define.ConverterCulture}"
                                                                     CurrencyStringFormat="{x:Static local:Define.CurrencyFormat}"
                                                                     FontWeight="Bold"
                                                                     IsReadOnly="True"
                                                                     Padding="2,0,2,0"
                                                                     TextWrapping="NoWrap"
                                                                     Value="{Binding SelectedSaleOrder.RewardAmount, Mode=OneWay}" />
                                            <TextBlock x:Name="txtblPaid"
                                                       Grid.Row="1"
                                                       Grid.Column="2"
                                                       HorizontalAlignment="Left"
                                                       VerticalAlignment="Center"
                                                       Style="{DynamicResource TextBlockNormal}"
                                                       Text="{DynamicResource C107}"
                                                       TextWrapping="NoWrap" />
                                            <cpcTextBox:TextBoxMoney x:Name="txtPaid"
                                                                     Grid.Row="1"
                                                                     Grid.RowSpan="1"
                                                                     Grid.Column="3"
                                                                     Height="21"
                                                                     Margin="0,2,0,0"
                                                                     ConverterCulture="{x:Static local:Define.ConverterCulture}"
                                                                     CurrencyStringFormat="{x:Static local:Define.CurrencyFormat}"
                                                                     IsReadOnly="True"
                                                                     Padding="2,0,2,0"
                                                                     TextWrapping="NoWrap"
                                                                     Value="{Binding SelectedSaleOrder.Paid, Mode=OneWay}">
                                                <cpcTextBox:TextBoxMoney.Style>
                                                    <Style BasedOn="{StaticResource {x:Type cpcTextBox:TextBoxMoney}}"
                                                           TargetType="{x:Type cpcTextBox:TextBoxMoney}">
                                                        <Setter Property="Grid.Row"
                                                                Value="2" />
                                                        <Style.Triggers>
                                                            <DataTrigger Binding="{Binding SelectedSaleOrder.TaxLocationModel.TaxCodeModel.IsTaxAfterDiscount}"
                                                                         Value="False">
                                                                <Setter Property="Grid.Row"
                                                                        Value="1" />
                                                            </DataTrigger>
                                                            <DataTrigger Binding="{Binding SelectedSaleOrder.TaxLocationModel.TaxCodeModel.IsTaxAfterDiscount}"
                                                                         Value="True">
                                                                <Setter Property="Grid.Row"
                                                                        Value="2" />
                                                            </DataTrigger>
                                                        </Style.Triggers>
                                                    </Style>
                                                </cpcTextBox:TextBoxMoney.Style>
                                            </cpcTextBox:TextBoxMoney>
                                            <TextBlock x:Name="txtblBalance"
                                                       Grid.Row="2"
                                                       Grid.Column="2"
                                                       Margin="0"
                                                       HorizontalAlignment="Left"
                                                       VerticalAlignment="Center"
                                                       Style="{DynamicResource TextBlockNormal}"
                                                       Text="{DynamicResource C108}"
                                                       TextWrapping="NoWrap" />
                                            <cpcTextBox:TextBoxMoney x:Name="txtBalance"
                                                                     Grid.Row="2"
                                                                     Grid.Column="3"
                                                                     Margin="0,2"
                                                                     ConverterCulture="{x:Static local:Define.ConverterCulture}"
                                                                     CurrencyStringFormat="{x:Static local:Define.CurrencyFormat}"
                                                                     IsReadOnly="True"
                                                                     Padding="2,0,2,0"
                                                                     Style="{DynamicResource TextBoxTotal}"
                                                                     TextWrapping="NoWrap"
                                                                     Value="{Binding SelectedSaleOrder.Balance, Mode=OneWay}" />
                                        </Grid>
                                    </Grid>
                                </cpcOtherControl:CPCTabItemControl>
                                <cpcOtherControl:CPCTabItemControl x:Name="tabitemReturn"
                                                                   Header="{DynamicResource SO_TextBlock_Return}"
                                                                   Width="Auto"
                                                                   HorizontalAlignment="Stretch">
                                    <cpcOtherControl:CPCTabItemControl.Visibility>
                                        <Binding Path="AllowSOReturn"
                                                 Mode="OneWay">
                                            <Binding.Converter>
                                                <converter:BoolToVisibilityConverter FalseToVisibility="Collapsed" />
                                            </Binding.Converter>
                                        </Binding>
                                    </cpcOtherControl:CPCTabItemControl.Visibility>
                                    <AdornerDecorator>
                                        <Grid x:Name="grdContentReturn">
                                            <Grid.RowDefinitions>
                                                <RowDefinition Height="30" />
                                                <RowDefinition Height="Auto"
                                                               MinHeight="5" />
                                                <RowDefinition />
                                                <RowDefinition Height="110.146" />
                                            </Grid.RowDefinitions>
                                            <Button x:Name="btnReturnAll"
                                                    Command="{Binding ReturnAllCommand}"
                                                    Width="100"
                                                    Height="21"
                                                    Margin="5,0,0,0"
                                                    HorizontalAlignment="Left"
                                                    VerticalAlignment="Center">
                                                <StackPanel x:Name="stkpBtnReturnAll"
                                                            HorizontalAlignment="Center"
                                                            VerticalAlignment="Center"
                                                            Orientation="Horizontal">
                                                    <Rectangle x:Name="imgReturnAll"
                                                               Width="20"
                                                               Height="20"
                                                               Fill="{DynamicResource POReturn}" />
                                                    <TextBlock x:Name="txtblReturnAll"
                                                               Margin="5,0,0,0"
                                                               VerticalAlignment="Center"
                                                               Style="{DynamicResource ButtonTextBlock}"
                                                               Text="{DynamicResource C109}"
                                                               TextWrapping="NoWrap" />
                                                </StackPanel>
                                            </Button>
                                            <cpcDataGrid:DataGridControl x:Name="dtgrdReturn"
                                                                         CommandParameter="{Binding SelectedItem, ElementName=dtgrdReturn}"
                                                                         Grid.Row="2"
                                                                         Margin="5,0,5,5"
                                                                         AutoGenerateColumns="False"
                                                                         CanUserDeleteRows="False"
                                                                         cpcBehavior:DataGridHiddenColunmHelper.ColunmIndex="8"
                                                                         cpcBehavior:DataGridHiddenColunmHelper.IsHiddenColunm="{Binding SelectedSaleOrder.IsRedeeem, Converter={StaticResource reserseBoolConverter}, Mode=OneWay}"
                                                                         DeleteItemCommand="{Binding DeleteReturnDetailWithKeyCommand}"
                                                                         HorizontalScrollBarVisibility="Auto"
                                                                         IsRollBackData="False"
                                                                         ItemsSource="{Binding SelectedSaleOrder.ReturnModel.ReturnDetailCollection, Mode=OneWay}"
                                                                         RowStyle="{DynamicResource DataGridReturnRowStyle}"
                                                                         SelectedItem="{Binding SelectedReturnDetail, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}"
                                                                         SelectionMode="Single"
                                                                         SelectionUnit="FullRow"
                                                                         Style="{DynamicResource DatagridWithRowHeader}"
                                                                         VisibilityNavigationBar="Collapsed">
                                                <!--
                                                    <cpcDataGrid:DataGridControl.RowValidationRules>
                                                    <helper:RowDataInfoValidationRule ValidationStep="UpdatedValue" />
                                                    </cpcDataGrid:DataGridControl.RowValidationRules>
                                                -->
                                                <cpcDataGrid:DataGridControl.Columns>
                                                    <DataGridTemplateColumn Width="70"
                                                                            CellStyle="{DynamicResource DataGridCellDisableStyle}">
                                                        <DataGridTemplateColumn.Header>
                                                            <TextBlock Text="{DynamicResource C130}" />
                                                        </DataGridTemplateColumn.Header>
                                                        <DataGridTemplateColumn.CellTemplate>
                                                            <DataTemplate>
                                                                <TextBlock HorizontalAlignment="Center"
                                                                           Text="{Binding ReturnedDate, Mode=OneWay, StringFormat={x:Static local:Define.DateFormat}}" />
                                                            </DataTemplate>
                                                        </DataGridTemplateColumn.CellTemplate>
                                                        <DataGridTemplateColumn.CellEditingTemplate>
                                                            <DataTemplate>
                                                                <DatePicker x:Name="dtpReturnedDate"
                                                                            HorizontalAlignment="Center"
                                                                            SelectedDate="{Binding ReturnedDate, Converter={StaticResource NullToDefaultValueConverter}, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}"
                                                                            Style="{DynamicResource DatePickerInsideDataGridStyle}" />
                                                            </DataTemplate>
                                                        </DataGridTemplateColumn.CellEditingTemplate>
                                                    </DataGridTemplateColumn>

                                                    <DataGridTemplateColumn Width="300"
                                                                            CellStyle="{DynamicResource DataGridCellDisableStyle}">
                                                        <DataGridTemplateColumn.Header>
                                                            <TextBlock Text="{DynamicResource C115}" />
                                                        </DataGridTemplateColumn.Header>
                                                        <DataGridTemplateColumn.CellTemplate>
                                                            <DataTemplate>
                                                                <TextBlock HorizontalAlignment="Left"
                                                                           Text="{Binding ItemName, Mode=OneWay}" />
                                                            </DataTemplate>
                                                        </DataGridTemplateColumn.CellTemplate>
                                                        <DataGridTemplateColumn.CellEditingTemplate>
                                                            <DataTemplate>
                                                                <cpcAutoComplete:AutoCompleteTextBox x:Name="atCompleteTextBoxItemCode"
                                                                                                     AutoChangeSelectedItem="False"
                                                                                                     FieldShow="ItemName"
                                                                                                     FieldSource="{Binding DataContext.SaleOrderShipDetailFieldCollection, RelativeSource={RelativeSource AncestorType={x:Type UserControl}, Mode=FindAncestor}}"
                                                                                                     FilterMode="Contains"
                                                                                                     Foreground="Black"
                                                                                                     IsTextCompletionEnabled="True"
                                                                                                     ItemsSource="{Binding DataContext.SelectedSaleOrder.SaleOrderShippedCollection, RelativeSource={RelativeSource AncestorType={x:Type UserControl}, Mode=FindAncestor}}"
                                                                                                     SelectedItemResult="{Binding SaleOrderDetailModel, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}"
                                                                                                     Style="{DynamicResource AutoCompleteInsideDataGridStyle}">
                                                                    <cpcAutoComplete:AutoCompleteTextBox.Columns>
                                                                        <GridViewColumn Header="{DynamicResource C175}"
                                                                                        Width="130"
                                                                                        DisplayMemberBinding="{Binding ItemName}" />
                                                                        <GridViewColumn Header="{DynamicResource C116}"
                                                                                        Width="90"
                                                                                        DisplayMemberBinding="{Binding ItemAtribute}" />
                                                                        <GridViewColumn Header="{DynamicResource C117}"
                                                                                        Width="90"
                                                                                        DisplayMemberBinding="{Binding ItemSize}" />
                                                                    </cpcAutoComplete:AutoCompleteTextBox.Columns>
                                                                </cpcAutoComplete:AutoCompleteTextBox>
                                                            </DataTemplate>
                                                        </DataGridTemplateColumn.CellEditingTemplate>
                                                    </DataGridTemplateColumn>

                                                    <DataGridTextColumn Binding="{Binding ItemAtribute, Mode=OneWay}"
                                                                        Width="80"
                                                                        IsReadOnly="True">
                                                        <DataGridTextColumn.Header>
                                                            <TextBlock Text="{DynamicResource C116}" />
                                                        </DataGridTextColumn.Header>
                                                    </DataGridTextColumn>

                                                    <DataGridTextColumn Binding="{Binding ItemSize, Mode=OneWay}"
                                                                        Width="80"
                                                                        IsReadOnly="True">
                                                        <DataGridTextColumn.Header>
                                                            <TextBlock Text="{DynamicResource C117}" />
                                                        </DataGridTextColumn.Header>
                                                    </DataGridTextColumn>

                                                    <DataGridTemplateColumn Width="75"
                                                                            CellStyle="{StaticResource DataGridCellDisableStyle}">
                                                        <DataGridTemplateColumn.Header>
                                                            <TextBlock Text="{DynamicResource C131}" />
                                                        </DataGridTemplateColumn.Header>
                                                        <DataGridTemplateColumn.CellTemplate>
                                                            <DataTemplate>
                                                                <TextBlock HorizontalAlignment="Right"
                                                                           Text="{Binding ReturnQty, ConverterCulture={x:Static local:Define.ConverterCulture}, Mode=OneWay, StringFormat={x:Static local:Define.NumericFormat}}" />
                                                            </DataTemplate>
                                                        </DataGridTemplateColumn.CellTemplate>
                                                        <DataGridTemplateColumn.CellEditingTemplate>
                                                            <DataTemplate>
                                                                <cpcTextBox:TextBoxNumeric x:Name="txtReturnQty"
                                                                                           ConverterCulture="{x:Static local:Define.ConverterCulture}"
                                                                                           NumericStringFormat="{x:Static local:Define.NumericFormat}"
                                                                                           Style="{DynamicResource TextBoxNumericInsideDataGridStyle}"
                                                                                           Value="{Binding ReturnQty, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}" />
                                                            </DataTemplate>
                                                        </DataGridTemplateColumn.CellEditingTemplate>
                                                    </DataGridTemplateColumn>

                                                    <DataGridTextColumn Binding="{Binding UnitName, Mode=OneWay}"
                                                                        Width="80"
                                                                        IsReadOnly="True">
                                                        <DataGridTextColumn.Header>
                                                            <TextBlock Text="{DynamicResource C118}" />
                                                        </DataGridTextColumn.Header>
                                                    </DataGridTextColumn>

                                                    <DataGridTextColumn Binding="{Binding Price, ConverterCulture={x:Static local:Define.ConverterCulture}, Mode=OneWay, StringFormat={x:Static local:Define.CurrencyFormat}}"
                                                                        Width="80"
                                                                        ElementStyle="{StaticResource NumberTextBlock}">
                                                        <DataGridTextColumn.Header>
                                                            <TextBlock Text="{DynamicResource C119}" />
                                                        </DataGridTextColumn.Header>
                                                    </DataGridTextColumn>

                                                    <DataGridTextColumn Binding="{Binding VAT, ConverterCulture={x:Static local:Define.ConverterCulture}, Mode=OneWay, StringFormat={x:Static local:Define.CurrencyFormat}}"
                                                                        Width="80"
                                                                        ElementStyle="{StaticResource NumberTextBlock}">
                                                        <DataGridTextColumn.Header>
                                                            <TextBlock Text="{DynamicResource SO_TextBlock_Tax}" />
                                                        </DataGridTextColumn.Header>
                                                    </DataGridTextColumn>

                                                    <DataGridTextColumn Binding="{Binding RewardRedeem, ConverterCulture={x:Static local:Define.ConverterCulture}, Mode=OneWay, StringFormat={x:Static local:Define.CurrencyFormat}}"
                                                                        Width="80"
                                                                        ElementStyle="{StaticResource NumberTextBlock}">
                                                        <DataGridTextColumn.Header>
                                                            <TextBlock Text="Reward Redeem" />
                                                        </DataGridTextColumn.Header>
                                                    </DataGridTextColumn>

                                                    <DataGridTextColumn Binding="{Binding SubTotalDetail, ConverterCulture={x:Static local:Define.ConverterCulture}, Mode=OneWay, StringFormat={x:Static local:Define.CurrencyFormat}}"
                                                                        Width="80"
                                                                        ElementStyle="{StaticResource NumberTextBlock}">
                                                        <DataGridTextColumn.Header>
                                                            <TextBlock Text="{DynamicResource C122}" />
                                                        </DataGridTextColumn.Header>
                                                    </DataGridTextColumn>

                                                    <DataGridTemplateColumn Width="75"
                                                                            CellStyle="{DynamicResource DataGridCellDisableStyle}">
                                                        <DataGridTemplateColumn.Header>
                                                            <TextBlock Text="{DynamicResource C132}" />
                                                        </DataGridTemplateColumn.Header>
                                                        <DataGridTemplateColumn.CellTemplate>
                                                            <DataTemplate>
                                                                <ToggleButton x:Name="tgReturned"
                                                                              Width="25"
                                                                              Height="25"
                                                                              HorizontalAlignment="Stretch"
                                                                              IsChecked="{Binding IsReturned, Mode=TwoWay, TargetNullValue=False, UpdateSourceTrigger=PropertyChanged}"
                                                                              IsEnabled="{Binding IsReturned, Converter={StaticResource reserseBoolConverter}, Mode=OneWay, UpdateSourceTrigger=PropertyChanged}"
                                                                              Style="{StaticResource ToggleButtonTrueFalse}"
                                                                              Visibility="Collapsed" />
                                                                <DataTemplate.Triggers>
                                                                    <DataTrigger Binding="{Binding IsTemporary, Mode=OneWay}"
                                                                                 Value="False">
                                                                        <Setter TargetName="tgReturned"
                                                                                Property="Visibility"
                                                                                Value="Visible" />
                                                                    </DataTrigger>
                                                                </DataTemplate.Triggers>
                                                                <!--
                                                                    <TextBlock Style="{StaticResource ReturnedTextBlockStyle}"
                                                                    Text="{Binding IsReturned, Mode=OneWay}" />
                                                                -->
                                                            </DataTemplate>
                                                        </DataGridTemplateColumn.CellTemplate>
                                                        <DataGridTemplateColumn.CellEditingTemplate>
                                                            <DataTemplate>
                                                                <ToggleButton x:Name="tgReturned"
                                                                              Width="25"
                                                                              Height="25"
                                                                              HorizontalAlignment="Stretch"
                                                                              IsChecked="{Binding IsReturned, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}"
                                                                              Style="{StaticResource ToggleButtonTrueFalse}" />

                                                            </DataTemplate>
                                                        </DataGridTemplateColumn.CellEditingTemplate>
                                                    </DataGridTemplateColumn>
                                                </cpcDataGrid:DataGridControl.Columns>
                                            </cpcDataGrid:DataGridControl>
                                            <Grid x:Name="grdReturnSubTotal"
                                                  Grid.Row="3"
                                                  Margin="5,0"
                                                  VerticalAlignment="Top">
                                                <Grid.ColumnDefinitions>
                                                    <ColumnDefinition Width="100" />
                                                    <ColumnDefinition Width="125" />
                                                    <ColumnDefinition />
                                                    <ColumnDefinition Width="101" />
                                                    <ColumnDefinition Width="75" />
                                                    <ColumnDefinition Width="117" />
                                                </Grid.ColumnDefinitions>
                                                <Grid.RowDefinitions>
                                                    <RowDefinition Height="25" />
                                                    <RowDefinition Height="0" />
                                                    <RowDefinition Height="25" />
                                                    <RowDefinition Height="25" />
                                                    <RowDefinition Height="35" />
                                                </Grid.RowDefinitions>
                                                <TextBlock x:Name="txtblReturnSubTotal1"
                                                           Grid.Column="4"
                                                           Margin="10,0,0,0"
                                                           HorizontalAlignment="Left"
                                                           VerticalAlignment="Center"
                                                           Style="{DynamicResource TextBlockNormal}"
                                                           Text="{DynamicResource C112}"
                                                           TextWrapping="NoWrap" />
                                                <!--  SubTotal  -->
                                                <cpcTextBox:TextBoxMoney x:Name="txtReturnSubTotal1"
                                                                         Grid.RowSpan="1"
                                                                         Grid.Column="5"
                                                                         Margin="0,2"
                                                                         HorizontalContentAlignment="Right"
                                                                         ConverterCulture="{x:Static local:Define.ConverterCulture}"
                                                                         CurrencyStringFormat="{x:Static local:Define.CurrencyFormat}"
                                                                         IsReadOnly="True"
                                                                         MaxLength="{StaticResource SubTotalMaxLength}"
                                                                         Padding="2,0,2,0"
                                                                         TextWrapping="NoWrap"
                                                                         Value="{Binding SelectedSaleOrder.ReturnModel.SubTotal, Mode=OneWay, UpdateSourceTrigger=PropertyChanged}" />
                                                <cpcTextBox:TextBoxNumeric x:Name="txtReturnReturnFeePercent"
                                                                           Grid.Row="1"
                                                                           Grid.RowSpan="1"
                                                                           Grid.Column="3"
                                                                           Width="50"
                                                                           Margin="0,2"
                                                                           HorizontalAlignment="Left"
                                                                           ConverterCulture="{x:Static local:Define.ConverterCulture}"
                                                                           IsEnabled="{Binding IsIncludeReturnFee, Mode=OneWay}"
                                                                           IsReadOnly="{Binding SelectedSaleOrder.IsLocked, Mode=OneWay}"
                                                                           NumericStringFormat="{}{0:N0}"
                                                                           Padding="2,0,2,0"
                                                                           TextWrapping="NoWrap"
                                                                           Value="{Binding SelectedSaleOrder.ReturnModel.ReturnFeePercent, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}" />
                                                <TextBlock x:Name="txtblReturnFee"
                                                           Grid.Row="1"
                                                           Grid.Column="4"
                                                           Margin="8,0,0,0"
                                                           HorizontalAlignment="Left"
                                                           VerticalAlignment="Center"
                                                           Style="{DynamicResource TextBlockNormal}"
                                                           Text="{DynamicResource C111}"
                                                           TextWrapping="NoWrap" />
                                                <cpcTextBox:TextBoxMoney x:Name="txtReturnReturnFee"
                                                                         Grid.Row="1"
                                                                         Grid.RowSpan="1"
                                                                         Grid.Column="5"
                                                                         Margin="0,2"
                                                                         ConverterCulture="{x:Static local:Define.ConverterCulture}"
                                                                         CurrencyStringFormat="{x:Static local:Define.CurrencyFormat}"
                                                                         IsEnabled="{Binding IsIncludeReturnFee, Mode=OneWay}"
                                                                         IsReadOnly="{Binding SelectedSaleOrder.IsLocked, Mode=OneWay}"
                                                                         Padding="2,0,2,0"
                                                                         TextWrapping="NoWrap"
                                                                         Value="{Binding SelectedSaleOrder.ReturnModel.ReturnFee, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}" />
                                                <TextBox x:Name="txtReturnTax"
                                                         Grid.Row="2"
                                                         Grid.RowSpan="1"
                                                         Grid.Column="5"
                                                         Margin="0,2"
                                                         HorizontalContentAlignment="Right"
                                                         Padding="2,0,2,0"
                                                         Text="$10.00"
                                                         TextWrapping="NoWrap"
                                                         Visibility="Collapsed" />

                                                <!--  RewardReturnAmount  -->
                                                <TextBlock x:Name="txtblRewardReturn"
                                                           Grid.Row="2"
                                                           Grid.Column="4"
                                                           Margin="8,0,0,0"
                                                           HorizontalAlignment="Left"
                                                           VerticalAlignment="Center"
                                                           Style="{DynamicResource TextBlockNormal}"
                                                           Text="Reward Return amount"
                                                           TextWrapping="NoWrap" />
                                                <cpcTextBox:TextBoxMoney x:Name="txtRewardReturnAmount"
                                                                         Grid.Row="2"
                                                                         Grid.Column="5"
                                                                         Margin="0,2"
                                                                         HorizontalContentAlignment="Right"
                                                                         ConverterCulture="{x:Static local:Define.ConverterCulture}"
                                                                         CurrencyStringFormat="{x:Static local:Define.CurrencyFormat}"
                                                                         IsReadOnly="True"
                                                                         Padding="2,0,2,0"
                                                                         TextWrapping="NoWrap"
                                                                         Value="{Binding SelectedSaleOrder.ReturnModel.Redeemed, Mode=OneWay, UpdateSourceTrigger=PropertyChanged}" />

                                                <!--  Refunded  -->
                                                <TextBlock x:Name="txtblRefund"
                                                           Grid.Row="3"
                                                           Grid.Column="4"
                                                           Margin="8,0,0,0"
                                                           HorizontalAlignment="Left"
                                                           VerticalAlignment="Center"
                                                           Style="{DynamicResource TextBlockNormal}"
                                                           Text="{DynamicResource SO_TextBlock_Refunded}"
                                                           TextWrapping="NoWrap" />
                                                <cpcTextBox:TextBoxMoney x:Name="txtRefunded"
                                                                         Grid.Row="3"
                                                                         Grid.Column="5"
                                                                         Margin="0,2"
                                                                         HorizontalContentAlignment="Right"
                                                                         ConverterCulture="{x:Static local:Define.ConverterCulture}"
                                                                         CurrencyStringFormat="{x:Static local:Define.CurrencyFormat}"
                                                                         IsReadOnly="True"
                                                                         TextWrapping="NoWrap"
                                                                         Value="{Binding SelectedSaleOrder.ReturnModel.TotalRefund, Mode=TwoWay, NotifyOnValidationError=True, UpdateSourceTrigger=PropertyChanged, ValidatesOnDataErrors=True}" />

                                                <!--  Total  -->
                                                <TextBlock x:Name="txtblReturnTotal"
                                                           Grid.Row="4"
                                                           Grid.Column="4"
                                                           Margin="8,0,0,0"
                                                           HorizontalAlignment="Left"
                                                           VerticalAlignment="Center"
                                                           Style="{DynamicResource TextBlockNormal}"
                                                           Text="{DynamicResource C108}"
                                                           TextWrapping="NoWrap" />
                                                <cpcTextBox:TextBoxMoney x:Name="txtReturnTotal"
                                                                         Grid.Row="4"
                                                                         Grid.Column="5"
                                                                         Margin="0,2"
                                                                         HorizontalContentAlignment="Right"
                                                                         ConverterCulture="{x:Static local:Define.ConverterCulture}"
                                                                         CurrencyStringFormat="{x:Static local:Define.CurrencyFormat}"
                                                                         IsReadOnly="True"
                                                                         MaxLength="{StaticResource TotalMaxLength}"
                                                                         Padding="2,0,2,0"
                                                                         Style="{DynamicResource TextBoxTotal}"
                                                                         TextWrapping="NoWrap"
                                                                         Value="{Binding SelectedSaleOrder.ReturnModel.Balance, Mode=OneWay, UpdateSourceTrigger=PropertyChanged}" />
                                                <TextBlock x:Name="txtblReturnFee1"
                                                           Grid.Row="1"
                                                           Grid.Column="2"
                                                           Margin="0,0,10,0"
                                                           HorizontalAlignment="Right"
                                                           VerticalAlignment="Center"
                                                           Style="{DynamicResource TextBlockNormal}"
                                                           Text="{DynamicResource C111}"
                                                           TextWrapping="NoWrap" />
                                                <TextBlock x:Name="txtblReturnFeePercentSymbol"
                                                           Grid.Row="1"
                                                           Grid.Column="3"
                                                           Margin="53,0,0,0"
                                                           HorizontalAlignment="Left"
                                                           VerticalAlignment="Center"
                                                           Style="{DynamicResource TextBlockNormal}"
                                                           Text="%"
                                                           TextWrapping="NoWrap" />

                                                <!--  Total Paid  -->
                                                <TextBlock x:Name="txtblTotalPaid"
                                                           Grid.Row="2"
                                                           Grid.Column="2"
                                                           Margin="0,0,10,0"
                                                           HorizontalAlignment="Right"
                                                           VerticalAlignment="Center"
                                                           FontWeight="Bold"
                                                           Foreground="#FFFCFB88"
                                                           Style="{DynamicResource TextBlockNormal}"
                                                           Text="{DynamicResource SO_TextBlock_TotalPaid}"
                                                           TextWrapping="NoWrap" />
                                                <cpcTextBox:TextBoxMoney x:Name="txtTotalPaid"
                                                                         Grid.Row="2"
                                                                         Grid.RowSpan="1"
                                                                         Grid.Column="3"
                                                                         Width="72"
                                                                         Margin="0,2"
                                                                         HorizontalAlignment="Left"
                                                                         HorizontalContentAlignment="Right"
                                                                         ConverterCulture="{x:Static local:Define.ConverterCulture}"
                                                                         CurrencyStringFormat="{x:Static local:Define.CurrencyFormat}"
                                                                         IsReadOnly="True"
                                                                         Padding="2,0,2,0"
                                                                         TextWrapping="NoWrap"
                                                                         Value="{Binding SelectedSaleOrder.TotalPaid, Mode=OneWay, UpdateSourceTrigger=PropertyChanged}" />
                                            </Grid>
                                        </Grid>
                                    </AdornerDecorator>
                                </cpcOtherControl:CPCTabItemControl>
                            </cpcOtherControl:CPCTabControl>
                        </Grid>
                    </Grid>
                </Grid>
            </Grid>
        </Grid>
    </wpfToolkit:BusyIndicator>
</UserControl>