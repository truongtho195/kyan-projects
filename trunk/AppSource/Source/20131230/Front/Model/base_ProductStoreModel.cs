//------------------------------------------------------------------------------
// <auto-generated>
//     This code was generated from a template.
//
//     Changes to this file may cause incorrect behavior and will be lost if
//     the code is regenerated.
// </auto-generated>
//------------------------------------------------------------------------------

using System;
using System.Collections.Generic;
using System.Collections.ObjectModel;
using System.ComponentModel;
using System.Linq;
using System.Linq.Expressions;
using CPC.Helper;
using CPC.POS.Database;
using CPC.Toolkit.Base;

namespace CPC.POS.Model
{
    /// <summary>
    /// Model for table base_ProductStore
    /// </summary>
    [Serializable]
    public partial class base_ProductStoreModel : ModelBase, IDataErrorInfo
    {
        #region Constructor

        // Default constructor
        public base_ProductStoreModel()
        {
            this.IsNew = true;
            this.base_ProductStore = new base_ProductStore();
        }

        // Default constructor that set entity to field
        public base_ProductStoreModel(base_ProductStore base_productstore, bool isRaiseProperties = false)
        {
            this.base_ProductStore = base_productstore;
            if (!isRaiseProperties)
                this.ToModel();
            else
                this.ToModelAndRaise();
            this.IsDirty = false;
        }

        #endregion

        #region Entity Properties

        public base_ProductStore base_ProductStore { get; private set; }

        #endregion

        #region Primitive Properties

        protected long _id;
        /// <summary>
        /// Property Model
        /// <param>Gets or sets the Id</param>
        /// </summary>
        public long Id
        {
            get { return this._id; }
            set
            {
                if (this._id != value)
                {
                    this.IsDirty = true;
                    this._id = value;
                    OnPropertyChanged(() => Id);
                    PropertyChangedCompleted(() => Id);
                }
            }
        }

        protected long _productId;
        /// <summary>
        /// Property Model
        /// <param>Gets or sets the ProductId</param>
        /// </summary>
        public long ProductId
        {
            get { return this._productId; }
            set
            {
                if (this._productId != value)
                {
                    this.IsDirty = true;
                    this._productId = value;
                    OnPropertyChanged(() => ProductId);
                    PropertyChangedCompleted(() => ProductId);
                }
            }
        }

        protected decimal _quantityOnHand;
        /// <summary>
        /// Property Model
        /// <param>Gets or sets the QuantityOnHand</param>
        /// </summary>
        public decimal QuantityOnHand
        {
            get { return this._quantityOnHand; }
            set
            {
                if (this._quantityOnHand != value)
                {
                    this.IsDirty = true;
                    this._quantityOnHand = value;
                    OnPropertyChanged(() => QuantityOnHand);
                    PropertyChangedCompleted(() => QuantityOnHand);
                }
            }
        }

        protected int _storeCode;
        /// <summary>
        /// Property Model
        /// <param>Gets or sets the StoreCode</param>
        /// </summary>
        public int StoreCode
        {
            get { return this._storeCode; }
            set
            {
                if (this._storeCode != value)
                {
                    this.IsDirty = true;
                    this._storeCode = value;
                    OnPropertyChanged(() => StoreCode);
                    PropertyChangedCompleted(() => StoreCode);
                }
            }
        }

        protected decimal _quantityOnCustomer;
        /// <summary>
        /// Property Model
        /// <param>Gets or sets the QuantityOnCustomer</param>
        /// </summary>
        public decimal QuantityOnCustomer
        {
            get { return this._quantityOnCustomer; }
            set
            {
                if (this._quantityOnCustomer != value)
                {
                    this.IsDirty = true;
                    this._quantityOnCustomer = value;
                    OnPropertyChanged(() => QuantityOnCustomer);
                    PropertyChangedCompleted(() => QuantityOnCustomer);
                }
            }
        }

        protected decimal _quantityOnOrder;
        /// <summary>
        /// Property Model
        /// <param>Gets or sets the QuantityOnOrder</param>
        /// </summary>
        public decimal QuantityOnOrder
        {
            get { return this._quantityOnOrder; }
            set
            {
                if (this._quantityOnOrder != value)
                {
                    this.IsDirty = true;
                    this._quantityOnOrder = value;
                    OnPropertyChanged(() => QuantityOnOrder);
                    PropertyChangedCompleted(() => QuantityOnOrder);
                }
            }
        }

        protected decimal _reorderPoint;
        /// <summary>
        /// Property Model
        /// <param>Gets or sets the ReorderPoint</param>
        /// </summary>
        public decimal ReorderPoint
        {
            get { return this._reorderPoint; }
            set
            {
                if (this._reorderPoint != value)
                {
                    this.IsDirty = true;
                    this._reorderPoint = value;
                    OnPropertyChanged(() => ReorderPoint);
                    PropertyChangedCompleted(() => ReorderPoint);
                }
            }
        }

        protected decimal _quantityAvailable;
        /// <summary>
        /// Property Model
        /// <param>Gets or sets the QuantityAvailable</param>
        /// </summary>
        public decimal QuantityAvailable
        {
            get { return this._quantityAvailable; }
            set
            {
                if (this._quantityAvailable != value)
                {
                    this.IsDirty = true;
                    this._quantityAvailable = value;
                    OnPropertyChanged(() => QuantityAvailable);
                    PropertyChangedCompleted(() => QuantityAvailable);
                }
            }
        }

        protected decimal _soldQuantity;
        /// <summary>
        /// Property Model
        /// <param>Gets or sets the SoldQuantity</param>
        /// </summary>
        public decimal SoldQuantity
        {
            get { return this._soldQuantity; }
            set
            {
                if (this._soldQuantity != value)
                {
                    this.IsDirty = true;
                    this._soldQuantity = value;
                    OnPropertyChanged(() => SoldQuantity);
                    PropertyChangedCompleted(() => SoldQuantity);
                }
            }
        }

        protected decimal _totalSale;
        /// <summary>
        /// Property Model
        /// <param>Gets or sets the TotalSale</param>
        /// </summary>
        public decimal TotalSale
        {
            get { return this._totalSale; }
            set
            {
                if (this._totalSale != value)
                {
                    this.IsDirty = true;
                    this._totalSale = value;
                    OnPropertyChanged(() => TotalSale);
                    PropertyChangedCompleted(() => TotalSale);
                }
            }
        }

        protected decimal _totalCOGS;
        /// <summary>
        /// Property Model
        /// <param>Gets or sets the TotalCOGS</param>
        /// </summary>
        public decimal TotalCOGS
        {
            get { return this._totalCOGS; }
            set
            {
                if (this._totalCOGS != value)
                {
                    this.IsDirty = true;
                    this._totalCOGS = value;
                    OnPropertyChanged(() => TotalCOGS);
                    PropertyChangedCompleted(() => TotalCOGS);
                }
            }
        }

        protected decimal _saleProfit;
        /// <summary>
        /// Property Model
        /// <param>Gets or sets the SaleProfit</param>
        /// </summary>
        public decimal SaleProfit
        {
            get { return this._saleProfit; }
            set
            {
                if (this._saleProfit != value)
                {
                    this.IsDirty = true;
                    this._saleProfit = value;
                    OnPropertyChanged(() => SaleProfit);
                    PropertyChangedCompleted(() => SaleProfit);
                }
            }
        }

        protected decimal _purchasedQuantity;
        /// <summary>
        /// Property Model
        /// <param>Gets or sets the PurchasedQuantity</param>
        /// </summary>
        public decimal PurchasedQuantity
        {
            get { return this._purchasedQuantity; }
            set
            {
                if (this._purchasedQuantity != value)
                {
                    this.IsDirty = true;
                    this._purchasedQuantity = value;
                    OnPropertyChanged(() => PurchasedQuantity);
                    PropertyChangedCompleted(() => PurchasedQuantity);
                }
            }
        }

        protected decimal _purchasedSubTotal;
        /// <summary>
        /// Property Model
        /// <param>Gets or sets the PurchasedSubTotal</param>
        /// </summary>
        public decimal PurchasedSubTotal
        {
            get { return this._purchasedSubTotal; }
            set
            {
                if (this._purchasedSubTotal != value)
                {
                    this.IsDirty = true;
                    this._purchasedSubTotal = value;
                    OnPropertyChanged(() => PurchasedSubTotal);
                    PropertyChangedCompleted(() => PurchasedSubTotal);
                }
            }
        }

        protected decimal _totalProfit;
        /// <summary>
        /// Property Model
        /// <param>Gets or sets the TotalProfit</param>
        /// </summary>
        public decimal TotalProfit
        {
            get { return this._totalProfit; }
            set
            {
                if (this._totalProfit != value)
                {
                    this.IsDirty = true;
                    this._totalProfit = value;
                    OnPropertyChanged(() => TotalProfit);
                    PropertyChangedCompleted(() => TotalProfit);
                }
            }
        }

        protected decimal _sOReturnedQuantity;
        /// <summary>
        /// Property Model
        /// <param>Gets or sets the SOReturnedQuantity</param>
        /// </summary>
        public decimal SOReturnedQuantity
        {
            get { return this._sOReturnedQuantity; }
            set
            {
                if (this._sOReturnedQuantity != value)
                {
                    this.IsDirty = true;
                    this._sOReturnedQuantity = value;
                    OnPropertyChanged(() => SOReturnedQuantity);
                    PropertyChangedCompleted(() => SOReturnedQuantity);
                }
            }
        }

        protected decimal _sOTotalReturned;
        /// <summary>
        /// Property Model
        /// <param>Gets or sets the SOTotalReturned</param>
        /// </summary>
        public decimal SOTotalReturned
        {
            get { return this._sOTotalReturned; }
            set
            {
                if (this._sOTotalReturned != value)
                {
                    this.IsDirty = true;
                    this._sOTotalReturned = value;
                    OnPropertyChanged(() => SOTotalReturned);
                    PropertyChangedCompleted(() => SOTotalReturned);
                }
            }
        }

        protected decimal _pOReturnedQuantity;
        /// <summary>
        /// Property Model
        /// <param>Gets or sets the POReturnedQuantity</param>
        /// </summary>
        public decimal POReturnedQuantity
        {
            get { return this._pOReturnedQuantity; }
            set
            {
                if (this._pOReturnedQuantity != value)
                {
                    this.IsDirty = true;
                    this._pOReturnedQuantity = value;
                    OnPropertyChanged(() => POReturnedQuantity);
                    PropertyChangedCompleted(() => POReturnedQuantity);
                }
            }
        }

        protected decimal _pOTotalReturned;
        /// <summary>
        /// Property Model
        /// <param>Gets or sets the POTotalReturned</param>
        /// </summary>
        public decimal POTotalReturned
        {
            get { return this._pOTotalReturned; }
            set
            {
                if (this._pOTotalReturned != value)
                {
                    this.IsDirty = true;
                    this._pOTotalReturned = value;
                    OnPropertyChanged(() => POTotalReturned);
                    PropertyChangedCompleted(() => POTotalReturned);
                }
            }
        }

        protected string _resource;
        /// <summary>
        /// Property Model
        /// <param>Gets or sets the Resource</param>
        /// </summary>
        public string Resource
        {
            get { return this._resource; }
            set
            {
                if (this._resource != value)
                {
                    this.IsDirty = true;
                    this._resource = value;
                    OnPropertyChanged(() => Resource);
                    PropertyChangedCompleted(() => Resource);
                }
            }
        }

        protected string _productResource;
        /// <summary>
        /// Property Model
        /// <param>Gets or sets the ProductResource</param>
        /// </summary>
        public string ProductResource
        {
            get { return this._productResource; }
            set
            {
                if (this._productResource != value)
                {
                    this.IsDirty = true;
                    this._productResource = value;
                    OnPropertyChanged(() => ProductResource);
                    PropertyChangedCompleted(() => ProductResource);
                }
            }
        }

        #endregion

        #region Public Methods

        /// <summary>
        /// <param>Public Method</param>
        /// Method for set IsNew & IsDirty = false;
        /// </summary>
        public void EndUpdate()
        {
            this.IsNew = false;
            this.IsDirty = false;
        }

        /// <summary>
        /// Public Method
        /// <param>Method for set PropertyModel to Entity</param>
        /// </summary>
        public void ToEntity()
        {
            if (IsNew)
                this.base_ProductStore.Id = this.Id;
            this.base_ProductStore.ProductId = this.ProductId;
            this.base_ProductStore.QuantityOnHand = this.QuantityOnHand;
            this.base_ProductStore.StoreCode = this.StoreCode;
            this.base_ProductStore.QuantityOnCustomer = this.QuantityOnCustomer;
            this.base_ProductStore.QuantityOnOrder = this.QuantityOnOrder;
            this.base_ProductStore.ReorderPoint = this.ReorderPoint;
            this.base_ProductStore.QuantityAvailable = this.QuantityAvailable;
            this.base_ProductStore.SoldQuantity = this.SoldQuantity;
            this.base_ProductStore.TotalSale = this.TotalSale;
            this.base_ProductStore.TotalCOGS = this.TotalCOGS;
            this.base_ProductStore.SaleProfit = this.SaleProfit;
            this.base_ProductStore.PurchasedQuantity = this.PurchasedQuantity;
            this.base_ProductStore.PurchasedSubTotal = this.PurchasedSubTotal;
            this.base_ProductStore.TotalProfit = this.TotalProfit;
            this.base_ProductStore.SOReturnedQuantity = this.SOReturnedQuantity;
            this.base_ProductStore.SOTotalReturned = this.SOTotalReturned;
            this.base_ProductStore.POReturnedQuantity = this.POReturnedQuantity;
            this.base_ProductStore.POTotalReturned = this.POTotalReturned;
            if (this.Resource != null)
                this.base_ProductStore.Resource = this.Resource.Trim();
            if (this.ProductResource != null)
                this.base_ProductStore.ProductResource = this.ProductResource.Trim();
        }

        /// <summary>
        /// Public Method
        /// <param>Method for set Entity to PropertyModel</param>
        /// </summary
        public void ToModel()
        {
            this._id = this.base_ProductStore.Id;
            this._productId = this.base_ProductStore.ProductId;
            this._quantityOnHand = this.base_ProductStore.QuantityOnHand;
            this._storeCode = this.base_ProductStore.StoreCode;
            this._quantityOnCustomer = this.base_ProductStore.QuantityOnCustomer;
            this._quantityOnOrder = this.base_ProductStore.QuantityOnOrder;
            this._reorderPoint = this.base_ProductStore.ReorderPoint;
            this._quantityAvailable = this.base_ProductStore.QuantityAvailable;
            this._soldQuantity = this.base_ProductStore.SoldQuantity;
            this._totalSale = this.base_ProductStore.TotalSale;
            this._totalCOGS = this.base_ProductStore.TotalCOGS;
            this._saleProfit = this.base_ProductStore.SaleProfit;
            this._purchasedQuantity = this.base_ProductStore.PurchasedQuantity;
            this._purchasedSubTotal = this.base_ProductStore.PurchasedSubTotal;
            this._totalProfit = this.base_ProductStore.TotalProfit;
            this._sOReturnedQuantity = this.base_ProductStore.SOReturnedQuantity;
            this._sOTotalReturned = this.base_ProductStore.SOTotalReturned;
            this._pOReturnedQuantity = this.base_ProductStore.POReturnedQuantity;
            this._pOTotalReturned = this.base_ProductStore.POTotalReturned;
            this._resource = this.base_ProductStore.Resource;
            this._productResource = this.base_ProductStore.ProductResource;
        }

        /// <summary>
        /// Public Method
        /// <param>Method for set Entity to PropertyModel</param>
        /// </summary
        public void ToModelAndRaise()
        {
            this.Id = this.base_ProductStore.Id;
            this.ProductId = this.base_ProductStore.ProductId;
            this.QuantityOnHand = this.base_ProductStore.QuantityOnHand;
            this.StoreCode = this.base_ProductStore.StoreCode;
            this.QuantityOnCustomer = this.base_ProductStore.QuantityOnCustomer;
            this.QuantityOnOrder = this.base_ProductStore.QuantityOnOrder;
            this.ReorderPoint = this.base_ProductStore.ReorderPoint;
            this.QuantityAvailable = this.base_ProductStore.QuantityAvailable;
            this.SoldQuantity = this.base_ProductStore.SoldQuantity;
            this.TotalSale = this.base_ProductStore.TotalSale;
            this.TotalCOGS = this.base_ProductStore.TotalCOGS;
            this.SaleProfit = this.base_ProductStore.SaleProfit;
            this.PurchasedQuantity = this.base_ProductStore.PurchasedQuantity;
            this.PurchasedSubTotal = this.base_ProductStore.PurchasedSubTotal;
            this.TotalProfit = this.base_ProductStore.TotalProfit;
            this.SOReturnedQuantity = this.base_ProductStore.SOReturnedQuantity;
            this.SOTotalReturned = this.base_ProductStore.SOTotalReturned;
            this.POReturnedQuantity = this.base_ProductStore.POReturnedQuantity;
            this.POTotalReturned = this.base_ProductStore.POTotalReturned;
            this.Resource = this.base_ProductStore.Resource;
            this.ProductResource = this.base_ProductStore.ProductResource;
        }

        #endregion

        #region Custom Code

        #region Properties

        private ObservableCollection<base_ProductUOMModel> _productUOMCollection;
        /// <summary>
        /// Gets or sets the ProductUOMCollection.
        /// </summary>
        public ObservableCollection<base_ProductUOMModel> ProductUOMCollection
        {
            get { return _productUOMCollection; }
            set
            {
                if (_productUOMCollection != value)
                {
                    _productUOMCollection = value;
                    OnPropertyChanged(() => ProductUOMCollection);
                }
            }
        }

        /// <summary>
        /// Gets or sets the OldQuantity
        /// </summary>
        public decimal OldQuantity { get; set; }

        /// <summary>
        /// Gets the StorePosition.
        /// </summary>
        public string StorePosition
        {
            get { return (StoreCode + 1).ToString(); }
        }

        private decimal _quantity;
        /// <summary>
        /// Gets or sets the Quantity.
        /// </summary>
        public decimal Quantity
        {
            get { return _quantity; }
            set
            {
                if (_quantity != value)
                {
                    _quantity = value;
                    OnPropertyChanged(() => Quantity);
                }
            }
        }

        #region ProductModel

        private base_ProductModel _productModel;
        public base_ProductModel ProductModel
        {
            get
            {
                return _productModel;
            }
            set
            {
                if (_productModel != value)
                {
                    _productModel = value;
                    OnPropertyChanged(() => ProductModel);
                }
            }
        }

        #endregion

        #region ProductName

        public string ProductName
        {
            get
            {
                if (_productModel != null)
                {
                    return _productModel.ProductName;
                }
                return null;
            }
        }

        #endregion

        #endregion

        #region Public Methods

        /// <summary>
        /// Copy product store from parameter
        /// </summary>
        /// <param name="productStoreModel">Source product store</param>
        public void ToModel(base_ProductStoreModel productStoreModel)
        {
            //this._id = productStoreModel.Id;
            //this._productId = productStoreModel.ProductId;
            this._quantityOnHand = productStoreModel.QuantityOnHand;
            this._storeCode = productStoreModel.StoreCode;
            this._quantityOnCustomer = productStoreModel.QuantityOnCustomer;
            this._quantityOnOrder = productStoreModel.QuantityOnOrder;
            this._reorderPoint = productStoreModel.ReorderPoint;
            this._quantityAvailable = productStoreModel.QuantityAvailable;
            this._soldQuantity = productStoreModel.SoldQuantity;
            this._totalSale = productStoreModel.TotalSale;
            this._totalCOGS = productStoreModel.TotalCOGS;
            this._saleProfit = productStoreModel.SaleProfit;
            this._purchasedQuantity = productStoreModel.PurchasedQuantity;
            this._purchasedSubTotal = productStoreModel.PurchasedSubTotal;
            this._totalProfit = productStoreModel.TotalProfit;
            this._sOReturnedQuantity = productStoreModel.SOReturnedQuantity;
            this._sOTotalReturned = productStoreModel.SOTotalReturned;
            this._pOReturnedQuantity = productStoreModel.POReturnedQuantity;
            this._pOTotalReturned = productStoreModel.POTotalReturned;
        }

        /// <summary>
        /// Update available quantity by store code
        /// </summary>
        public void UpdateAvailableQuantity()
        {
            this.QuantityAvailable = this.QuantityOnHand - this.QuantityOnCustomer;
        }

        #endregion

        #endregion

        #region IDataErrorInfo Members

        public string Error
        {
            get { throw new NotImplementedException(); }
        }

        public string this[string columnName]
        {
            get
            {
                string message = string.Empty;

                switch (columnName)
                {
                    case "Id":
                        break;
                    case "ProductId":
                        break;
                    case "StoreCode":
                        break;
                    case "QuantityOnHand":
                        break;
                }

                if (!string.IsNullOrWhiteSpace(message))
                    return message;
                return null;
            }
        }

        #endregion
    }
}
