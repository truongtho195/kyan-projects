//------------------------------------------------------------------------------
// <auto-generated>
//     This code was generated from a template.
//
//     Changes to this file may cause incorrect behavior and will be lost if
//     the code is regenerated.
// </auto-generated>
//------------------------------------------------------------------------------

using System;
using System.Collections.Generic;
using System.Collections.ObjectModel;
using System.ComponentModel;
using CPC.POS.Database;
using CPC.Toolkit.Base;

namespace CPC.POS.Model
{
    /// <summary>
    /// Model for table base_ProductStore
    /// </summary>
    [Serializable]
    public partial class base_ProductStoreModel : ModelBase, IDataErrorInfo
    {
        #region Constructor

        // Default constructor
        public base_ProductStoreModel()
        {
            this.IsNew = true;
            this.base_ProductStore = new base_ProductStore();
        }

        // Default constructor that set entity to field
        public base_ProductStoreModel(base_ProductStore base_productstore, bool isRaiseProperties = false)
        {
            this.base_ProductStore = base_productstore;
            if (!isRaiseProperties)
                this.ToModel();
            else
                this.ToModelAndRaise();
            this.IsDirty = false;
        }

        #endregion

        #region Entity Properties

        public base_ProductStore base_ProductStore { get; private set; }

        #endregion

        #region Primitive Properties

        protected long _id;
        /// <summary>
        /// Property Model
        /// <para>Gets or sets the Id</para>
        /// </summary>
        public long Id
        {
            get { return this._id; }
            set
            {
                if (this._id != value)
                {
                    this.IsDirty = true;
                    this._id = value;
                    OnPropertyChanged(() => Id);
                    PropertyChangedCompleted(() => Id);
                }
            }
        }

        protected long _productId;
        /// <summary>
        /// Property Model
        /// <para>Gets or sets the ProductId</para>
        /// </summary>
        public long ProductId
        {
            get { return this._productId; }
            set
            {
                if (this._productId != value)
                {
                    this.IsDirty = true;
                    this._productId = value;
                    OnPropertyChanged(() => ProductId);
                    PropertyChangedCompleted(() => ProductId);
                }
            }
        }

        protected int _quantityOnHand;
        /// <summary>
        /// Property Model
        /// <para>Gets or sets the QuantityOnHand</para>
        /// </summary>
        public int QuantityOnHand
        {
            get { return this._quantityOnHand; }
            set
            {
                if (this._quantityOnHand != value)
                {
                    this.IsDirty = true;
                    this._quantityOnHand = value;
                    OnPropertyChanged(() => QuantityOnHand);
                    PropertyChangedCompleted(() => QuantityOnHand);
                }
            }
        }

        protected int _storeCode;
        /// <summary>
        /// Property Model
        /// <para>Gets or sets the StoreCode</para>
        /// </summary>
        public int StoreCode
        {
            get { return this._storeCode; }
            set
            {
                if (this._storeCode != value)
                {
                    this.IsDirty = true;
                    this._storeCode = value;
                    OnPropertyChanged(() => StoreCode);
                    PropertyChangedCompleted(() => StoreCode);
                }
            }
        }

        protected int _quantityOnCustomer;
        /// <summary>
        /// Property Model
        /// <para>Gets or sets the QuantityOnCustomer</para>
        /// </summary>
        public int QuantityOnCustomer
        {
            get { return this._quantityOnCustomer; }
            set
            {
                if (this._quantityOnCustomer != value)
                {
                    this.IsDirty = true;
                    this._quantityOnCustomer = value;
                    OnPropertyChanged(() => QuantityOnCustomer);
                    PropertyChangedCompleted(() => QuantityOnCustomer);
                }
            }
        }

        protected int _quantityOnOrder;
        /// <summary>
        /// Property Model
        /// <para>Gets or sets the QuantityOnOrder</para>
        /// </summary>
        public int QuantityOnOrder
        {
            get { return this._quantityOnOrder; }
            set
            {
                if (this._quantityOnOrder != value)
                {
                    this.IsDirty = true;
                    this._quantityOnOrder = value;
                    OnPropertyChanged(() => QuantityOnOrder);
                    PropertyChangedCompleted(() => QuantityOnOrder);
                }
            }
        }

        protected int _reorderPoint;
        /// <summary>
        /// Property Model
        /// <para>Gets or sets the ReorderPoint</para>
        /// </summary>
        public int ReorderPoint
        {
            get { return this._reorderPoint; }
            set
            {
                if (this._reorderPoint != value)
                {
                    this.IsDirty = true;
                    this._reorderPoint = value;
                    OnPropertyChanged(() => ReorderPoint);
                    PropertyChangedCompleted(() => ReorderPoint);
                }
            }
        }

        protected int _quantityAvailable;
        /// <summary>
        /// Property Model
        /// <para>Gets or sets the QuantityAvailable</para>
        /// </summary>
        public int QuantityAvailable
        {
            get { return this._quantityAvailable; }
            set
            {
                if (this._quantityAvailable != value)
                {
                    this.IsDirty = true;
                    this._quantityAvailable = value;
                    OnPropertyChanged(() => QuantityAvailable);
                    PropertyChangedCompleted(() => QuantityAvailable);
                }
            }
        }

        #endregion

        #region Public Methods

        /// <summary>
        /// <para>Public Method</para>
        /// Method for set IsNew & IsDirty = false;
        /// </summary>
        public void EndUpdate()
        {
            this.IsNew = false;
            this.IsDirty = false;
        }

        /// <summary>
        /// Public Method
        /// <para>Method for set PropertyModel to Entity</para>
        /// </summary>
        public void ToEntity()
        {
            if (IsNew)
                this.base_ProductStore.Id = this.Id;
            this.base_ProductStore.ProductId = this.ProductId;
            this.base_ProductStore.QuantityOnHand = this.QuantityOnHand;
            this.base_ProductStore.StoreCode = this.StoreCode;
            this.base_ProductStore.QuantityOnCustomer = this.QuantityOnCustomer;
            this.base_ProductStore.QuantityOnOrder = this.QuantityOnOrder;
            this.base_ProductStore.ReorderPoint = this.ReorderPoint;
            this.base_ProductStore.QuantityAvailable = this.QuantityAvailable;
        }

        /// <summary>
        /// Public Method
        /// <para>Method for set Entity to PropertyModel</para>
        /// </summary
        public void ToModel()
        {
            this._id = this.base_ProductStore.Id;
            this._productId = this.base_ProductStore.ProductId;
            this._quantityOnHand = this.base_ProductStore.QuantityOnHand;
            this._storeCode = this.base_ProductStore.StoreCode;
            this._quantityOnCustomer = this.base_ProductStore.QuantityOnCustomer;
            this._quantityOnOrder = this.base_ProductStore.QuantityOnOrder;
            this._reorderPoint = this.base_ProductStore.ReorderPoint;
            this._quantityAvailable = this.base_ProductStore.QuantityAvailable;
        }

        /// <summary>
        /// Public Method
        /// <para>Method for set Entity to PropertyModel</para>
        /// </summary
        public void ToModelAndRaise()
        {
            this.Id = this.base_ProductStore.Id;
            this.ProductId = this.base_ProductStore.ProductId;
            this.QuantityOnHand = this.base_ProductStore.QuantityOnHand;
            this.StoreCode = this.base_ProductStore.StoreCode;
            this.QuantityOnCustomer = this.base_ProductStore.QuantityOnCustomer;
            this.QuantityOnOrder = this.base_ProductStore.QuantityOnOrder;
            this.ReorderPoint = this.base_ProductStore.ReorderPoint;
            this.QuantityAvailable = this.base_ProductStore.QuantityAvailable;
        }

        #endregion

        #region Custom Code

        #region Properties

        private CollectionBase<base_ProductUOMModel> _productUOMCollection;
        /// <summary>
        /// Gets or sets the ProductUOMCollection.
        /// </summary>
        public CollectionBase<base_ProductUOMModel> ProductUOMCollection
        {
            get { return _productUOMCollection; }
            set
            {
                if (_productUOMCollection != value)
                {
                    _productUOMCollection = value;
                    OnPropertyChanged(() => ProductUOMCollection);
                }
            }
        }

        /// <summary>
        /// Gets or sets the OldQuantity
        /// </summary>
        public int OldQuantity { get; set; }

        /// <summary>
        /// Gets the StorePosition.
        /// </summary>
        public string StorePosition
        {
            get { return (StoreCode + 1).ToString(); }
        }

        private int _quantity;
        /// <summary>
        /// Gets or sets the Quantity.
        /// </summary>
        public int Quantity
        {
            get { return _quantity; }
            set
            {
                if (_quantity != value)
                {
                    _quantity = value;
                    OnPropertyChanged(() => Quantity);
                }
            }
        }

        #endregion

        #region Public Methods

        /// <summary>
        /// 
        /// </summary>
        public void ToModel(base_ProductStoreModel productStoreModel)
        {
            //this._id = productStoreModel.Id;
            //this._productId = productStoreModel.ProductId;
            this._quantityOnHand = productStoreModel.QuantityOnHand;
            this._storeCode = productStoreModel.StoreCode;
            this._quantityOnCustomer = productStoreModel.QuantityOnCustomer;
            this._quantityOnOrder = productStoreModel.QuantityOnOrder;
        }

        /// <summary>
        /// Update available quantity by store code
        /// </summary>
        public void UpdateAvailableQuantity()
        {
            this.QuantityAvailable = this.QuantityOnHand - this.QuantityOnCustomer;
        }

        #endregion

        #endregion

        #region IDataErrorInfo Members

        public string Error
        {
            get { throw new NotImplementedException(); }
        }

        public string this[string columnName]
        {
            get
            {
                string message = string.Empty;

                switch (columnName)
                {
                    case "Id":
                        break;
                    case "ProductId":
                        break;
                    case "StoreCode":
                        break;
                    case "QuantityOnHand":
                        break;
                }

                if (!string.IsNullOrWhiteSpace(message))
                    return message;
                return null;
            }
        }

        #endregion
    }
}
