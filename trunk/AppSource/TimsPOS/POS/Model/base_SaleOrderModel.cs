//------------------------------------------------------------------------------
// <auto-generated>
//     This code was generated from a template.
//
//     Changes to this file may cause incorrect behavior and will be lost if
//     the code is regenerated.
// </auto-generated>
//------------------------------------------------------------------------------

using System;
using System.Collections.Generic;
using System.Collections.ObjectModel;
using System.ComponentModel;
using CPC.POS.Database;
using CPC.Toolkit.Base;
using System.Linq;
using System.Linq.Expressions;

namespace CPC.POS.Model
{
    /// <summary>
    /// Model for table base_SaleOrder
    /// </summary>
    [Serializable]
    public partial class base_SaleOrderModel : ModelBase, IDataErrorInfo
    {
        #region Constructor

        // Default constructor
        public base_SaleOrderModel()
        {
            this.IsNew = true;
            this.base_SaleOrder = new base_SaleOrder();
        }

        // Default constructor that set entity to field
        public base_SaleOrderModel(base_SaleOrder base_saleorder, bool isRaiseProperties = false)
        {
            this.base_SaleOrder = base_saleorder;
            if (!isRaiseProperties)
                this.ToModel();
            else
                this.ToModelAndRaise();
            this.IsDirty = false;
        }

        #endregion

        #region Entity Properties

        public base_SaleOrder base_SaleOrder { get; private set; }

        #endregion

        #region Primitive Properties

        protected long _id;
        /// <summary>
        /// Property Model
        /// <para>Gets or sets the Id</para>
        /// </summary>
        public long Id
        {
            get { return this._id; }
            set
            {
                if (this._id != value)
                {
                    this.IsDirty = true;
                    this._id = value;
                    OnPropertyChanged(() => Id);
                    PropertyChangedCompleted(() => Id);
                }
            }
        }

        protected string _sONumber;
        /// <summary>
        /// Property Model
        /// <para>Gets or sets the SONumber</para>
        /// </summary>
        public string SONumber
        {
            get { return this._sONumber; }
            set
            {
                if (this._sONumber != value)
                {
                    this.IsDirty = true;
                    this._sONumber = value;
                    OnPropertyChanged(() => SONumber);
                    PropertyChangedCompleted(() => SONumber);
                }
            }
        }

        protected Nullable<System.DateTime> _orderDate;
        /// <summary>
        /// Property Model
        /// <para>Gets or sets the OrderDate</para>
        /// </summary>
        public Nullable<System.DateTime> OrderDate
        {
            get { return this._orderDate; }
            set
            {
                if (this._orderDate != value)
                {
                    this.IsDirty = true;
                    this._orderDate = value;
                    OnPropertyChanged(() => OrderDate);
                    PropertyChangedCompleted(() => OrderDate);
                }
            }
        }

        protected short _orderStatus;
        /// <summary>
        /// Property Model
        /// <para>Gets or sets the OrderStatus</para>
        /// </summary>
        public short OrderStatus
        {
            get { return this._orderStatus; }
            set
            {
                if (this._orderStatus != value)
                {
                    this.IsDirty = true;
                    this._orderStatus = value;
                    OnPropertyChanged(() => OrderStatus);
                    PropertyChangedCompleted(() => OrderStatus);
                }
            }
        }

        protected Nullable<long> _billAddressId;
        /// <summary>
        /// Property Model
        /// <para>Gets or sets the BillAddressId</para>
        /// </summary>
        public Nullable<long> BillAddressId
        {
            get { return this._billAddressId; }
            set
            {
                if (this._billAddressId != value)
                {
                    this.IsDirty = true;
                    this._billAddressId = value;
                    OnPropertyChanged(() => BillAddressId);
                    PropertyChangedCompleted(() => BillAddressId);
                }
            }
        }

        protected string _billAddress;
        /// <summary>
        /// Property Model
        /// <para>Gets or sets the BillAddress</para>
        /// </summary>
        public string BillAddress
        {
            get { return this._billAddress; }
            set
            {
                if (this._billAddress != value)
                {
                    this.IsDirty = true;
                    this._billAddress = value;
                    OnPropertyChanged(() => BillAddress);
                    PropertyChangedCompleted(() => BillAddress);
                }
            }
        }

        protected Nullable<long> _shipAddressId;
        /// <summary>
        /// Property Model
        /// <para>Gets or sets the ShipAddressId</para>
        /// </summary>
        public Nullable<long> ShipAddressId
        {
            get { return this._shipAddressId; }
            set
            {
                if (this._shipAddressId != value)
                {
                    this.IsDirty = true;
                    this._shipAddressId = value;
                    OnPropertyChanged(() => ShipAddressId);
                    PropertyChangedCompleted(() => ShipAddressId);
                }
            }
        }

        protected string _shipAddress;
        /// <summary>
        /// Property Model
        /// <para>Gets or sets the ShipAddress</para>
        /// </summary>
        public string ShipAddress
        {
            get { return this._shipAddress; }
            set
            {
                if (this._shipAddress != value)
                {
                    this.IsDirty = true;
                    this._shipAddress = value;
                    OnPropertyChanged(() => ShipAddress);
                    PropertyChangedCompleted(() => ShipAddress);
                }
            }
        }

        protected string _promotionCode;
        /// <summary>
        /// Property Model
        /// <para>Gets or sets the PromotionCode</para>
        /// </summary>
        public string PromotionCode
        {
            get { return this._promotionCode; }
            set
            {
                if (this._promotionCode != value)
                {
                    this.IsDirty = true;
                    this._promotionCode = value;
                    OnPropertyChanged(() => PromotionCode);
                    PropertyChangedCompleted(() => PromotionCode);
                }
            }
        }

        protected string _saleRep;
        /// <summary>
        /// Property Model
        /// <para>Gets or sets the SaleRep</para>
        /// </summary>
        public string SaleRep
        {
            get { return this._saleRep; }
            set
            {
                if (this._saleRep != value)
                {
                    this.IsDirty = true;
                    this._saleRep = value;
                    OnPropertyChanged(() => SaleRep);
                    PropertyChangedCompleted(() => SaleRep);
                }
            }
        }

        protected string _customerResource;
        /// <summary>
        /// Property Model
        /// <para>Gets or sets the CustomerResource</para>
        /// </summary>
        public string CustomerResource
        {
            get { return this._customerResource; }
            set
            {
                if (this._customerResource != value)
                {
                    this.IsDirty = true;
                    this._customerResource = value;
                    OnPropertyChanged(() => CustomerResource);
                    PropertyChangedCompleted(() => CustomerResource);
                }
            }
        }

        protected short _priceSchemaId;
        /// <summary>
        /// Property Model
        /// <para>Gets or sets the PriceSchemaId</para>
        /// </summary>
        public short PriceSchemaId
        {
            get { return this._priceSchemaId; }
            set
            {
                if (this._priceSchemaId != value)
                {
                    this.IsDirty = true;
                    this._priceSchemaId = value;
                    OnPropertyChanged(() => PriceSchemaId);
                    PropertyChangedCompleted(() => PriceSchemaId);
                }
            }
        }

        protected Nullable<System.DateTime> _dueDate;
        /// <summary>
        /// Property Model
        /// <para>Gets or sets the DueDate</para>
        /// </summary>
        public Nullable<System.DateTime> DueDate
        {
            get { return this._dueDate; }
            set
            {
                if (this._dueDate != value)
                {
                    this.IsDirty = true;
                    this._dueDate = value;
                    OnPropertyChanged(() => DueDate);
                    PropertyChangedCompleted(() => DueDate);
                }
            }
        }

        protected System.DateTime _requestShipDate;
        /// <summary>
        /// Property Model
        /// <para>Gets or sets the RequestShipDate</para>
        /// </summary>
        public System.DateTime RequestShipDate
        {
            get { return this._requestShipDate; }
            set
            {
                if (this._requestShipDate != value)
                {
                    this.IsDirty = true;
                    this._requestShipDate = value;
                    OnPropertyChanged(() => RequestShipDate);
                    PropertyChangedCompleted(() => RequestShipDate);
                }
            }
        }

        protected decimal _subTotal;
        /// <summary>
        /// Property Model
        /// <para>Gets or sets the SubTotal</para>
        /// </summary>
        public decimal SubTotal
        {
            get { return this._subTotal; }
            set
            {
                if (this._subTotal != value)
                {
                    this.IsDirty = true;
                    this._subTotal = value;
                    OnPropertyChanged(() => SubTotal);
                    PropertyChangedCompleted(() => SubTotal);
                }
            }
        }

        protected int _taxLocation;
        /// <summary>
        /// Property Model
        /// <para>Gets or sets the TaxLocation</para>
        /// </summary>
        public int TaxLocation
        {
            get { return this._taxLocation; }
            set
            {
                if (this._taxLocation != value)
                {
                    this.IsDirty = true;
                    this._taxLocation = value;
                    OnPropertyChanged(() => TaxLocation);
                    PropertyChangedCompleted(() => TaxLocation);
                }
            }
        }

        protected string _taxCode;
        /// <summary>
        /// Property Model
        /// <para>Gets or sets the TaxCode</para>
        /// </summary>
        public string TaxCode
        {
            get { return this._taxCode; }
            set
            {
                if (this._taxCode != value)
                {
                    this.IsDirty = true;
                    this._taxCode = value;
                    OnPropertyChanged(() => TaxCode);
                    PropertyChangedCompleted(() => TaxCode);
                }
            }
        }

        protected decimal _discountAmount;
        /// <summary>
        /// Property Model
        /// <para>Gets or sets the DiscountAmount</para>
        /// </summary>
        public decimal DiscountAmount
        {
            get { return this._discountAmount; }
            set
            {
                if (this._discountAmount != value)
                {
                    this.IsDirty = true;
                    this._discountAmount = value;
                    OnPropertyChanged(() => DiscountAmount);
                    PropertyChangedCompleted(() => DiscountAmount);
                }
            }
        }

        protected decimal _taxAmount;
        /// <summary>
        /// Property Model
        /// <para>Gets or sets the TaxAmount</para>
        /// </summary>
        public decimal TaxAmount
        {
            get { return this._taxAmount; }
            set
            {
                if (this._taxAmount != value)
                {
                    this.IsDirty = true;
                    this._taxAmount = value;
                    OnPropertyChanged(() => TaxAmount);
                    PropertyChangedCompleted(() => TaxAmount);
                }
            }
        }

        protected decimal _discountPercent;
        /// <summary>
        /// Property Model
        /// <para>Gets or sets the DiscountPercent</para>
        /// </summary>
        public decimal DiscountPercent
        {
            get { return this._discountPercent; }
            set
            {
                if (this._discountPercent != value)
                {
                    this.IsDirty = true;
                    this._discountPercent = value;
                    OnPropertyChanged(() => DiscountPercent);
                    PropertyChangedCompleted(() => DiscountPercent);
                }
            }
        }

        protected decimal _taxPercent;
        /// <summary>
        /// Property Model
        /// <para>Gets or sets the TaxPercent</para>
        /// </summary>
        public decimal TaxPercent
        {
            get { return this._taxPercent; }
            set
            {
                if (this._taxPercent != value)
                {
                    this.IsDirty = true;
                    this._taxPercent = value;
                    OnPropertyChanged(() => TaxPercent);
                    PropertyChangedCompleted(() => TaxPercent);
                }
            }
        }

        protected decimal _shipping;
        /// <summary>
        /// Property Model
        /// <para>Gets or sets the Shipping</para>
        /// </summary>
        public decimal Shipping
        {
            get { return this._shipping; }
            set
            {
                if (this._shipping != value)
                {
                    this.IsDirty = true;
                    this._shipping = value;
                    OnPropertyChanged(() => Shipping);
                    PropertyChangedCompleted(() => Shipping);
                }
            }
        }

        protected decimal _total;
        /// <summary>
        /// Property Model
        /// <para>Gets or sets the Total</para>
        /// </summary>
        public decimal Total
        {
            get { return this._total; }
            set
            {
                if (this._total != value)
                {
                    this.IsDirty = true;
                    this._total = value;
                    OnPropertyChanged(() => Total);
                    PropertyChangedCompleted(() => Total);
                }
            }
        }

        protected decimal _paid;
        /// <summary>
        /// Property Model
        /// <para>Gets or sets the Paid</para>
        /// </summary>
        public decimal Paid
        {
            get { return this._paid; }
            set
            {
                if (this._paid != value)
                {
                    this.IsDirty = true;
                    this._paid = value;
                    OnPropertyChanged(() => Paid);
                    PropertyChangedCompleted(() => Paid);
                }
            }
        }

        protected decimal _balance;
        /// <summary>
        /// Property Model
        /// <para>Gets or sets the Balance</para>
        /// </summary>
        public decimal Balance
        {
            get { return this._balance; }
            set
            {
                if (this._balance != value)
                {
                    this.IsDirty = true;
                    this._balance = value;
                    OnPropertyChanged(() => Balance);
                    PropertyChangedCompleted(() => Balance);
                }
            }
        }

        protected decimal _refundedAmount;
        /// <summary>
        /// Property Model
        /// <para>Gets or sets the RefundedAmount</para>
        /// </summary>
        public decimal RefundedAmount
        {
            get { return this._refundedAmount; }
            set
            {
                if (this._refundedAmount != value)
                {
                    this.IsDirty = true;
                    this._refundedAmount = value;
                    OnPropertyChanged(() => RefundedAmount);
                    PropertyChangedCompleted(() => RefundedAmount);
                }
            }
        }

        protected bool _isMultiPayment;
        /// <summary>
        /// Property Model
        /// <para>Gets or sets the IsMultiPayment</para>
        /// </summary>
        public bool IsMultiPayment
        {
            get { return this._isMultiPayment; }
            set
            {
                if (this._isMultiPayment != value)
                {
                    this.IsDirty = true;
                    this._isMultiPayment = value;
                    OnPropertyChanged(() => IsMultiPayment);
                    PropertyChangedCompleted(() => IsMultiPayment);
                }
            }
        }

        protected string _remark;
        /// <summary>
        /// Property Model
        /// <para>Gets or sets the Remark</para>
        /// </summary>
        public string Remark
        {
            get { return this._remark; }
            set
            {
                if (this._remark != value)
                {
                    this.IsDirty = true;
                    this._remark = value;
                    OnPropertyChanged(() => Remark);
                    PropertyChangedCompleted(() => Remark);
                }
            }
        }

        protected bool _isFullWorkflow;
        /// <summary>
        /// Property Model
        /// <para>Gets or sets the IsFullWorkflow</para>
        /// </summary>
        public bool IsFullWorkflow
        {
            get { return this._isFullWorkflow; }
            set
            {
                if (this._isFullWorkflow != value)
                {
                    this.IsDirty = true;
                    this._isFullWorkflow = value;
                    OnPropertyChanged(() => IsFullWorkflow);
                    PropertyChangedCompleted(() => IsFullWorkflow);
                }
            }
        }

        protected int _qtyOrdered;
        /// <summary>
        /// Property Model
        /// <para>Gets or sets the QtyOrdered</para>
        /// </summary>
        public int QtyOrdered
        {
            get { return this._qtyOrdered; }
            set
            {
                if (this._qtyOrdered != value)
                {
                    this.IsDirty = true;
                    this._qtyOrdered = value;
                    OnPropertyChanged(() => QtyOrdered);
                    PropertyChangedCompleted(() => QtyOrdered);
                }
            }
        }

        protected int _qtyDue;
        /// <summary>
        /// Property Model
        /// <para>Gets or sets the QtyDue</para>
        /// </summary>
        public int QtyDue
        {
            get { return this._qtyDue; }
            set
            {
                if (this._qtyDue != value)
                {
                    this.IsDirty = true;
                    this._qtyDue = value;
                    OnPropertyChanged(() => QtyDue);
                    PropertyChangedCompleted(() => QtyDue);
                }
            }
        }

        protected int _qtyReceived;
        /// <summary>
        /// Property Model
        /// <para>Gets or sets the QtyReceived</para>
        /// </summary>
        public int QtyReceived
        {
            get { return this._qtyReceived; }
            set
            {
                if (this._qtyReceived != value)
                {
                    this.IsDirty = true;
                    this._qtyReceived = value;
                    OnPropertyChanged(() => QtyReceived);
                    PropertyChangedCompleted(() => QtyReceived);
                }
            }
        }

        protected decimal _unFilled;
        /// <summary>
        /// Property Model
        /// <para>Gets or sets the UnFilled</para>
        /// </summary>
        public decimal UnFilled
        {
            get { return this._unFilled; }
            set
            {
                if (this._unFilled != value)
                {
                    this.IsDirty = true;
                    this._unFilled = value;
                    OnPropertyChanged(() => UnFilled);
                    PropertyChangedCompleted(() => UnFilled);
                }
            }
        }

        protected string _userCreated;
        /// <summary>
        /// Property Model
        /// <para>Gets or sets the UserCreated</para>
        /// </summary>
        public string UserCreated
        {
            get { return this._userCreated; }
            set
            {
                if (this._userCreated != value)
                {
                    this.IsDirty = true;
                    this._userCreated = value;
                    OnPropertyChanged(() => UserCreated);
                    PropertyChangedCompleted(() => UserCreated);
                }
            }
        }

        protected System.DateTime _dateCreated;
        /// <summary>
        /// Property Model
        /// <para>Gets or sets the DateCreated</para>
        /// </summary>
        public System.DateTime DateCreated
        {
            get { return this._dateCreated; }
            set
            {
                if (this._dateCreated != value)
                {
                    this.IsDirty = true;
                    this._dateCreated = value;
                    OnPropertyChanged(() => DateCreated);
                    PropertyChangedCompleted(() => DateCreated);
                }
            }
        }

        protected string _userUpdated;
        /// <summary>
        /// Property Model
        /// <para>Gets or sets the UserUpdated</para>
        /// </summary>
        public string UserUpdated
        {
            get { return this._userUpdated; }
            set
            {
                if (this._userUpdated != value)
                {
                    this.IsDirty = true;
                    this._userUpdated = value;
                    OnPropertyChanged(() => UserUpdated);
                    PropertyChangedCompleted(() => UserUpdated);
                }
            }
        }

        protected System.DateTime _dateUpdated;
        /// <summary>
        /// Property Model
        /// <para>Gets or sets the DateUpdated</para>
        /// </summary>
        public System.DateTime DateUpdated
        {
            get { return this._dateUpdated; }
            set
            {
                if (this._dateUpdated != value)
                {
                    this.IsDirty = true;
                    this._dateUpdated = value;
                    OnPropertyChanged(() => DateUpdated);
                    PropertyChangedCompleted(() => DateUpdated);
                }
            }
        }

        protected System.Guid _resource;
        /// <summary>
        /// Property Model
        /// <para>Gets or sets the Resource</para>
        /// </summary>
        public System.Guid Resource
        {
            get { return this._resource; }
            set
            {
                if (this._resource != value)
                {
                    this.IsDirty = true;
                    this._resource = value;
                    OnPropertyChanged(() => Resource);
                    PropertyChangedCompleted(() => Resource);
                }
            }
        }

        protected short _bookingChanel;
        /// <summary>
        /// Property Model
        /// <para>Gets or sets the BookingChanel</para>
        /// </summary>
        public short BookingChanel
        {
            get { return this._bookingChanel; }
            set
            {
                if (this._bookingChanel != value)
                {
                    this.IsDirty = true;
                    this._bookingChanel = value;
                    OnPropertyChanged(() => BookingChanel);
                    PropertyChangedCompleted(() => BookingChanel);
                }
            }
        }

        protected short _shippedCount;
        /// <summary>
        /// Property Model
        /// <para>Gets or sets the ShippedCount</para>
        /// </summary>
        public short ShippedCount
        {
            get { return this._shippedCount; }
            set
            {
                if (this._shippedCount != value)
                {
                    this.IsDirty = true;
                    this._shippedCount = value;
                    OnPropertyChanged(() => ShippedCount);
                    PropertyChangedCompleted(() => ShippedCount);
                }
            }
        }

        protected Nullable<decimal> _deposit;
        /// <summary>
        /// Property Model
        /// <para>Gets or sets the Deposit</para>
        /// </summary>
        public Nullable<decimal> Deposit
        {
            get { return this._deposit; }
            set
            {
                if (this._deposit != value)
                {
                    this.IsDirty = true;
                    this._deposit = value;
                    OnPropertyChanged(() => Deposit);
                    PropertyChangedCompleted(() => Deposit);
                }
            }
        }

        protected string _transaction;
        /// <summary>
        /// Property Model
        /// <para>Gets or sets the Transaction</para>
        /// </summary>
        public string Transaction
        {
            get { return this._transaction; }
            set
            {
                if (this._transaction != value)
                {
                    this.IsDirty = true;
                    this._transaction = value;
                    OnPropertyChanged(() => Transaction);
                    PropertyChangedCompleted(() => Transaction);
                }
            }
        }

        protected decimal _termDiscountPercent;
        /// <summary>
        /// Property Model
        /// <para>Gets or sets the TermDiscountPercent</para>
        /// </summary>
        public decimal TermDiscountPercent
        {
            get { return this._termDiscountPercent; }
            set
            {
                if (this._termDiscountPercent != value)
                {
                    this.IsDirty = true;
                    this._termDiscountPercent = value;
                    OnPropertyChanged(() => TermDiscountPercent);
                    PropertyChangedCompleted(() => TermDiscountPercent);
                }
            }
        }

        protected short _termNetDue;
        /// <summary>
        /// Property Model
        /// <para>Gets or sets the TermNetDue</para>
        /// </summary>
        public short TermNetDue
        {
            get { return this._termNetDue; }
            set
            {
                if (this._termNetDue != value)
                {
                    this.IsDirty = true;
                    this._termNetDue = value;
                    OnPropertyChanged(() => TermNetDue);
                    PropertyChangedCompleted(() => TermNetDue);
                }
            }
        }

        protected short _termPaidWithinDay;
        /// <summary>
        /// Property Model
        /// <para>Gets or sets the TermPaidWithinDay</para>
        /// </summary>
        public short TermPaidWithinDay
        {
            get { return this._termPaidWithinDay; }
            set
            {
                if (this._termPaidWithinDay != value)
                {
                    this.IsDirty = true;
                    this._termPaidWithinDay = value;
                    OnPropertyChanged(() => TermPaidWithinDay);
                    PropertyChangedCompleted(() => TermPaidWithinDay);
                }
            }
        }

        protected string _paymentTermDescription;
        /// <summary>
        /// Property Model
        /// <para>Gets or sets the PaymentTermDescription</para>
        /// </summary>
        public string PaymentTermDescription
        {
            get { return this._paymentTermDescription; }
            set
            {
                if (this._paymentTermDescription != value)
                {
                    this.IsDirty = true;
                    this._paymentTermDescription = value;
                    OnPropertyChanged(() => PaymentTermDescription);
                    PropertyChangedCompleted(() => PaymentTermDescription);
                }
            }
        }

        protected bool _isTaxExemption;
        /// <summary>
        /// Property Model
        /// <para>Gets or sets the IsTaxExemption</para>
        /// </summary>
        public bool IsTaxExemption
        {
            get { return this._isTaxExemption; }
            set
            {
                if (this._isTaxExemption != value)
                {
                    this.IsDirty = true;
                    this._isTaxExemption = value;
                    OnPropertyChanged(() => IsTaxExemption);
                    PropertyChangedCompleted(() => IsTaxExemption);
                }
            }
        }

        protected string _taxExemption;
        /// <summary>
        /// Property Model
        /// <para>Gets or sets the TaxExemption</para>
        /// </summary>
        public string TaxExemption
        {
            get { return this._taxExemption; }
            set
            {
                if (this._taxExemption != value)
                {
                    this.IsDirty = true;
                    this._taxExemption = value;
                    OnPropertyChanged(() => TaxExemption);
                    PropertyChangedCompleted(() => TaxExemption);
                }
            }
        }

        protected short _shippedBox;
        /// <summary>
        /// Property Model
        /// <para>Gets or sets the ShippedBox</para>
        /// </summary>
        public short ShippedBox
        {
            get { return this._shippedBox; }
            set
            {
                if (this._shippedBox != value)
                {
                    this.IsDirty = true;
                    this._shippedBox = value;
                    OnPropertyChanged(() => ShippedBox);
                    PropertyChangedCompleted(() => ShippedBox);
                }
            }
        }

        protected short _packedQty;
        /// <summary>
        /// Property Model
        /// <para>Gets or sets the PackedQty</para>
        /// </summary>
        public short PackedQty
        {
            get { return this._packedQty; }
            set
            {
                if (this._packedQty != value)
                {
                    this.IsDirty = true;
                    this._packedQty = value;
                    OnPropertyChanged(() => PackedQty);
                    PropertyChangedCompleted(() => PackedQty);
                }
            }
        }

        protected decimal _totalWeight;
        /// <summary>
        /// Property Model
        /// <para>Gets or sets the TotalWeight</para>
        /// </summary>
        public decimal TotalWeight
        {
            get { return this._totalWeight; }
            set
            {
                if (this._totalWeight != value)
                {
                    this.IsDirty = true;
                    this._totalWeight = value;
                    OnPropertyChanged(() => TotalWeight);
                    PropertyChangedCompleted(() => TotalWeight);
                }
            }
        }

        protected short _weightUnit;
        /// <summary>
        /// Property Model
        /// <para>Gets or sets the WeightUnit</para>
        /// </summary>
        public short WeightUnit
        {
            get { return this._weightUnit; }
            set
            {
                if (this._weightUnit != value)
                {
                    this.IsDirty = true;
                    this._weightUnit = value;
                    OnPropertyChanged(() => WeightUnit);
                    PropertyChangedCompleted(() => WeightUnit);
                }
            }
        }

        protected int _storeCode;
        /// <summary>
        /// Property Model
        /// <para>Gets or sets the StoreCode</para>
        /// </summary>
        public int StoreCode
        {
            get { return this._storeCode; }
            set
            {
                if (this._storeCode != value)
                {
                    this.IsDirty = true;
                    this._storeCode = value;
                    OnPropertyChanged(() => StoreCode);
                    PropertyChangedCompleted(() => StoreCode);
                }
            }
        }

        protected bool _isRedeeem;
        /// <summary>
        /// Property Model
        /// <para>Gets or sets the IsRedeeem</para>
        /// </summary>
        public bool IsRedeeem
        {
            get { return this._isRedeeem; }
            set
            {
                if (this._isRedeeem != value)
                {
                    this.IsDirty = true;
                    this._isRedeeem = value;
                    OnPropertyChanged(() => IsRedeeem);
                    PropertyChangedCompleted(() => IsRedeeem);
                }
            }
        }

        protected bool _isPurge;
        /// <summary>
        /// Property Model
        /// <para>Gets or sets the IsPurge</para>
        /// </summary>
        public bool IsPurge
        {
            get { return this._isPurge; }
            set
            {
                if (this._isPurge != value)
                {
                    this.IsDirty = true;
                    this._isPurge = value;
                    OnPropertyChanged(() => IsPurge);
                    PropertyChangedCompleted(() => IsPurge);
                }
            }
        }

        protected bool _isLocked;
        /// <summary>
        /// Property Model
        /// <para>Gets or sets the IsLocked</para>
        /// </summary>
        public bool IsLocked
        {
            get { return this._isLocked; }
            set
            {
                if (this._isLocked != value)
                {
                    this.IsDirty = true;
                    this._isLocked = value;
                    OnPropertyChanged(() => IsLocked);
                    PropertyChangedCompleted(() => IsLocked);
                }
            }
        }

        protected decimal _rewardAmount;
        /// <summary>
        /// Property Model
        /// <para>Gets or sets the RewardAmount</para>
        /// </summary>
        public decimal RewardAmount
        {
            get { return this._rewardAmount; }
            set
            {
                if (this._rewardAmount != value)
                {
                    this.IsDirty = true;
                    this._rewardAmount = value;
                    OnPropertyChanged(() => RewardAmount);
                    PropertyChangedCompleted(() => RewardAmount);
                }
            }
        }

        protected string _cashier;
        /// <summary>
        /// Property Model
        /// <para>Gets or sets the Cashier</para>
        /// </summary>
        public string Cashier
        {
            get { return this._cashier; }
            set
            {
                if (this._cashier != value)
                {
                    this.IsDirty = true;
                    this._cashier = value;
                    OnPropertyChanged(() => Cashier);
                    PropertyChangedCompleted(() => Cashier);
                }
            }
        }

        protected bool _isQuationConverted;
        /// <summary>
        /// Property Model
        /// <para>Gets or sets the IsQuationConverted</para>
        /// </summary>
        public bool IsQuationConverted
        {
            get { return this._isQuationConverted; }
            set
            {
                if (this._isQuationConverted != value)
                {
                    this.IsDirty = true;
                    this._isQuationConverted = value;
                    OnPropertyChanged(() => IsQuationConverted);
                    PropertyChangedCompleted(() => IsQuationConverted);
                }
            }
        }

        #endregion

        #region Public Methods

        /// <summary>
        /// <para>Public Method</para>
        /// Method for set IsNew & IsDirty = false;
        /// </summary>
        public void EndUpdate()
        {
            this.IsNew = false;
            this.IsDirty = false;
        }

        /// <summary>
        /// Public Method
        /// <para>Method for set PropertyModel to Entity</para>
        /// </summary>
        public void ToEntity()
        {
            if (IsNew)
                this.base_SaleOrder.Id = this.Id;
            this.base_SaleOrder.SONumber = this.SONumber;
            this.base_SaleOrder.OrderDate = this.OrderDate;
            this.base_SaleOrder.OrderStatus = this.OrderStatus;
            this.base_SaleOrder.BillAddressId = this.BillAddressId;
            this.base_SaleOrder.BillAddress = this.BillAddress;
            this.base_SaleOrder.ShipAddressId = this.ShipAddressId;
            this.base_SaleOrder.ShipAddress = this.ShipAddress;
            this.base_SaleOrder.PromotionCode = this.PromotionCode;
            this.base_SaleOrder.SaleRep = this.SaleRep;
            this.base_SaleOrder.CustomerResource = this.CustomerResource;
            this.base_SaleOrder.PriceSchemaId = this.PriceSchemaId;
            this.base_SaleOrder.DueDate = this.DueDate;
            this.base_SaleOrder.RequestShipDate = this.RequestShipDate;
            this.base_SaleOrder.SubTotal = this.SubTotal;
            this.base_SaleOrder.TaxLocation = this.TaxLocation;
            this.base_SaleOrder.TaxCode = this.TaxCode;
            this.base_SaleOrder.DiscountAmount = this.DiscountAmount;
            this.base_SaleOrder.TaxAmount = this.TaxAmount;
            this.base_SaleOrder.DiscountPercent = this.DiscountPercent;
            this.base_SaleOrder.TaxPercent = this.TaxPercent;
            this.base_SaleOrder.Shipping = this.Shipping;
            this.base_SaleOrder.Total = this.Total;
            this.base_SaleOrder.Paid = this.Paid;
            this.base_SaleOrder.Balance = this.Balance;
            this.base_SaleOrder.RefundedAmount = this.RefundedAmount;
            this.base_SaleOrder.IsMultiPayment = this.IsMultiPayment;
            this.base_SaleOrder.Remark = this.Remark;
            this.base_SaleOrder.IsFullWorkflow = this.IsFullWorkflow;
            this.base_SaleOrder.QtyOrdered = this.QtyOrdered;
            this.base_SaleOrder.QtyDue = this.QtyDue;
            this.base_SaleOrder.QtyReceived = this.QtyReceived;
            this.base_SaleOrder.UnFilled = this.UnFilled;
            this.base_SaleOrder.UserCreated = this.UserCreated;
            this.base_SaleOrder.DateCreated = this.DateCreated;
            this.base_SaleOrder.UserUpdated = this.UserUpdated;
            this.base_SaleOrder.DateUpdated = this.DateUpdated;
            this.base_SaleOrder.Resource = this.Resource;
            this.base_SaleOrder.BookingChanel = this.BookingChanel;
            this.base_SaleOrder.ShippedCount = this.ShippedCount;
            this.base_SaleOrder.Deposit = this.Deposit;
            this.base_SaleOrder.Transaction = this.Transaction;
            this.base_SaleOrder.TermDiscountPercent = this.TermDiscountPercent;
            this.base_SaleOrder.TermNetDue = this.TermNetDue;
            this.base_SaleOrder.TermPaidWithinDay = this.TermPaidWithinDay;
            this.base_SaleOrder.PaymentTermDescription = this.PaymentTermDescription;
            this.base_SaleOrder.IsTaxExemption = this.IsTaxExemption;
            this.base_SaleOrder.TaxExemption = this.TaxExemption;
            this.base_SaleOrder.ShippedBox = this.ShippedBox;
            this.base_SaleOrder.PackedQty = this.PackedQty;
            this.base_SaleOrder.TotalWeight = this.TotalWeight;
            this.base_SaleOrder.WeightUnit = this.WeightUnit;
            this.base_SaleOrder.StoreCode = this.StoreCode;
            this.base_SaleOrder.IsRedeeem = this.IsRedeeem;
            this.base_SaleOrder.IsPurge = this.IsPurge;
            this.base_SaleOrder.IsLocked = this.IsLocked;
            this.base_SaleOrder.RewardAmount = this.RewardAmount;
            this.base_SaleOrder.Cashier = this.Cashier;
            this.base_SaleOrder.IsQuationConverted = this.IsQuationConverted;
        }

        /// <summary>
        /// Public Method
        /// <para>Method for set Entity to PropertyModel</para>
        /// </summary
        public void ToModel()
        {
            this._id = this.base_SaleOrder.Id;
            this._sONumber = this.base_SaleOrder.SONumber;
            this._orderDate = this.base_SaleOrder.OrderDate;
            this._orderStatus = this.base_SaleOrder.OrderStatus;
            this._billAddressId = this.base_SaleOrder.BillAddressId;
            this._billAddress = this.base_SaleOrder.BillAddress;
            this._shipAddressId = this.base_SaleOrder.ShipAddressId;
            this._shipAddress = this.base_SaleOrder.ShipAddress;
            this._promotionCode = this.base_SaleOrder.PromotionCode;
            this._saleRep = this.base_SaleOrder.SaleRep;
            this._customerResource = this.base_SaleOrder.CustomerResource;
            this._priceSchemaId = this.base_SaleOrder.PriceSchemaId;
            this._dueDate = this.base_SaleOrder.DueDate;
            this._requestShipDate = this.base_SaleOrder.RequestShipDate;
            this._subTotal = this.base_SaleOrder.SubTotal;
            this._taxLocation = this.base_SaleOrder.TaxLocation;
            this._taxCode = this.base_SaleOrder.TaxCode;
            this._discountAmount = this.base_SaleOrder.DiscountAmount;
            this._taxAmount = this.base_SaleOrder.TaxAmount;
            this._discountPercent = this.base_SaleOrder.DiscountPercent;
            this._taxPercent = this.base_SaleOrder.TaxPercent;
            this._shipping = this.base_SaleOrder.Shipping;
            this._total = this.base_SaleOrder.Total;
            this._paid = this.base_SaleOrder.Paid;
            this._balance = this.base_SaleOrder.Balance;
            this._refundedAmount = this.base_SaleOrder.RefundedAmount;
            this._isMultiPayment = this.base_SaleOrder.IsMultiPayment;
            this._remark = this.base_SaleOrder.Remark;
            this._isFullWorkflow = this.base_SaleOrder.IsFullWorkflow;
            this._qtyOrdered = this.base_SaleOrder.QtyOrdered;
            this._qtyDue = this.base_SaleOrder.QtyDue;
            this._qtyReceived = this.base_SaleOrder.QtyReceived;
            this._unFilled = this.base_SaleOrder.UnFilled;
            this._userCreated = this.base_SaleOrder.UserCreated;
            this._dateCreated = this.base_SaleOrder.DateCreated;
            this._userUpdated = this.base_SaleOrder.UserUpdated;
            this._dateUpdated = this.base_SaleOrder.DateUpdated;
            this._resource = this.base_SaleOrder.Resource;
            this._bookingChanel = this.base_SaleOrder.BookingChanel;
            this._shippedCount = this.base_SaleOrder.ShippedCount;
            this._deposit = this.base_SaleOrder.Deposit;
            this._transaction = this.base_SaleOrder.Transaction;
            this._termDiscountPercent = this.base_SaleOrder.TermDiscountPercent;
            this._termNetDue = this.base_SaleOrder.TermNetDue;
            this._termPaidWithinDay = this.base_SaleOrder.TermPaidWithinDay;
            this._paymentTermDescription = this.base_SaleOrder.PaymentTermDescription;
            this._isTaxExemption = this.base_SaleOrder.IsTaxExemption;
            this._taxExemption = this.base_SaleOrder.TaxExemption;
            this._shippedBox = this.base_SaleOrder.ShippedBox;
            this._packedQty = this.base_SaleOrder.PackedQty;
            this._totalWeight = this.base_SaleOrder.TotalWeight;
            this._weightUnit = this.base_SaleOrder.WeightUnit;
            this._storeCode = this.base_SaleOrder.StoreCode;
            this._isRedeeem = this.base_SaleOrder.IsRedeeem;
            this._isPurge = this.base_SaleOrder.IsPurge;
            this._isLocked = this.base_SaleOrder.IsLocked;
            this._rewardAmount = this.base_SaleOrder.RewardAmount;
            this._cashier = this.base_SaleOrder.Cashier;
            this._isQuationConverted = this.base_SaleOrder.IsQuationConverted;
        }

        /// <summary>
        /// Public Method
        /// <para>Method for set Entity to PropertyModel</para>
        /// </summary
        public void ToModelAndRaise()
        {
            this.Id = this.base_SaleOrder.Id;
            this.SONumber = this.base_SaleOrder.SONumber;
            this.OrderDate = this.base_SaleOrder.OrderDate;
            this.OrderStatus = this.base_SaleOrder.OrderStatus;
            this.BillAddressId = this.base_SaleOrder.BillAddressId;
            this.BillAddress = this.base_SaleOrder.BillAddress;
            this.ShipAddressId = this.base_SaleOrder.ShipAddressId;
            this.ShipAddress = this.base_SaleOrder.ShipAddress;
            this.PromotionCode = this.base_SaleOrder.PromotionCode;
            this.SaleRep = this.base_SaleOrder.SaleRep;
            this.CustomerResource = this.base_SaleOrder.CustomerResource;
            this.PriceSchemaId = this.base_SaleOrder.PriceSchemaId;
            this.DueDate = this.base_SaleOrder.DueDate;
            this.RequestShipDate = this.base_SaleOrder.RequestShipDate;
            this.SubTotal = this.base_SaleOrder.SubTotal;
            this.TaxLocation = this.base_SaleOrder.TaxLocation;
            this.TaxCode = this.base_SaleOrder.TaxCode;
            this.DiscountAmount = this.base_SaleOrder.DiscountAmount;
            this.TaxAmount = this.base_SaleOrder.TaxAmount;
            this.DiscountPercent = this.base_SaleOrder.DiscountPercent;
            this.TaxPercent = this.base_SaleOrder.TaxPercent;
            this.Shipping = this.base_SaleOrder.Shipping;
            this.Total = this.base_SaleOrder.Total;
            this.Paid = this.base_SaleOrder.Paid;
            this.Balance = this.base_SaleOrder.Balance;
            this.RefundedAmount = this.base_SaleOrder.RefundedAmount;
            this.IsMultiPayment = this.base_SaleOrder.IsMultiPayment;
            this.Remark = this.base_SaleOrder.Remark;
            this.IsFullWorkflow = this.base_SaleOrder.IsFullWorkflow;
            this.QtyOrdered = this.base_SaleOrder.QtyOrdered;
            this.QtyDue = this.base_SaleOrder.QtyDue;
            this.QtyReceived = this.base_SaleOrder.QtyReceived;
            this.UnFilled = this.base_SaleOrder.UnFilled;
            this.UserCreated = this.base_SaleOrder.UserCreated;
            this.DateCreated = this.base_SaleOrder.DateCreated;
            this.UserUpdated = this.base_SaleOrder.UserUpdated;
            this.DateUpdated = this.base_SaleOrder.DateUpdated;
            this.Resource = this.base_SaleOrder.Resource;
            this.BookingChanel = this.base_SaleOrder.BookingChanel;
            this.ShippedCount = this.base_SaleOrder.ShippedCount;
            this.Deposit = this.base_SaleOrder.Deposit;
            this.Transaction = this.base_SaleOrder.Transaction;
            this.TermDiscountPercent = this.base_SaleOrder.TermDiscountPercent;
            this.TermNetDue = this.base_SaleOrder.TermNetDue;
            this.TermPaidWithinDay = this.base_SaleOrder.TermPaidWithinDay;
            this.PaymentTermDescription = this.base_SaleOrder.PaymentTermDescription;
            this.IsTaxExemption = this.base_SaleOrder.IsTaxExemption;
            this.TaxExemption = this.base_SaleOrder.TaxExemption;
            this.ShippedBox = this.base_SaleOrder.ShippedBox;
            this.PackedQty = this.base_SaleOrder.PackedQty;
            this.TotalWeight = this.base_SaleOrder.TotalWeight;
            this.WeightUnit = this.base_SaleOrder.WeightUnit;
            this.StoreCode = this.base_SaleOrder.StoreCode;
            this.IsRedeeem = this.base_SaleOrder.IsRedeeem;
            this.IsPurge = this.base_SaleOrder.IsPurge;
            this.IsLocked = this.base_SaleOrder.IsLocked;
            this.RewardAmount = this.base_SaleOrder.RewardAmount;
            this.Cashier = this.base_SaleOrder.Cashier;
            this.IsQuationConverted = this.base_SaleOrder.IsQuationConverted;
        }

        #endregion

        #region Custom Code

        #region Properties

        #region ResourceString

        /// <summary>
        /// Gets or sets the ResourceString.
        /// </summary>
        public string ResourceString
        {
            get
            {
                return this.Resource.ToString();
            }

        }
        #endregion

        #region SaleOrderDetailCollection
        private CollectionBase<base_SaleOrderDetailModel> _saleOrderDetailCollection;
        /// <summary>
        /// Gets or sets the SaleOrderDetailCollection.
        /// </summary>
        public CollectionBase<base_SaleOrderDetailModel> SaleOrderDetailCollection
        {
            get { return _saleOrderDetailCollection; }
            set
            {
                if (_saleOrderDetailCollection != value)
                {
                    _saleOrderDetailCollection = value;
                    OnPropertyChanged(() => SaleOrderDetailCollection);
                }
            }
        }
        #endregion

        #region SaleOrderShipCollection
        private CollectionBase<base_SaleOrderShipModel> _saleOrderShipCollection;
        /// <summary>
        /// Gets or sets the SaleOrderShipCollection.
        /// </summary>
        public CollectionBase<base_SaleOrderShipModel> SaleOrderShipCollection
        {
            get { return _saleOrderShipCollection; }
            set
            {
                if (_saleOrderShipCollection != value)
                {
                    _saleOrderShipCollection = value;
                    OnPropertyChanged(() => SaleOrderShipCollection);
                }
            }
        }
        #endregion

        #region GuestModel
        private base_GuestModel _GuestModel;
        /// <summary>
        /// Gets or sets the GuestModel.
        /// </summary>
        public base_GuestModel GuestModel
        {
            get { return _GuestModel; }
            set
            {
                if (_GuestModel != value)
                {
                    _GuestModel = value;
                    OnPropertyChanged(() => GuestModel);
                }
            }
        }
        #endregion

        #region BillAddressModel
        private base_GuestAddressModel _billAddressModel;
        /// <summary>
        /// Gets or sets the BillAddressModel.
        /// </summary>
        public base_GuestAddressModel BillAddressModel
        {
            get { return _billAddressModel; }
            set
            {
                if (_billAddressModel != value)
                {
                    _billAddressModel = value;
                    OnPropertyChanged(() => BillAddressModel);
                }
            }
        }
        #endregion

        #region ShipAddressModel
        private base_GuestAddressModel _shipAddressModel;
        /// <summary>
        /// Gets or sets the ShipAddressModel.
        /// </summary>
        public base_GuestAddressModel ShipAddressModel
        {
            get { return _shipAddressModel; }
            set
            {
                if (_shipAddressModel != value)
                {
                    _shipAddressModel = value;
                    OnPropertyChanged(() => ShipAddressModel);
                }
            }
        }
        #endregion

        #region TaxLocationModel
        private base_SaleTaxLocationModel _taxLocationModel;
        /// <summary>
        /// Gets or sets the TaxLocationModel.
        /// <para>using for binding on datagrid Search</para>
        /// </summary>
        public base_SaleTaxLocationModel TaxLocationModel
        {
            get { return _taxLocationModel; }
            set
            {
                if (_taxLocationModel != value)
                {
                    _taxLocationModel = value;
                    OnPropertyChanged(() => TaxLocationModel);
                }
            }
        }
        #endregion

        #region TaxCodeModel
        private base_SaleTaxLocationModel _taxCodeModel;
        /// <summary>
        /// Gets or sets the TaxCodeModel.
        /// </summary>
        public base_SaleTaxLocationModel TaxCodeModel
        {
            get { return _taxCodeModel; }
            set
            {
                if (_taxCodeModel != value)
                {
                    _taxCodeModel = value;
                    OnPropertyChanged(() => TaxCodeModel);
                }
            }
        }
        #endregion

        #region ShipProcess
        private bool _shipProcess;
        /// <summary>
        /// Gets or sets the ShipProcess.
        /// Using for show Tab Ship
        /// </summary>
        public bool ShipProcess
        {
            get { return _shipProcess; }
            set
            {
                if (_shipProcess != value)
                {
                    _shipProcess = value;
                    OnPropertyChanged(() => ShipProcess);
                }
            }
        }
        #endregion

        #region AnyShipped
        //private bool _anyShipped;
        /// <summary>
        /// Gets or sets the AnyShipped.
        /// </summary>
        public bool AnyShipped
        {
            get
            {
                if (this.SaleOrderShipCollection != null)
                    return this.SaleOrderShipCollection.Any(x => x.IsShipped.HasValue && x.IsShipped.Value);
                return false;
            }
            //set
            //{
            //    if (_anyShipped != value)
            //    {
            //        _anyShipped = value;
            //        OnPropertyChanged(() => AnyShipped);
            //    }
            //}
        }
        #endregion

        #region IsDeposit
        private bool _isDeposit;
        /// <summary>
        /// Gets or sets the IsDeposit.
        /// <para>Using for show deposit function in quotation</para>
        /// </summary>
        public bool IsDeposit
        {
            get { return _isDeposit; }
            set
            {
                if (_isDeposit != value)
                {
                    _isDeposit = value;
                    OnPropertyChanged(() => IsDeposit);
                }
            }
        }
        #endregion

        #region PaymentModel
        private base_ResourcePaymentModel _paymentModel;
        /// <summary>
        /// Gets or sets the PaymentModel.
        /// </summary>
        public base_ResourcePaymentModel PaymentModel
        {
            get { return _paymentModel; }
            set
            {
                if (_paymentModel != value)
                {
                    _paymentModel = value;
                    OnPropertyChanged(() => PaymentModel);
                }
            }
        }
        #endregion

        #region RewardValueApply
        private decimal _rewardValueApply;
        /// <summary>
        /// Gets or sets the RewardValueApply.
        /// Value of reward after apply
        /// </summary>
        public decimal RewardValueApply
        {
            get { return _rewardValueApply; }
            set
            {
                if (_rewardValueApply != value)
                {
                    _rewardValueApply = value;
                    OnPropertyChanged(() => RewardValueApply);
                }
            }
        }
        #endregion

        #region IsApplyReward
        private bool _isApplyReward;
        /// <summary>
        /// Gets or sets the IsApplyReward.
        /// <para>Reward program can using for if customer purchase</para>
        /// <para>
        /// True : Have Reward Program
        /// False : have no reward program 
        /// </para>
        /// </summary>
        public bool IsApplyReward
        {
            get { return _isApplyReward; }
            set
            {
                if (_isApplyReward != value)
                {
                    _isApplyReward = value;
                    OnPropertyChanged(() => IsApplyReward);
                }
            }
        }
        #endregion

        #region SaleOrderShipDetailCollection
        private CollectionBase<base_SaleOrderShipDetailModel> _saleOrderShipDetailCollection;
        /// <summary>
        /// Gets or sets the SaleOrderShipDetailCollection.
        /// </summary>
        public CollectionBase<base_SaleOrderShipDetailModel> SaleOrderShipDetailCollection
        {
            get { return _saleOrderShipDetailCollection; }
            set
            {
                if (_saleOrderShipDetailCollection != value)
                {
                    _saleOrderShipDetailCollection = value;
                    OnPropertyChanged(() => SaleOrderShipDetailCollection);
                }
            }
        }
        #endregion

        #region ReturnModel
        private base_ResourceReturnModel _returnModel;
        /// <summary>
        /// Gets or sets the ReturnModel.
        /// </summary>
        public base_ResourceReturnModel ReturnModel
        {
            get { return _returnModel; }
            set
            {
                if (_returnModel != value)
                {
                    _returnModel = value;
                    OnPropertyChanged(() => ReturnModel);
                }
            }
        }
        #endregion

        #region SaleOrderShippedCollection
        private CollectionBase<base_SaleOrderDetailModel> _saleOrderShippedCollection;
        /// <summary>
        /// Gets or sets the SaleOrderReturnedCollection.
        /// <para>store items saleorderdetail is shipped </para>
        /// <para>quantity of shipped is PickQty</para>
        /// </summary>
        public CollectionBase<base_SaleOrderDetailModel> SaleOrderShippedCollection
        {
            get { return _saleOrderShippedCollection; }
            set
            {
                if (_saleOrderShippedCollection != value)
                {
                    _saleOrderShippedCollection = value;
                    OnPropertyChanged(() => SaleOrderShippedCollection);
                }
            }
        }
        #endregion

        #region ShipTaxAmount
        private decimal _shipTaxAmount;
        /// <summary>
        /// Gets or sets the ShipTaxAmount.
        /// </summary>
        public decimal ShipTaxAmount
        {
            get { return _shipTaxAmount; }
            set
            {
                if (_shipTaxAmount != value)
                {
                    _shipTaxAmount = value;
                    OnPropertyChanged(() => ShipTaxAmount);
                }
            }
        }
        #endregion

        #region ProductTaxAmount
        private decimal _productTaxAmount;
        /// <summary>
        /// Gets or sets the ProductTaxAmount.
        /// </summary>
        public decimal ProductTaxAmount
        {
            get { return _productTaxAmount; }
            set
            {
                if (_productTaxAmount != value)
                {
                    _productTaxAmount = value;
                    OnPropertyChanged(() => ProductTaxAmount);
                }
            }
        }
        #endregion

        #region CommissionCollection
        private CollectionBase<base_SaleCommissionModel> _commissionCollection;
        /// <summary>
        /// Gets or sets the CommissionCollection.
        /// </summary>
        public CollectionBase<base_SaleCommissionModel> CommissionCollection
        {
            get { return _commissionCollection; }
            set
            {
                if (_commissionCollection != value)
                {
                    _commissionCollection = value;
                    OnPropertyChanged(() => CommissionCollection);
                }
            }
        }
        #endregion

        #region IsShowErrorColumn
        private bool _isHiddenErrorColumn;
        /// <summary>
        /// Gets or sets the IsHiddenErrorColumn.
        /// </summary>
        public bool IsHiddenErrorColumn
        {
            get { return _isHiddenErrorColumn; }
            set
            {
                if (_isHiddenErrorColumn != value)
                {
                    _isHiddenErrorColumn = value;
                    OnPropertyChanged(() => IsHiddenErrorColumn);
                }
            }
        }
        #endregion

        #region TotalPaid
        //private decimal _totalPaid;
        /// <summary>
        /// Gets or sets the TotalPaid.
        /// </summary>
        public decimal TotalPaid
        {
            get
            {
                if (this.PaymentCollection != null)
                    return this.PaymentCollection.Sum(x => x.TotalPaid -x.Change);
                return 0;
            }
            //set
            //{
            //    if (_totalPaid != value)
            //    {
            //        _totalPaid = value;
            //        OnPropertyChanged(() => TotalPaid);
            //    }
            //}
        }


        #endregion

        #endregion

        #region Methods

        /// <summary>
        /// Calculator Sub total & total
        /// </summary>
        public void CalcSubTotal()
        {
            if (this.SaleOrderDetailCollection != null)
            {
                this.SubTotal = this.SaleOrderDetailCollection.Sum(x => x.SubTotal);
                CalcTotal();
            }
        }

        /// <summary>
        /// Calculator Total 
        /// <para> Total = Subtotal - DisountAmount + TaxAmount + Shipping </para>
        /// </summary>
        public void CalcTotal()
        {
            this.Total = SubTotal - this.DiscountAmount + TaxAmount + this.Shipping;
        }

        /// <summary>
        /// Calculate Discount amount when discount percent changed
        /// </summary>
        public void CalcDiscountPercent()
        {
            if (DiscountPercent > 0)
            {
                _discountAmount = SubTotal * DiscountPercent / 100;
                OnPropertyChanged(() => DiscountAmount);
            }
        }

        /// <summary>
        /// Calculate balance =this.Total - this.Deposit - this.Paid;
        /// </summary>
        public void CalcBalance()
        {
            if (IsDeposit)
                this.Balance = this.Total - (this.Deposit.HasValue ? this.Deposit.Value : 0) - this.Paid;
            else

                this.Balance = this.RewardAmount - (this.Deposit.HasValue ? this.Deposit.Value : 0) - this.Paid;
        }

        /// <summary>
        /// calculate total packed box
        /// </summary>
        public void RaiseTotalPackedBox()
        {
            if (this.SaleOrderShipCollection != null)
                PackedQty = Convert.ToInt16(this.SaleOrderShipCollection.Where(x => x.SaleOrderShipDetailCollection != null).Sum(x => x.SaleOrderShipDetailCollection.Count));
            else
                PackedQty = 0;

        }

        /// <summary>
        /// calculate total Shipe box
        /// </summary>
        public void RaiseTotalShipBox()
        {
            if (this.SaleOrderShipCollection != null)
                ShippedBox = Convert.ToInt16(this.SaleOrderShipCollection.Sum(x => x.BoxNo));
            else
                ShippedBox = 0;

        }

        /// <summary>
        /// calculate total Shipe box
        /// </summary>
        public void RaiseTotalWeight()
        {
            if (this.SaleOrderShipCollection != null)
                TotalWeight = this.SaleOrderShipCollection.Sum(x => x.Weight);
            else
                TotalWeight = 0;

        }

        public void RaiseAnyShipped()
        {
            OnPropertyChanged(() => AnyShipped);
        }

        public void RaisePropertyChanged(string propertyChanged)
        {
            OnPropertyChanged(propertyChanged);
        }

        public void CalcDueQty()
        {
            QtyDue = QtyOrdered - QtyReceived;
        }


        /// <summary>
        /// Calculate Unfill
        /// </summary>
        public void CalUnfill()
        {
            if (QtyOrdered != 0)
                UnFilled = (Convert.ToDecimal(QtyDue) / Convert.ToDecimal(QtyOrdered)) * 100;
            else
                UnFilled = 0;
        }



        /// <summary>
        /// Public Method
        /// <para>Method for set Entity to PropertyModel</para>
        /// </summary
        private void ToModel(base_SaleOrderModel saleOrderModel)
        {
            //this._id = saleOrderModel.Id;
            //this._sONumber = saleOrderModel.SONumber;
            //this._orderDate = saleOrderModel.OrderDate;
            //this._orderStatus = saleOrderModel.OrderStatus;
            this.BillAddressId = saleOrderModel.BillAddressId;
            this.BillAddress = saleOrderModel.BillAddress;
            this.ShipAddressId = saleOrderModel.ShipAddressId;
            this.ShipAddress = saleOrderModel.ShipAddress;
            this.PromotionCode = saleOrderModel.PromotionCode;
            this.SaleRep = saleOrderModel.SaleRep;
            this.CustomerResource = saleOrderModel.CustomerResource;
            this.PriceSchemaId = saleOrderModel.PriceSchemaId;
            this.DueDate = saleOrderModel.DueDate;
            this.RequestShipDate = saleOrderModel.RequestShipDate;
            this.SubTotal = saleOrderModel.SubTotal;
            this.TaxLocation = saleOrderModel.TaxLocation;
            this.TaxCode = saleOrderModel.TaxCode;
            this.DiscountAmount = saleOrderModel.DiscountAmount;
            this.TaxAmount = saleOrderModel.TaxAmount;
            this.DiscountPercent = saleOrderModel.DiscountPercent;
            this.TaxPercent = saleOrderModel.TaxPercent;
            this.Shipping = saleOrderModel.Shipping;
            this.Total = saleOrderModel.Total;
            //this.Paid = saleOrderModel.Paid;
            //this.Balance = saleOrderModel.Balance;
            //this._refundFee = saleOrderModel.RefundFee;
            this.IsMultiPayment = saleOrderModel.IsMultiPayment;
            this.Remark = saleOrderModel.Remark;
            this.IsFullWorkflow = saleOrderModel.IsFullWorkflow;
            this.QtyOrdered = saleOrderModel.QtyOrdered;
            //this.QtyDue = saleOrderModel.QtyDue;
            this.QtyReceived = saleOrderModel.QtyReceived;
            //this.UnFilled = saleOrderModel.UnFilled;
            //this._userCreated = saleOrderModel.UserCreated;
            //this._dateCreated = saleOrderModel.DateCreated;
            //this._userUpdated = saleOrderModel.UserUpdated;
            //this._dateUpdated = saleOrderModel.DateUpdated;
            //this._resource = saleOrderModel.Resource;
            this._bookingChanel = saleOrderModel.BookingChanel;
            //this._shippedCount = saleOrderModel.ShippedCount;
            //this.Deposit = saleOrderModel.Deposit;
            this.Transaction = saleOrderModel.Transaction;
            this.TermDiscountPercent = saleOrderModel.TermDiscountPercent;
            this.TermNetDue = saleOrderModel.TermNetDue;
            this.TermPaidWithinDay = saleOrderModel.TermPaidWithinDay;
            this.PaymentTermDescription = saleOrderModel.PaymentTermDescription;
            this.IsTaxExemption = saleOrderModel.IsTaxExemption;
            this.TaxExemption = saleOrderModel.TaxExemption;
            //this._shippedBox = saleOrderModel.ShippedBox;
            //this._packedQty = saleOrderModel.PackedQty;
            //this._totalWeight = saleOrderModel.TotalWeight;
            this.WeightUnit = saleOrderModel.WeightUnit;
            this.StoreCode = saleOrderModel.StoreCode;
            //this._isRedeeem = saleOrderModel.IsRedeeem;
            this.IsPurge = saleOrderModel.IsPurge;
        }

        public void CopyFrom(base_SaleOrderModel saleOrderModel)
        {
            ToModel(saleOrderModel);
            if (saleOrderModel.GuestModel != null)
            {
                this.GuestModel = saleOrderModel.GuestModel;
                if (saleOrderModel.GuestModel.GuestRewardCollection != null)
                    this.GuestModel.GuestRewardCollection = saleOrderModel.GuestModel.GuestRewardCollection;
            }
            if (saleOrderModel.TaxCode != null)
            {
                //Get TaxCode
                this.TaxCodeModel = saleOrderModel.TaxCodeModel;
            }

            if (saleOrderModel.TaxLocationModel != null)
            {
                //Get TaxLocation
                this.TaxLocationModel = saleOrderModel.TaxLocationModel;
            }
            if (saleOrderModel.BillAddressModel != null)
                this.BillAddressModel = saleOrderModel.BillAddressModel;
            if (saleOrderModel.ShipAddressModel != null)
                this.ShipAddressModel = saleOrderModel.ShipAddressModel;


            //Check Deposit is accepted?
            this.IsDeposit = saleOrderModel.IsDeposit;
        }


        public void RaiseTotalPaid() {
            OnPropertyChanged(() => TotalPaid);
        }
        public void RaisePropertyChanged(Expression<Func<base_SaleOrderModel>> model)
        {
            OnPropertyChanged(model);
        }
        #endregion

        #region Override Methods
        protected override void PropertyChangedCompleted(string propertyName)
        {
            switch (propertyName)
            {
                case "DiscountAmount":
                    _discountPercent = 0;
                    OnPropertyChanged(() => DiscountPercent);
                    break;
                case "DiscountPercent":
                    CalcDiscountPercent();
                    break;
            }
        }


        #endregion

        #endregion

        #region IDataErrorInfo Members

        public string Error
        {
            get
            {
                List<string> errors = new List<string>();
                PropertyDescriptorCollection props = TypeDescriptor.GetProperties(this);
                foreach (PropertyDescriptor prop in props)
                {
                    string msg = this[prop.Name];
                    if (!string.IsNullOrWhiteSpace(msg))
                    {
                        errors.Add(msg);
                    }
                }
                return string.Join(Environment.NewLine, errors);
            }
        }

        public string this[string columnName]
        {
            get
            {
                string message = string.Empty;

                switch (columnName)
                {
                    case "Id":
                        break;
                    case "RequestShipDate":
                        if (RequestShipDate < DateTime.Now)
                            message = "Request ship date must greater than current date";
                        break;
                    case "BillAddress":
                        if (string.IsNullOrWhiteSpace(BillAddress))
                            message = "Bill Address is required";
                        break;
                    case "ShipAddress":
                        if (string.IsNullOrWhiteSpace(ShipAddress))
                            message = "Ship Address is required";
                        break;

                    case "CustomerResource":
                        if (string.IsNullOrWhiteSpace(CustomerResource))
                            message = "Customer is required";
                        break;
                }

                if (!string.IsNullOrWhiteSpace(message))
                    return message;
                return null;
            }
        }

        #endregion

        #region PaymentTab

        private bool _paymentProcess;
        /// <summary>
        /// Gets or sets the PaymentProcess.
        /// </summary>
        public bool PaymentProcess
        {
            get { return _paymentProcess; }
            set
            {
                if (_paymentProcess != value)
                {
                    _paymentProcess = value;
                    OnPropertyChanged(() => PaymentProcess);
                }
            }
        }

        private ObservableCollection<base_ResourcePaymentModel> _paymentCollection;
        /// <summary>
        /// Gets or sets the PaymentCollection.
        /// </summary>
        public ObservableCollection<base_ResourcePaymentModel> PaymentCollection
        {
            get { return _paymentCollection; }
            set
            {
                if (_paymentCollection != value)
                {
                    _paymentCollection = value;
                    OnPropertyChanged(() => PaymentCollection);
                }
            }
        }

        #endregion
    }
}
