<UserControl x:Class="CPC.POS.View.LayawayView"
             xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             xmlns:Anno="http://schemas.microsoft.com/expression/blend/extensions/annotations/2008"
             xmlns:command="clr-namespace:CPC.Toolkit.Command"
             xmlns:converter="clr-namespace:CPC.Converter"
             xmlns:cpcAddressControl="clr-namespace:CPCToolkitExt.AddressControl;assembly=CPCToolkitExt"
             xmlns:cpcAutoComplete="clr-namespace:CPCToolkitExt.AutoCompleteControl;assembly=CPCToolkitExt"
             xmlns:cpcBehavior="clr-namespace:CPC.Toolkit.Behavior"
             xmlns:cpcComboBox="clr-namespace:CPCToolkitExt.ComboBoxControl;assembly=CPCToolkitExt"
             xmlns:cpcControl="clr-namespace:CPC.Control"
             xmlns:cpcDataGrid="clr-namespace:CPCToolkitExt.DataGridControl;assembly=CPCToolkitExt"
             xmlns:cpcOtherControl="clr-namespace:CPCToolkitExt.OtherControl;assembly=CPCToolkitExt"
             xmlns:cpcTextBox="clr-namespace:CPCToolkitExt.TextBoxControl;assembly=CPCToolkitExt"
             xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
             xmlns:ed="http://schemas.microsoft.com/expression/2010/drawing"
             xmlns:helper="clr-namespace:CPC.Helper"
             xmlns:i="clr-namespace:System.Windows.Interactivity;assembly=System.Windows.Interactivity"
             xmlns:local="clr-namespace:CPC.POS"
             xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
             xmlns:Microsoft_Windows_Themes="clr-namespace:Microsoft.Windows.Themes;assembly=PresentationFramework.Luna"
             xmlns:sys="clr-namespace:System;assembly=mscorlib"
             xmlns:wpfControl="clr-namespace:Xceed.Wpf.Toolkit;assembly=WPFToolkit.Extended"
             x:Name="ucLayawayView"
             Width="Auto"
             Height="Auto"
             Background="{DynamicResource UserControlBackground}"
             helper:ValidationHelper.IsEnabled="True"
             helper:ValidationHelper.IsValid="{Binding IsValid,
                                                       Mode=OneWayToSource}"
             mc:Ignorable="d Anno">
    <UserControl.Resources>
        <!--  Region "Converter"  -->
        <converter:BoolToVisibilityConverter x:Key="boolToVisibilityConverter" />
        <converter:ComboxItemToTextConverter x:Key="comboxItemToTextConverter" />
        <converter:EnumToBoolConverter x:Key="enumToBoolConverter" />
        <converter:ReserseBoolConverter x:Key="reserseBoolConverter" />
        <converter:PermissionConverter x:Key="permissionConverter" />
        <converter:IntegerToBooleanConverter x:Key="integerToBooleanConverter" />
        <!--  EndRegion  -->

        <!--  region "ContextMenu"  -->
        <ContextMenu x:Key="SaleOrderDetailContextMenu">
            <MenuItem Command="{Binding DataContext.EditProductCommand,
                                        RelativeSource={RelativeSource AncestorType={x:Type UserControl},
                                                                       Mode=FindAncestor}}"
                      CommandParameter="{Binding .}"
                      Header="Edit Item"
                      IsEnabled="{Binding .,
                                          Converter={StaticResource permissionConverter},
                                          ConverterParameter=SO100-05-07}">
                <MenuItem.Icon>
                    <Rectangle Width="16"
                               Height="16"
                               Fill="{DynamicResource EditItem}"
                               Stretch="Fill" />
                </MenuItem.Icon>
            </MenuItem>
            <MenuItem Command="{Binding DataContext.SerialTrackingDetailCommand,
                                        RelativeSource={RelativeSource AncestorType={x:Type UserControl},
                                                                       Mode=FindAncestor}}"
                      CommandParameter="{Binding .}"
                      Header="Serial Tracking Detail">
                <MenuItem.Visibility>
                    <Binding Mode="OneWay"
                             Path="ProductModel.IsSerialTracking"
                             UpdateSourceTrigger="PropertyChanged">
                        <Binding.Converter>
                            <converter:BoolToVisibilityConverter FalseToVisibility="Collapsed" />
                        </Binding.Converter>
                    </Binding>
                </MenuItem.Visibility>
                <MenuItem.Icon>
                    <Rectangle Width="16"
                               Height="16"
                               Fill="{DynamicResource EditItem}"
                               Stretch="Fill" />
                </MenuItem.Icon>
            </MenuItem>
            <MenuItem Command="{Binding DataContext.DeleteSaleOrderDetailCommand,
                                        RelativeSource={RelativeSource AncestorType={x:Type UserControl},
                                                                       Mode=FindAncestor}}"
                      CommandParameter="{Binding .}"
                      Header="Delete">
                <MenuItem.Icon>
                    <Rectangle Width="16"
                               Height="16"
                               Fill="{DynamicResource DeleteItem}"
                               Stretch="Fill" />
                </MenuItem.Icon>
            </MenuItem>
        </ContextMenu>
        <!--  EndRegion  -->

        <!--  Region "DataTemplate"  -->
        <DataTemplate x:Key="RowDetailDataTemplateOrderInvoice">
            <Grid x:Name="grdTemplateCustomer"
                  Height="Auto"
                  Margin="0"
                  Background="#FFFFF2F2">
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="50" />
                    <ColumnDefinition Width="*" />
                </Grid.ColumnDefinitions>
                <Grid.RowDefinitions>
                    <RowDefinition Height="25" />
                </Grid.RowDefinitions>
                <StackPanel Grid.Row="1"
                            Grid.Column="1"
                            Orientation="Horizontal">
                    <StackPanel x:Name="stkpDiscount"
                                Margin="0,0,10,0"
                                HorizontalAlignment="Left"
                                Orientation="Horizontal">
                        <StackPanel.Visibility>
                            <Binding Mode="OneWay" Path="ProductModel.IsCoupon">
                                <Binding.Converter>
                                    <converter:BoolToVisibilityConverter FalseToVisibility="Visible" />
                                </Binding.Converter>
                            </Binding>
                        </StackPanel.Visibility>
                        <TextBlock x:Name="txtblTemplatePrice"
                                   Margin="0"
                                   HorizontalAlignment="Left"
                                   VerticalAlignment="Center"
                                   FontStyle="Italic"
                                   Foreground="Red"
                                   Text="Regular Price:"
                                   TextWrapping="NoWrap" />
                        <TextBlock x:Name="txtblBindingRegularPrice"
                                   Margin="5,0,0,0"
                                   HorizontalAlignment="Left"
                                   VerticalAlignment="Center"
                                   FontStyle="Italic"
                                   Foreground="Red"
                                   Text="{Binding RegularPrice,
                                                  Mode=OneWay,
                                                  ConverterCulture={x:Static local:Define.ConverterCulture},
                                                  StringFormat={x:Static local:Define.CurrencyFormat}}"
                                   TextWrapping="NoWrap" />
                        <TextBlock x:Name="txtblUnitDiscount"
                                   Margin="20,0,0,0"
                                   HorizontalAlignment="Left"
                                   VerticalAlignment="Center"
                                   FontStyle="Italic"
                                   Foreground="Red"
                                   Text="Unit Discount:"
                                   TextWrapping="NoWrap" />
                        <TextBlock x:Name="txtblBindingUnitDiscount"
                                   Margin="5,0,0,0"
                                   HorizontalAlignment="Left"
                                   VerticalAlignment="Center"
                                   FontStyle="Italic"
                                   Foreground="Red"
                                   Text="{Binding UnitDiscount,
                                                  ConverterCulture={x:Static local:Define.ConverterCulture},
                                                  StringFormat={x:Static local:Define.CurrencyFormat}}"
                                   TextWrapping="NoWrap" />
                        <TextBlock x:Name="txtblTotalDiscount"
                                   Margin="20,0,0,0"
                                   HorizontalAlignment="Left"
                                   VerticalAlignment="Center"
                                   FontStyle="Italic"
                                   Foreground="Red"
                                   Text="Total Discount:"
                                   TextWrapping="NoWrap" />
                        <TextBlock x:Name="txtblBindingTotalDiscount"
                                   Margin="5,0,0,0"
                                   HorizontalAlignment="Left"
                                   VerticalAlignment="Center"
                                   FontStyle="Italic"
                                   Foreground="Red"
                                   Text="{Binding TotalDiscount,
                                                  ConverterCulture={x:Static local:Define.ConverterCulture},
                                                  StringFormat={x:Static local:Define.CurrencyFormat}}"
                                   TextWrapping="NoWrap" />
                    </StackPanel>
                    <StackPanel x:Name="stkSerial"
                                Height="25"
                                HorizontalAlignment="Left"
                                Orientation="Horizontal">
                        <StackPanel.Visibility>
                            <Binding Mode="OneWay" Path="ProductModel.IsCoupon">
                                <Binding.Converter>
                                    <converter:BoolToVisibilityConverter FalseToVisibility="Visible" />
                                </Binding.Converter>
                            </Binding>
                        </StackPanel.Visibility>
                        <TextBlock x:Name="txtblTemplateSerialNo"
                                   Margin="0"
                                   HorizontalAlignment="Left"
                                   VerticalAlignment="Center"
                                   FontStyle="Italic"
                                   Foreground="#FF0010FF"
                                   Text="S/N: "
                                   TextDecorations="Underline"
                                   TextWrapping="NoWrap" />
                        <TextBlock x:Name="txSerial"
                                   Margin="0"
                                   HorizontalAlignment="Left"
                                   VerticalAlignment="Center"
                                   FontStyle="Italic"
                                   Foreground="#FF0010FF"
                                   Text="{Binding SerialTrackingDisplay,
                                                  Mode=OneWay}"
                                   TextDecorations="Underline"
                                   TextWrapping="NoWrap" />
                    </StackPanel>
                    <StackPanel x:Name="stkCoupon"
                                Height="25"
                                HorizontalAlignment="Left"
                                Orientation="Horizontal">
                        <StackPanel.Visibility>
                            <Binding Mode="OneWay" Path="ProductModel.IsCoupon">
                                <Binding.Converter>
                                    <converter:BoolToVisibilityConverter FalseToVisibility="Collapsed" />
                                </Binding.Converter>
                            </Binding>
                        </StackPanel.Visibility>
                        <TextBlock x:Name="txtblTemplateCoupon"
                                   Margin="0"
                                   HorizontalAlignment="Left"
                                   VerticalAlignment="Center"
                                   FontStyle="Italic"
                                   Foreground="#FF0010FF"
                                   Text="Coupon code: "
                                   TextDecorations="Underline"
                                   TextWrapping="NoWrap" />
                        <TextBlock x:Name="txCoupon"
                                   Margin="0"
                                   HorizontalAlignment="Left"
                                   VerticalAlignment="Center"
                                   FontStyle="Italic"
                                   Foreground="#FF0010FF"
                                   Text="{Binding SerialTracking,
                                                  Mode=OneWay}"
                                   TextDecorations="Underline"
                                   TextWrapping="NoWrap" />
                    </StackPanel>
                </StackPanel>
            </Grid>
            <DataTemplate.Triggers>
                <DataTrigger Binding="{Binding SerialTracking}" Value="{x:Static sys:String.Empty}">
                    <Setter TargetName="stkSerial" Property="Visibility" Value="Collapsed" />
                </DataTrigger>
                <DataTrigger Binding="{Binding DiscountPercent}" Value="0">
                    <Setter TargetName="stkpDiscount" Property="Visibility" Value="Collapsed" />
                </DataTrigger>
            </DataTemplate.Triggers>
        </DataTemplate>
        <!--  EndRegion DataTemplate  -->

        <!--  Region "Style"  -->
        <Style x:Key="DataGridDetailRowStyle"
               BasedOn="{StaticResource {x:Type DataGridRow}}"
               TargetType="{x:Type DataGridRow}">
            <Setter Property="cpcBehavior:DataGridCellFocusHelper.CellFocus" Value="{Binding IsAllowChange, Mode=OneWay}" />
            <Setter Property="cpcBehavior:DataGridCellFocusHelper.ItemSource" Value="{Binding ., RelativeSource={RelativeSource Self}}" />
            <Setter Property="ContextMenu" Value="{StaticResource SaleOrderDetailContextMenu}" />
            <Setter Property="Template">
                <Setter.Value>
                    <ControlTemplate TargetType="{x:Type DataGridRow}">
                        <Border x:Name="DGR_Border"
                                Background="{TemplateBinding Background}"
                                BorderBrush="{TemplateBinding BorderBrush}"
                                BorderThickness="{TemplateBinding BorderThickness}">
                            <SelectiveScrollingGrid>
                                <SelectiveScrollingGrid.ColumnDefinitions>
                                    <ColumnDefinition Width="Auto" />
                                    <ColumnDefinition Width="*" />
                                </SelectiveScrollingGrid.ColumnDefinitions>
                                <SelectiveScrollingGrid.RowDefinitions>
                                    <RowDefinition Height="*" />
                                    <RowDefinition Height="Auto" />
                                </SelectiveScrollingGrid.RowDefinitions>
                                <DataGridCellsPresenter Grid.Column="1"
                                                        ItemsPanel="{TemplateBinding ItemsPanel}"
                                                        SnapsToDevicePixels="{TemplateBinding SnapsToDevicePixels}" />
                                <!--  Visibility="{TemplateBinding DetailsVisibility}">  -->
                                <DataGridDetailsPresenter Grid.Row="1"
                                                          Grid.Column="1"
                                                          SelectiveScrollingGrid.SelectiveScrollingOrientation="{Binding AreRowDetailsFrozen,
                                                                                                                         ConverterParameter={x:Static SelectiveScrollingOrientation.Vertical},
                                                                                                                         Converter={x:Static DataGrid.RowDetailsScrollingConverter},
                                                                                                                         RelativeSource={RelativeSource AncestorType={x:Type DataGrid}}}">
                                    <DataGridDetailsPresenter.Visibility>
                                        <Binding Mode="OneWay" Path="IsVisibleRowDetail">
                                            <Binding.Converter>
                                                <converter:BoolToVisibilityConverter FalseToVisibility="Collapsed" />
                                            </Binding.Converter>
                                        </Binding>
                                    </DataGridDetailsPresenter.Visibility>
                                </DataGridDetailsPresenter>
                                <DataGridRowHeader Grid.RowSpan="2"
                                                   SelectiveScrollingGrid.SelectiveScrollingOrientation="Vertical"
                                                   Style="{DynamicResource DataGridRowHeaderStyle}" />
                            </SelectiveScrollingGrid>
                        </Border>
                    </ControlTemplate>
                </Setter.Value>
            </Setter>
            <Style.Triggers>
                <!--  Set Color for parent item  -->
                <DataTrigger Binding="{Binding ItemType, Converter={StaticResource integerToBooleanConverter}, ConverterParameter=1}" Value="True">

                    <Setter Property="Background" Value="{DynamicResource DatagridRow_Group_Background}" />
                    <Setter Property="FontWeight" Value="Bold" />
                    <Setter Property="Foreground" Value="#FFFF0000" />
                </DataTrigger>
                <!--  Set Color for Children item  -->
                <DataTrigger Binding="{Binding ItemType, Converter={StaticResource integerToBooleanConverter}, ConverterParameter=2}" Value="True">
                    <Setter Property="Background" Value="{DynamicResource DatagridRow_Child_Background}" />

                </DataTrigger>
            </Style.Triggers>
        </Style>
        <Style x:Key="DataGridPriceCellStyle"
               BasedOn="{StaticResource DataGridCellDisableStyle}"
               TargetType="{x:Type DataGridCell}">
            <Setter Property="cpcBehavior:DataGridCellFocusHelper.CellFocus" Value="{Binding ProductModel.IsOpenItem, Mode=OneWay}" />
            <Setter Property="cpcBehavior:DataGridCellFocusHelper.ItemSource" Value="{Binding ., RelativeSource={RelativeSource Self}}" />
            <Style.Triggers>
                <Trigger Property="IsSelected" Value="True">
                    <Setter Property="BorderThickness" Value="0" />
                    <Setter Property="Foreground" Value="{DynamicResource DatagridCell_IsSelected_Foreground}" />
                </Trigger>
                <DataTrigger Binding="{Binding ProductModel.IsOpenItem}" Value="True">
                    <Setter Property="Foreground" Value="{DynamicResource ForegroundGreenBrush}" />
                    <Setter Property="FontWeight" Value="Bold" />
                </DataTrigger>
            </Style.Triggers>

        </Style>
        <Style x:Key="ComboBoxTextStyle" TargetType="{x:Type ComboBox}">
            <Setter Property="Focusable" Value="False" />
            <Setter Property="cpcBehavior:MoveFocusHelper.MoveFocus" Value="True" />
            <!--
                <Setter Property="FocusVisualStyle"
                Value="{StaticResource ComboBoxFocusVisual}" />
            -->
            <Setter Property="Foreground" Value="{DynamicResource {x:Static SystemColors.WindowTextBrushKey}}" />
            <Setter Property="Background" Value="{DynamicResource {x:Static SystemColors.WindowBrushKey}}" />
            <Setter Property="BorderThickness" Value="1" />
            <Setter Property="Padding" Value="1" />
            <Setter Property="ScrollViewer.HorizontalScrollBarVisibility" Value="Auto" />
            <Setter Property="ScrollViewer.VerticalScrollBarVisibility" Value="Auto" />
            <Setter Property="ScrollViewer.CanContentScroll" Value="true" />
            <Setter Property="ScrollViewer.PanningMode" Value="Both" />
            <Setter Property="Stylus.IsFlicksEnabled" Value="False" />
            <Setter Property="VerticalContentAlignment" Value="Center" />
            <Setter Property="Validation.ErrorTemplate" Value="{x:Null}" />
            <Setter Property="Template">
                <Setter.Value>
                    <ControlTemplate TargetType="{x:Type ComboBox}">
                        <Grid SnapsToDevicePixels="true">
                            <Border x:Name="Bd"
                                    Background="{TemplateBinding Background}"
                                    BorderBrush="{TemplateBinding BorderBrush}"
                                    BorderThickness="{TemplateBinding BorderThickness}">
                                <Grid Grid.IsSharedSizeScope="true">
                                    <Grid.ColumnDefinitions>
                                        <ColumnDefinition Width="1" />
                                        <ColumnDefinition />
                                        <ColumnDefinition Width="0" SharedSizeGroup="ComboBoxButton" />
                                    </Grid.ColumnDefinitions>
                                    <Border x:Name="SelectedItemBorder"
                                            Grid.ColumnSpan="2"
                                            Margin="{TemplateBinding Padding}" />
                                    <ContentPresenter Grid.Column="1"
                                                      Margin="{TemplateBinding Padding}"
                                                      HorizontalAlignment="{TemplateBinding HorizontalContentAlignment}"
                                                      VerticalAlignment="{TemplateBinding VerticalContentAlignment}"
                                                      Content="{TemplateBinding SelectionBoxItem}"
                                                      ContentStringFormat="{TemplateBinding SelectionBoxItemStringFormat}"
                                                      ContentTemplate="{TemplateBinding SelectionBoxItemTemplate}"
                                                      ContentTemplateSelector="{TemplateBinding ItemTemplateSelector}"
                                                      SnapsToDevicePixels="{TemplateBinding SnapsToDevicePixels}" />
                                    <ToggleButton Grid.ColumnSpan="3"
                                                  IsChecked="{Binding IsDropDownOpen,
                                                                      Mode=TwoWay,
                                                                      RelativeSource={RelativeSource TemplatedParent}}"
                                                  Style="{StaticResource ComboBoxTransparentButtonStyle}" />
                                </Grid>
                            </Border>
                        </Grid>
                        <ControlTemplate.Triggers>
                            <Trigger Property="HasItems" Value="false" />
                            <Trigger Property="IsEnabled" Value="false">
                                <Setter Property="Foreground" Value="{DynamicResource {x:Static SystemColors.GrayTextBrushKey}}" />
                                <Setter TargetName="Bd" Property="Background" Value="{DynamicResource {x:Static SystemColors.ControlBrushKey}}" />
                            </Trigger>
                            <Trigger Property="IsGrouping" Value="true">
                                <Setter Property="ScrollViewer.CanContentScroll" Value="false" />
                            </Trigger>
                            <Trigger Property="Validation.HasError" Value="True">
                                <Setter TargetName="Bd" Property="BorderBrush" Value="#FFFF0000" />
                            </Trigger>
                        </ControlTemplate.Triggers>
                    </ControlTemplate>
                </Setter.Value>
            </Setter>
            <Setter Property="FontSize" Value="11" />
            <Setter Property="BorderBrush" Value="{DynamicResource TextBoxCanlendarComboboxBorderBrush}" />
            <Style.Triggers>
                <Trigger Property="IsEditable" Value="true">
                    <Setter Property="IsTabStop" Value="false" />
                    <Setter Property="Padding" Value="0,1" />
                    <Setter Property="Template" Value="{StaticResource ComboBoxEditableTemplate}" />
                </Trigger>
            </Style.Triggers>
        </Style>
        <Style x:Key="ListViewItemColorStyle" TargetType="{x:Type ListViewItem}">
            <!--
                <Setter Property="VerticalContentAlignment"
                Value="Center" />
            -->
            <Style.Triggers>
                <DataTrigger Binding="{Binding IsOpenItem}" Value="True">
                    <Setter Property="Foreground" Value="{DynamicResource ForegroundGreenBrush}" />
                    <Setter Property="FontWeight" Value="Bold" />
                </DataTrigger>
            </Style.Triggers>
        </Style>
        <!--  EndRegion "Style"  -->
    </UserControl.Resources>
	 <UserControl.InputBindings>
<KeyBinding Command="{Binding HelpCommand}"
                    Gesture="F1" />
</UserControl.InputBindings>
    <Grid x:Name="GridLayout">
        <Rectangle x:Name="UserControl_Background_Image" Fill="{DynamicResource UserControl_Background_Image}" />
        <wpfControl:BusyIndicator IsBusy="{Binding IsBusy, Mode=OneWay}">

            <Grid x:Name="grdInvoice">
                <!--  Search Grid  -->
                <Grid x:Name="grdContentSearch"
                      d:IsHidden="True"
                      d:LayoutOverrides="GridBox">
                    <Grid.Visibility>
                        <Binding Mode="OneWay"
                                 Path="IsSearchMode"
                                 UpdateSourceTrigger="PropertyChanged">
                            <Binding.Converter>
                                <converter:BoolToVisibilityConverter FalseToVisibility="Collapsed" />
                            </Binding.Converter>
                        </Binding>
                    </Grid.Visibility>
                    <Grid.RowDefinitions>
                        <RowDefinition Height="85" />
                        <RowDefinition />
                    </Grid.RowDefinitions>
                    <GroupBox x:Name="gbSearch" Margin="10,10,10,0">
                        <GroupBox.Header>
                            <TextBlock x:Name="txtblSearch"
                                       Style="{DynamicResource GroupboxTextBlock}"
                                       Text="{DynamicResource C113}"
                                       TextWrapping="NoWrap" />
                        </GroupBox.Header>
                        <Grid x:Name="grdgbSearch" Margin="0,4,0,0">
                            <Grid x:Name="grdgbContentSearch">
                                <Grid.RowDefinitions>
                                    <RowDefinition Height="25" />
                                    <RowDefinition Height="25" />
                                    <RowDefinition Height="Auto" />
                                </Grid.RowDefinitions>
                                <wpfControl:WatermarkTextBox x:Name="txtKeyword"
                                                             Margin="10,2,0,2"
                                                             VerticalContentAlignment="Center"
                                                             BorderBrush="{DynamicResource TextBoxCanlendarComboboxBorderBrush}"
                                                             Padding="24,0,5,0"
                                                             Text="{Binding FilterText,
                                                                            Mode=TwoWay,
                                                                            UpdateSourceTrigger=PropertyChanged}"
                                                             TextWrapping="NoWrap"
                                                             Watermark="{DynamicResource C135}">
                                    <i:Interaction.Behaviors>
                                        <cpcBehavior:AutoFocusBehavior />
                                    </i:Interaction.Behaviors>
                                    <wpfControl:WatermarkTextBox.InputBindings>
                                        <KeyBinding Key="Enter"
                                                    Command="{Binding SearchCommand}"
                                                    CommandParameter="{Binding Text,
                                                                               ElementName=txtKeyword}" />
                                    </wpfControl:WatermarkTextBox.InputBindings>
                                </wpfControl:WatermarkTextBox>
                                <Rectangle x:Name="imgFind1"
                                           Width="20"
                                           Margin="13,3,0,3"
                                           HorizontalAlignment="Left"
                                           Fill="{DynamicResource Find}" />
                                <Button x:Name="btnAdvanceSearch"
                                        Grid.Row="1"
                                        Width="100"
                                        Height="20"
                                        Margin="10,0,0,0"
                                        HorizontalAlignment="Left"
                                        VerticalAlignment="Center"
                                        Command="{Binding SaleOrderAdvanceSearchCommand}"
                                        Content="{DynamicResource C104}"
                                        Style="{DynamicResource ButtonAdvanceSearch}"
                                        d:LayoutOverrides="HorizontalAlignment, Height, GridBox" />
                            </Grid>
                        </Grid>
                    </GroupBox>
                    <cpcDataGrid:DataGridControl x:Name="dtgrdSearch"
                                                 Grid.Row="3"
                                                 Margin="10,10.2,10,10"
                                                 VerticalAlignment="Stretch"
                                                 AutoGenerateColumns="False"
                                                 CanUserAddRows="False"
                                                 CanUserDeleteRows="False"
                                                 Command="{Binding LoadStepCommand}"
                                                 cpcBehavior:DoubleClickCommandBehavior.CanDoubleClickOnChild="False"
                                                 cpcBehavior:DoubleClickCommandBehavior.DoubleClickCommand="{Binding DoubleClickViewCommand}"
                                                 cpcBehavior:DoubleClickCommandBehavior.DoubleClickCommandParameter="{Binding SelectedItem,
                                                                                                                              ElementName=dtgrdSearch}"
                                                 DisplayItems="{Binding NumberOfDisplayItems}"
                                                 IsPaging="True"
                                                 IsReadOnly="True"
                                                 IsRollBackData="False"
                                                 ItemsSource="{Binding SaleOrderCollection}"
                                                 NumberOfItems="{Binding TotalSaleOrder}"
                                                 SelectionMode="Extended"
                                                 Style="{DynamicResource DatagridWithRowHeader}">
                        <cpcDataGrid:DataGridControl.ContextMenu>
                            <ContextMenu Tag="{Binding PlacementTarget, RelativeSource={RelativeSource Mode=Self}}">
                                <MenuItem Command="{Binding NewCommand}"
                                          Header="New Item"
                                          IsEnabled="{Binding AllowAddLayaway}">
                                    <MenuItem.Icon>
                                        <Rectangle Width="16"
                                                   Height="16"
                                                   Fill="{DynamicResource NewItem}"
                                                   Stretch="Fill" />
                                    </MenuItem.Icon>
                                </MenuItem>
                                <MenuItem Command="{Binding EditItemCommand}"
                                          CommandParameter="{Binding Tag,
                                                                     RelativeSource={RelativeSource AncestorType={x:Type ContextMenu},
                                                                                                    Mode=FindAncestor}}"
                                          Header="Edit Item">
                                    <MenuItem.Icon>
                                        <Rectangle Width="16"
                                                   Height="16"
                                                   Fill="{DynamicResource EditItem}"
                                                   Stretch="Fill" />
                                    </MenuItem.Icon>
                                </MenuItem>
                                <MenuItem Command="{Binding DuplicateItemCommand}"
                                          CommandParameter="{Binding Tag,
                                                                     RelativeSource={RelativeSource AncestorType={x:Type ContextMenu},
                                                                                                    Mode=FindAncestor}}"
                                          Header="Duplicate Item"
                                          IsEnabled="{Binding .,
                                                              ConverterParameter=SO100-05-02,
                                                              Converter={StaticResource permissionConverter}}">
                                    <MenuItem.Icon>
                                        <Rectangle Width="16"
                                                   Height="16"
                                                   Fill="{DynamicResource DuplicateItem}"
                                                   Stretch="Fill" />
                                    </MenuItem.Icon>
                                </MenuItem>
                            </ContextMenu>
                        </cpcDataGrid:DataGridControl.ContextMenu>
                        <cpcDataGrid:DataGridControl.Columns>

                            <DataGridTextColumn Width="90"
                                                MinWidth="80"
                                                Binding="{Binding SONumber,
                                                                  Mode=OneWay}">
                                <DataGridTextColumn.Header>
                                    <TextBlock Text="{DynamicResource SO_TextBlock_LayawayNum}" />
                                </DataGridTextColumn.Header>
                            </DataGridTextColumn>
                            <DataGridTextColumn Width="70"
                                                MinWidth="70"
                                                Binding="{Binding OrderDate,
                                                                  Mode=OneWay,
                                                                  StringFormat={x:Static local:Define.DateFormat}}"
                                                IsReadOnly="True">
                                <DataGridTextColumn.Header>
                                    <TextBlock Text="{DynamicResource C148}" />
                                </DataGridTextColumn.Header>
                            </DataGridTextColumn>
                            <DataGridTextColumn Width="80"
                                                MinWidth="80"
                                                Binding="{Binding OrderStatus,
                                                                  ConverterParameter=StatusSO,
                                                                  Converter={StaticResource comboxItemToTextConverter}}"
                                                IsReadOnly="True">
                                <DataGridTextColumn.Header>
                                    <TextBlock Text="{DynamicResource C151}" />
                                </DataGridTextColumn.Header>
                            </DataGridTextColumn>
                            <DataGridTextColumn Width="180"
                                                MinWidth="100"
                                                Binding="{Binding GuestModel.LegalName,
                                                                  Mode=OneWay}">
                                <DataGridTextColumn.Header>
                                    <TextBlock Text="{DynamicResource SO_TextBlock_Customer}" />
                                </DataGridTextColumn.Header>
                            </DataGridTextColumn>
                            <DataGridTemplateColumn Width="110">
                                <DataGridTemplateColumn.Header>
                                    <TextBlock Text="{DynamicResource C103}" />
                                </DataGridTemplateColumn.Header>
                                <DataGridTemplateColumn.CellTemplate>
                                    <DataTemplate>
                                        <TextBlock HorizontalAlignment="Right" Text="{Binding Total, ConverterCulture={x:Static local:Define.ConverterCulture}, Mode=OneWay, StringFormat={x:Static local:Define.CurrencyFormat}}" />
                                    </DataTemplate>
                                </DataGridTemplateColumn.CellTemplate>
                            </DataGridTemplateColumn>

                            <DataGridTemplateColumn Width="110"
                                                    MinWidth="100"
                                                    IsReadOnly="True">
                                <DataGridTemplateColumn.Header>
                                    <TextBlock Text="{DynamicResource SO_TextBlock_Deposit}" />
                                </DataGridTemplateColumn.Header>
                                <DataGridTemplateColumn.CellTemplate>
                                    <DataTemplate>
                                        <TextBlock HorizontalAlignment="Right" Text="{Binding Deposit, ConverterCulture={x:Static local:Define.ConverterCulture}, Mode=OneWay, StringFormat={x:Static local:Define.CurrencyFormat}}" />
                                    </DataTemplate>
                                </DataGridTemplateColumn.CellTemplate>
                            </DataGridTemplateColumn>

                            <DataGridTemplateColumn Width="110" IsReadOnly="True">
                                <DataGridTemplateColumn.Header>
                                    <TextBlock Text="{DynamicResource C107}" />
                                </DataGridTemplateColumn.Header>
                                <DataGridTemplateColumn.CellTemplate>
                                    <DataTemplate>
                                        <TextBlock HorizontalAlignment="Right" Text="{Binding Paid, ConverterCulture={x:Static local:Define.ConverterCulture}, Mode=OneWay, StringFormat={x:Static local:Define.CurrencyFormat}}" />
                                    </DataTemplate>
                                </DataGridTemplateColumn.CellTemplate>
                            </DataGridTemplateColumn>

                            <DataGridTemplateColumn Width="80" IsReadOnly="True">
                                <DataGridTemplateColumn.Header>
                                    <TextBlock Text="{DynamicResource SO_TextBlock_RefundFee}" />
                                </DataGridTemplateColumn.Header>
                                <DataGridTemplateColumn.CellTemplate>
                                    <DataTemplate>
                                        <TextBlock HorizontalAlignment="Right" Text="{Binding RefundedAmount, ConverterCulture={x:Static local:Define.ConverterCulture}, Mode=OneWay, StringFormat={x:Static local:Define.CurrencyFormat}}" />
                                    </DataTemplate>
                                </DataGridTemplateColumn.CellTemplate>
                            </DataGridTemplateColumn>

                            <DataGridTemplateColumn Width="110" MinWidth="100">
                                <DataGridTemplateColumn.Header>
                                    <TextBlock Text="{DynamicResource C108}" />
                                </DataGridTemplateColumn.Header>
                                <DataGridTemplateColumn.CellTemplate>
                                    <DataTemplate>
                                        <TextBlock HorizontalAlignment="Right" Text="{Binding Balance, ConverterCulture={x:Static local:Define.ConverterCulture}, Mode=OneWay, StringFormat={x:Static local:Define.CurrencyFormat}}" />
                                    </DataTemplate>
                                </DataGridTemplateColumn.CellTemplate>
                            </DataGridTemplateColumn>
                            <DataGridTextColumn Width="80"
                                                MinWidth="100"
                                                Binding="{Binding PriceSchemaId,
                                                                  ConverterParameter=PriceSchema,
                                                                  Converter={StaticResource comboxItemToTextConverter},
                                                                  Mode=OneWay}">
                                <DataGridTextColumn.Header>
                                    <TextBlock Text="{DynamicResource C157}" />
                                </DataGridTextColumn.Header>
                            </DataGridTextColumn>
                            <DataGridTemplateColumn Width="100" MinWidth="100">
                                <DataGridTemplateColumn.Header>
                                    <TextBlock Text="{DynamicResource SO_TextBlock_TaxLocation}" />
                                </DataGridTemplateColumn.Header>
                                <DataGridTemplateColumn.CellTemplate>
                                    <DataTemplate>
                                        <Grid>
                                            <TextBlock x:Name="tbTaxLocation"
                                                       Text="{Binding TaxLocationModel.Name}"
                                                       Visibility="Collapsed" />
                                            <TextBlock x:Name="tbTaxExemption" Text="{DynamicResource SO_TextBlock_TaxExemptionDisplay}" />
                                        </Grid>
                                        <DataTemplate.Triggers>
                                            <DataTrigger Binding="{Binding TaxExemption}" Value="{x:Static sys:String.Empty}">
                                                <Setter TargetName="tbTaxLocation" Property="Visibility" Value="Visible" />
                                                <Setter TargetName="tbTaxExemption" Property="Visibility" Value="Collapsed" />
                                            </DataTrigger>
                                        </DataTemplate.Triggers>
                                    </DataTemplate>
                                </DataGridTemplateColumn.CellTemplate>
                            </DataGridTemplateColumn>
                            <DataGridTemplateColumn Width="80">
                                <DataGridTemplateColumn.Header>
                                    <TextBlock Text="{DynamicResource C144}" />
                                </DataGridTemplateColumn.Header>
                                <DataGridTemplateColumn.CellTemplate>
                                    <DataTemplate>
                                        <Grid>
                                            <TextBlock x:Name="tbTaxCode"
                                                       Text="{Binding TaxCode}"
                                                       Visibility="Collapsed" />
                                            <TextBlock x:Name="tbTaxExemption" Text="{Binding TaxExemption}" />
                                        </Grid>
                                        <DataTemplate.Triggers>
                                            <DataTrigger Binding="{Binding TaxExemption}" Value="{x:Static sys:String.Empty}">
                                                <Setter TargetName="tbTaxCode" Property="Visibility" Value="Visible" />
                                                <Setter TargetName="tbTaxExemption" Property="Visibility" Value="Collapsed" />
                                            </DataTrigger>
                                        </DataTemplate.Triggers>
                                    </DataTemplate>
                                </DataGridTemplateColumn.CellTemplate>
                            </DataGridTemplateColumn>
                            <DataGridTextColumn Width="90"
                                                Binding="{Binding SOCard,
                                                                  Mode=OneWay}"
                                                IsReadOnly="True">
                                <DataGridTextColumn.Header>
                                    <TextBlock Text="{DynamicResource SO_TextBlock_ScanCode}" />
                                </DataGridTextColumn.Header>
                            </DataGridTextColumn>
                            <DataGridTemplateColumn Width="20" IsReadOnly="True">
                                <DataGridTemplateColumn.CellTemplate>
                                    <DataTemplate>
                                        <Rectangle Width="16"
                                                   Height="16"
                                                   Fill="{DynamicResource Delivery}">
                                            <Rectangle.Visibility>
                                                <Binding Mode="OneWay"
                                                         Path="IsReceived"
                                                         UpdateSourceTrigger="PropertyChanged">
                                                    <Binding.Converter>
                                                        <converter:BoolToVisibilityConverter />
                                                    </Binding.Converter>
                                                </Binding>
                                            </Rectangle.Visibility>
                                        </Rectangle>
                                    </DataTemplate>
                                </DataGridTemplateColumn.CellTemplate>
                            </DataGridTemplateColumn>
                        </cpcDataGrid:DataGridControl.Columns>
                    </cpcDataGrid:DataGridControl>
                </Grid>
                <Grid x:Name="grdContentSalesOrder1" Grid.Column="1">
                    <Grid.Visibility>
                        <Binding Mode="OneWay"
                                 Path="IsSearchMode"
                                 UpdateSourceTrigger="PropertyChanged">
                            <Binding.Converter>
                                <converter:BoolToVisibilityConverter FalseToVisibility="Visible" />
                            </Binding.Converter>
                        </Binding>
                    </Grid.Visibility>
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="22" />
                        <ColumnDefinition />
                    </Grid.ColumnDefinitions>
                    <Button x:Name="btnBarSearch"
                            BorderThickness="1"
                            Command="{Binding DoubleClickViewCommand}"
                            Style="{DynamicResource ButtonBarSearch}"
                            d:LayoutOverrides="GridBox">
                        <TextBlock x:Name="txtblShowSearchSalesOrder"
                                   HorizontalAlignment="Center"
                                   VerticalAlignment="Center"
                                   Style="{DynamicResource ButtonBarSearchTextBlock}"
                                   Text="Search"
                                   TextWrapping="NoWrap">
                            <TextBlock.LayoutTransform>
                                <TransformGroup>
                                    <ScaleTransform />
                                    <SkewTransform />
                                    <RotateTransform Angle="-90" />
                                    <TranslateTransform />
                                </TransformGroup>
                            </TextBlock.LayoutTransform>
                        </TextBlock>
                    </Button>
                    <Rectangle x:Name="grdSpliter"
                               Grid.Column="1"
                               Width="1"
                               HorizontalAlignment="Left"
                               Fill="{DynamicResource Spilter_Line_Background}" />
                    <Grid x:Name="grdSubSalesOrder" Grid.Column="2">
                        <Grid.RowDefinitions>
                            <RowDefinition Height="60" />
                            <RowDefinition Height="90" />
                            <RowDefinition />
                        </Grid.RowDefinitions>
                        <StackPanel x:Name="stkpBtn"
                                    Height="Auto"
                                    Margin="20,0,0,5"
                                    HorizontalAlignment="Left"
                                    VerticalAlignment="Bottom"
                                    Orientation="Horizontal">
                            <Button x:Name="btnNew"
                                    Width="40"
                                    Height="40"
                                    Margin="0"
                                    Command="{Binding NewCommand}"
                                    IsEnabled="{Binding AllowAddLayaway}"
                                    Style="{DynamicResource ButtonSystem}"
                                    Visibility="Visible">
                                <StackPanel x:Name="stkpBtnNew"
                                            HorizontalAlignment="Center"
                                            VerticalAlignment="Center">
                                    <Rectangle x:Name="imgNew"
                                               Width="30"
                                               Height="30"
                                               Fill="{DynamicResource New}" />
                                    <TextBlock x:Name="txtblNew"
                                               VerticalAlignment="Center"
                                               Style="{DynamicResource ButtonSystemTextBlock}"
                                               Text="New"
                                               TextWrapping="NoWrap"
                                               Visibility="Collapsed" />
                                </StackPanel>
                            </Button>
                            <Button x:Name="btnSave"
                                    Width="40"
                                    Height="40"
                                    Command="{Binding SaveCommand}"
                                    Style="{DynamicResource ButtonSystem}"
                                    Visibility="Visible">
                                <StackPanel x:Name="stkpBtnSave"
                                            HorizontalAlignment="Center"
                                            VerticalAlignment="Center"
                                            Orientation="Horizontal">
                                    <Rectangle x:Name="imgSave"
                                               Width="30"
                                               Height="30"
                                               Fill="{DynamicResource Save}" />
                                    <TextBlock x:Name="txtblSave"
                                               Margin="5,0,0,0"
                                               VerticalAlignment="Center"
                                               Style="{DynamicResource ButtonSystemTextBlock}"
                                               Text="Save"
                                               TextWrapping="NoWrap"
                                               Visibility="Collapsed" />
                                </StackPanel>
                            </Button>
                            <Button x:Name="btnPayment"
                                    Width="40"
                                    Height="40"
                                    Command="{Binding PaymentCommand}"
                                    IsEnabled="{Binding ., ConverterParameter=SO100-05-04, Converter={StaticResource permissionConverter}}"
                                    Style="{DynamicResource ButtonSystem}">
                                <StackPanel x:Name="stkpBtnPayment"
                                            HorizontalAlignment="Center"
                                            VerticalAlignment="Center"
                                            Orientation="Horizontal">
                                    <Rectangle x:Name="imgPayment"
                                               Width="30"
                                               Height="30"
                                               Fill="{DynamicResource Payment}" />
                                    <TextBlock x:Name="txtblPayment"
                                               Margin="5,0,0,0"
                                               VerticalAlignment="Center"
                                               Style="{DynamicResource ButtonSystemTextBlock}"
                                               Text="Payment"
                                               TextWrapping="NoWrap"
                                               Visibility="Collapsed" />
                                </StackPanel>
                            </Button>
                            <Button x:Name="btnVoid"
                                    Width="40"
                                    Height="40"
                                    Command="{Binding DeleteCommand}"
                                    IsEnabled="{Binding ., ConverterParameter=SO100-05-03, Converter={StaticResource permissionConverter}}"
                                    Style="{DynamicResource ButtonSystem}">
                                <StackPanel x:Name="stkpBtnVoid"
                                            HorizontalAlignment="Center"
                                            VerticalAlignment="Center"
                                            Orientation="Horizontal">
                                    <Rectangle x:Name="imgVoid"
                                               Width="30"
                                               Height="30"
                                               Fill="{DynamicResource Void}" />
                                    <TextBlock x:Name="txtblVoid"
                                               Margin="5,0,0,0"
                                               VerticalAlignment="Center"
                                               Style="{DynamicResource ButtonSystemTextBlock}"
                                               Text="Void"
                                               TextWrapping="NoWrap"
                                               Visibility="Collapsed" />
                                </StackPanel>
                            </Button>
                            <Button x:Name="btnShip"
                                    Width="40"
                                    Height="40"
                                    Command="{Binding ShipCommand}"
                                    IsEnabled="{Binding ., ConverterParameter=SO100-05-06, Converter={StaticResource permissionConverter}}"
                                    Style="{DynamicResource ButtonSystem}">
                                <StackPanel x:Name="stkpBtnShip"
                                            HorizontalAlignment="Center"
                                            VerticalAlignment="Center"
                                            Orientation="Horizontal">
                                    <Rectangle x:Name="imgShip"
                                               Width="30"
                                               Height="30"
                                               Fill="{DynamicResource Delivery}" />
                                    <TextBlock x:Name="txtblShip"
                                               Margin="5,0,0,0"
                                               VerticalAlignment="Center"
                                               Style="{DynamicResource ButtonSystemTextBlock}"
                                               Text="Ship"
                                               TextWrapping="NoWrap"
                                               Visibility="Collapsed" />
                                </StackPanel>
                            </Button>
                            <Button x:Name="btnPrint"
                                    Width="40"
                                    Height="40"
                                    Command="{Binding PrintCommand}"
                                    IsEnabled="{Binding ., ConverterParameter=SO100-05-05, Converter={StaticResource permissionConverter}}"
                                    Style="{DynamicResource ButtonSystem}">
                                <StackPanel x:Name="stkpBtnPrint"
                                            HorizontalAlignment="Center"
                                            VerticalAlignment="Center"
                                            Orientation="Horizontal">
                                    <Rectangle x:Name="imgPrint"
                                               Width="30"
                                               Height="30"
                                               Fill="{DynamicResource Print}" />
                                    <TextBlock x:Name="txtblPrint"
                                               Margin="5,0,0,0"
                                               VerticalAlignment="Center"
                                               Style="{DynamicResource ButtonSystemTextBlock}"
                                               Text="Print"
                                               TextWrapping="NoWrap"
                                               Visibility="Collapsed" />
                                </StackPanel>
                            </Button>
                        </StackPanel>
                        <TextBlock x:Name="txtblBindingWorkOrder"
                                   Margin="0,0,20,7"
                                   HorizontalAlignment="Right"
                                   VerticalAlignment="Bottom"
                                   FontFamily="Times New Roman"
                                   Style="{DynamicResource TextBlockTitleFormView}"
                                   Text="Layaway"
                                   TextWrapping="NoWrap"
                                   d:LayoutOverrides="HorizontalAlignment" />
                        <Rectangle x:Name="Line"
                                   Grid.Row="1"
                                   Height="1"
                                   Margin="2,0"
                                   HorizontalAlignment="Stretch"
                                   VerticalAlignment="Top"
                                   Fill="White" />
                        <Grid x:Name="grdSalesOrderInformation"
                              Grid.Row="1"
                              Width="747"
                              Height="80"
                              Margin="0,10,0,0"
                              HorizontalAlignment="Left"
                              VerticalAlignment="Top"
                              IsEnabled="{Binding IsAllowChangeOrder,
                                                  Mode=OneWay}">
                            <Grid.RowDefinitions>
                                <RowDefinition Height="25" />
                                <RowDefinition Height="25" />
                                <RowDefinition Height="25" />
                            </Grid.RowDefinitions>
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="76" />
                                <ColumnDefinition Width="173.5" />
                                <ColumnDefinition Width="*" />
                                <ColumnDefinition Width="85" />
                                <ColumnDefinition Width="173.5" />
                                <ColumnDefinition Width="*" />
                                <ColumnDefinition Width="51" />
                                <ColumnDefinition Width="120" />
                            </Grid.ColumnDefinitions>
                            <TextBlock x:Name="txtblCustomer"
                                       Margin="10,0,0,0"
                                       HorizontalAlignment="Left"
                                       VerticalAlignment="Center"
                                       Style="{DynamicResource TextBlockNormal}"
                                       Text="{DynamicResource SO_TextBlock_Customer}"
                                       TextWrapping="NoWrap"
                                       d:LayoutOverrides="GridBox" />
                            <cpcComboBox:ComboBoxControl Grid.Column="1"
                                                         Margin="0,2"
                                                         AddItemCommand="{Binding AddNewCustomerCommand}"
                                                         AutoHiddenItem="False"
                                                         cpcBehavior:AutoFocusBehavior.IsFocused="{Binding IsForceFocused,
                                                                                                           Mode=TwoWay,
                                                                                                           UpdateSourceTrigger=PropertyChanged}"
                                                         DisplayMemberPath="LegalName"
                                                         IsEnabled="{Binding SelectedSaleOrder.PaymentProcess,
                                                                             Converter={StaticResource reserseBoolConverter},
                                                                             Mode=OneWay}"
                                                         ItemsSource="{Binding CustomerCollection}"
                                                         SelectedItem="{Binding SelectedCustomer,
                                                                                Mode=TwoWay,
                                                                                UpdateSourceTrigger=PropertyChanged}"
                                                         SelectedValuePath="Resource"
                                                         Style="{DynamicResource ComboBoxControl_CheckedItemIsHiddenStyle}"
                                                         Tag="{Binding SelectedSaleOrder.CustomerResource,
                                                                       Mode=TwoWay,
                                                                       NotifyOnValidationError=True,
                                                                       UpdateSourceTrigger=PropertyChanged,
                                                                       ValidatesOnDataErrors=True}"
                                                         VisibilityAddItem="{Binding AllowAddCustomer,
                                                                                     Converter={StaticResource boolToVisibilityConverter},
                                                                                     Mode=OneWay}">
                                <i:Interaction.Behaviors>
                                    <cpcBehavior:AutoFocusBehavior />
                                </i:Interaction.Behaviors>
                            </cpcComboBox:ComboBoxControl>
                            <TextBlock x:Name="txtblBookingChanal"
                                       Grid.Column="3"
                                       Margin="0"
                                       HorizontalAlignment="Left"
                                       VerticalAlignment="Center"
                                       Style="{DynamicResource TextBlockNormal}"
                                       Text="{DynamicResource SO_TextBlock_BookingChannel}"
                                       TextWrapping="NoWrap" />
                            <ComboBox x:Name="cmbTransType"
                                      Grid.Column="4"
                                      Margin="0,2"
                                      VerticalAlignment="Stretch"
                                      DisplayMemberPath="Text"
                                      ItemsSource="{x:Static helper:Common.BookingChannel}"
                                      SelectedValue="{Binding SelectedSaleOrder.BookingChanel,
                                                              Mode=TwoWay,
                                                              UpdateSourceTrigger=PropertyChanged}"
                                      SelectedValuePath="ObjValue" />
                            <TextBlock x:Name="txtblSONo"
                                       Grid.Column="6"
                                       Margin="0"
                                       HorizontalAlignment="Left"
                                       VerticalAlignment="Center"
                                       Style="{DynamicResource TextBlockNormal}"
                                       Text="{DynamicResource SO_TextBlock_SONum}"
                                       TextWrapping="NoWrap" />
                            <TextBlock x:Name="txtblBindingSONo"
                                       Grid.Column="7"
                                       HorizontalAlignment="Left"
                                       VerticalAlignment="Center"
                                       Style="{DynamicResource TextBlockBasic}"
                                       Text="{Binding SelectedSaleOrder.SONumber,
                                                      Mode=TwoWay,
                                                      NotifyOnValidationError=True,
                                                      UpdateSourceTrigger=PropertyChanged,
                                                      ValidatesOnDataErrors=True}"
                                       TextWrapping="NoWrap"
                                       d:LayoutOverrides="HorizontalAlignment" />
                            <TextBlock x:Name="txtblBillAddress"
                                       Grid.Row="1"
                                       Margin="10,0,0,0"
                                       HorizontalAlignment="Left"
                                       VerticalAlignment="Center"
                                       Style="{DynamicResource TextBlockNormal}"
                                       Text="{DynamicResource SO_TextBlock_BillAddress}"
                                       TextWrapping="NoWrap"
                                       d:LayoutOverrides="Width" />
                            <TextBox x:Name="txtBillAddress"
                                     Grid.Row="1"
                                     Grid.RowSpan="2"
                                     Grid.Column="1"
                                     Margin="0,2"
                                     VerticalContentAlignment="Top"
                                     IsReadOnly="True"
                                     Padding="2"
                                     Text="{Binding SelectedSaleOrder.BillAddress,
                                                    Mode=OneWay,
                                                    NotifyOnValidationError=True,
                                                    UpdateSourceTrigger=PropertyChanged,
                                                    ValidatesOnDataErrors=True}"
                                     TextWrapping="Wrap"
                                     ToolTip="Click to view detail"
                                     VerticalScrollBarVisibility="Disabled">
                                <TextBox.InputBindings>
                                    <KeyBinding Key="Enter"
                                                Command="{Binding AddressPopupCommand}"
                                                CommandParameter="{Binding SelectedSaleOrder.BillAddressModel}" />
                                </TextBox.InputBindings>
                                <i:Interaction.Triggers>
                                    <i:EventTrigger EventName="PreviewMouseDown">
                                        <command:EventToCommand Command="{Binding AddressPopupCommand}" CommandParameter="{Binding SelectedSaleOrder.BillAddressModel}" />
                                    </i:EventTrigger>
                                </i:Interaction.Triggers>
                            </TextBox>
                            <TextBlock x:Name="txtblShipAddress"
                                       Grid.Row="1"
                                       Grid.Column="3"
                                       Margin="0"
                                       HorizontalAlignment="Left"
                                       VerticalAlignment="Center"
                                       Style="{DynamicResource TextBlockNormal}"
                                       Text="{DynamicResource C147}"
                                       TextWrapping="NoWrap" />
                            <TextBox x:Name="txtShipAddress"
                                     Grid.Row="1"
                                     Grid.RowSpan="2"
                                     Grid.Column="4"
                                     Margin="0,2"
                                     VerticalContentAlignment="Top"
                                     IsReadOnly="True"
                                     Padding="2"
                                     Text="{Binding SelectedSaleOrder.ShipAddress,
                                                    Mode=OneWay,
                                                    NotifyOnValidationError=True,
                                                    UpdateSourceTrigger=PropertyChanged,
                                                    ValidatesOnDataErrors=True}"
                                     TextWrapping="Wrap"
                                     ToolTip="Click to view detail"
                                     VerticalScrollBarVisibility="Disabled">
                                <TextBox.InputBindings>
                                    <KeyBinding Key="Enter"
                                                Command="{Binding AddressPopupCommand}"
                                                CommandParameter="{Binding SelectedSaleOrder.ShipAddressModel}" />
                                </TextBox.InputBindings>
                                <i:Interaction.Triggers>
                                    <i:EventTrigger EventName="PreviewMouseDown">
                                        <command:EventToCommand Command="{Binding AddressPopupCommand}" CommandParameter="{Binding SelectedSaleOrder.ShipAddressModel}" />
                                    </i:EventTrigger>
                                </i:Interaction.Triggers>
                            </TextBox>
                            <TextBlock x:Name="txtblSODate"
                                       Grid.Row="1"
                                       Grid.Column="6"
                                       Margin="0"
                                       HorizontalAlignment="Left"
                                       VerticalAlignment="Center"
                                       Style="{DynamicResource TextBlockNormal}"
                                       Text="{DynamicResource SO_TextBlock_SODate}"
                                       TextWrapping="NoWrap" />
                            <DatePicker x:Name="dtpOrderDate"
                                        Grid.Row="1"
                                        Grid.Column="7"
                                        Width="90"
                                        Margin="0,2"
                                        IsEnabled="False"
                                        HorizontalAlignment="Left"
                                        Background="White"
                                        SelectedDate="{Binding SelectedSaleOrder.OrderDate,
                                                               Mode=TwoWay,
                                                               UpdateSourceTrigger=PropertyChanged}" />
                            <TextBlock x:Name="txtblStatus"
                                       Grid.Row="2"
                                       Grid.Column="6"
                                       Margin="0"
                                       HorizontalAlignment="Left"
                                       VerticalAlignment="Center"
                                       Style="{DynamicResource TextBlockNormal}"
                                       Text="{DynamicResource C151}"
                                       TextWrapping="NoWrap" />
                            <ComboBox x:Name="cmbStatus"
                                      Grid.Row="2"
                                      Grid.Column="8"
                                      Width="90"
                                      Margin="0,2"
                                      HorizontalAlignment="Left"
                                      VerticalAlignment="Stretch"
                                      DisplayMemberPath="Text"
                                      IsEnabled="False"
                                      ItemsSource="{x:Static helper:Common.StatusSalesOrders}"
                                      SelectedIndex="0"
                                      SelectedValue="{Binding SelectedSaleOrder.OrderStatus,
                                                              Mode=TwoWay,
                                                              UpdateSourceTrigger=PropertyChanged}"
                                      SelectedValuePath="ObjValue"
                                      d:LayoutOverrides="GridBox" />
                        </Grid>
                        <Border x:Name="brdQuotation"
                                Grid.Row="2"
                                Margin="10"
                                Background="{DynamicResource TabControlBackground}"
                                BorderBrush="{DynamicResource TabControlBorder}"
                                BorderThickness="1">
                            <Grid x:Name="grdContentQuotation" Margin="4">
                                <Grid.RowDefinitions>
                                    <RowDefinition Height="30" />
                                    <RowDefinition Height="Auto" MinHeight="5" />
                                    <RowDefinition />
                                    <RowDefinition Height="188.926" />
                                </Grid.RowDefinitions>
                                <TextBlock x:Name="txtblSelectItem"
                                           Margin="10,0,0,0"
                                           HorizontalAlignment="Left"
                                           VerticalAlignment="Center"
                                           Style="{DynamicResource TextBlockNormal}"
                                           Text="{DynamicResource C100}"
                                           TextWrapping="NoWrap" />
                                <wpfControl:WatermarkTextBox x:Name="txtBarcodeProduct"
                                                             Grid.Column="1"
                                                             Width="350"
                                                             Height="21"
                                                             Margin="75,0,0,0"
                                                             HorizontalAlignment="Left"
                                                             VerticalAlignment="Center"
                                                             VerticalContentAlignment="Center"
                                                             BorderBrush="{DynamicResource TextBoxCanlendarComboboxBorderBrush}"
                                                             Text="{Binding BarcodeProduct,
                                                                                        Mode=TwoWay,
                                                                                        UpdateSourceTrigger=PropertyChanged}"
                                                             TextWrapping="NoWrap"
                                                             Watermark="Input barcode and press enter">
                                    <i:Interaction.Behaviors>
                                        <cpcBehavior:AutoFocusBehavior />
                                    </i:Interaction.Behaviors>
                                    <wpfControl:WatermarkTextBox.InputBindings>
                                        <KeyBinding Key="Enter"
                                                    Command="{Binding SearchProductCommand}" />
                                    </wpfControl:WatermarkTextBox.InputBindings>
                                </wpfControl:WatermarkTextBox>
                                <Button x:Name="btnAdvanceSearch1"
                                        Width="90"
                                        Height="21"
                                        Margin="429,0,0,0"
                                        HorizontalAlignment="Left"
                                        VerticalAlignment="Center"
                                        Command="{Binding SearchProductAdvanceCommand}"
                                        IsEnabled="{Binding IsAllowChangeOrder,
                                                            Mode=OneWay}"
                                        d:LayoutOverrides="Height">
                                    <TextBlock x:Name="txtblAdvanceSearch"
                                               VerticalAlignment="Center"
                                               Style="{DynamicResource ButtonTextBlock}"
                                               Text="{DynamicResource C104}"
                                               TextWrapping="NoWrap" />
                                </Button>
                                <cpcDataGrid:DataGridControl x:Name="dtgrdQuotationDetail"
                                                             Grid.Row="2"
                                                             Margin="10,0.2,10,5"
                                                             AutoGenerateColumns="False"
                                                             CanUserAddRows="False"
                                                             CanUserDeleteRows="False"
                                                             DeleteCommandParameter="{Binding SelectedItem,
                                                                                              ElementName=dtgrdQuotationDetail}"
                                                             DeleteItemCommand="{Binding DeleteSaleOrderDetailWithKeyCommand}"
                                                             HorizontalScrollBarVisibility="Hidden"
                                                             IsReadOnly="{Binding IsAllowChangeOrder,
                                                                                  Converter={StaticResource reserseBoolConverter},
                                                                                  Mode=OneWay}"
                                                             IsRollBackData="False"
                                                             ItemsSource="{Binding SelectedSaleOrder.SaleOrderDetailCollection,
                                                                                   Mode=TwoWay,
                                                                                   UpdateSourceTrigger=PropertyChanged}"
                                                             RowDetailsTemplate="{DynamicResource RowDetailDataTemplateOrderInvoice}"
                                                             RowDetailsVisibilityMode="Visible"
                                                             RowStyle="{StaticResource DataGridDetailRowStyle}"
                                                             SelectedItem="{Binding SelectedSaleOrderDetail,
                                                                                    Mode=TwoWay,
                                                                                    UpdateSourceTrigger=PropertyChanged}"
                                                             Style="{DynamicResource DatagridWithRowHeader}"
                                                             VisibilityNavigationBar="Collapsed">
                                    <cpcDataGrid:DataGridControl.Columns>
                                        <DataGridTextColumn Width="*"
                                                            Binding="{Binding ItemName}"
                                                            IsReadOnly="True">
                                            <DataGridTextColumn.Header>
                                                <TextBlock Text="{DynamicResource C115}" />
                                            </DataGridTextColumn.Header>
                                        </DataGridTextColumn>
                                        <DataGridTextColumn Width="80"
                                                            Binding="{Binding ItemAtribute,
                                                                              Mode=OneWay}"
                                                            IsReadOnly="True">
                                            <DataGridTextColumn.Header>
                                                <TextBlock Text="{DynamicResource C116}" />
                                            </DataGridTextColumn.Header>
                                        </DataGridTextColumn>
                                        <DataGridTextColumn Width="80"
                                                            Binding="{Binding ItemSize,
                                                                              Mode=OneWay}"
                                                            IsReadOnly="True">
                                            <DataGridTextColumn.Header>
                                                <TextBlock Text="{DynamicResource C117}" />
                                            </DataGridTextColumn.Header>
                                        </DataGridTextColumn>
                                        <DataGridTemplateColumn Width="75" CellStyle="{DynamicResource DataGridCellDisableStyle}">
                                            <DataGridTemplateColumn.Header>
                                                <TextBlock Text="{DynamicResource C120}" />
                                            </DataGridTemplateColumn.Header>
                                            <DataGridTemplateColumn.CellTemplate>
                                                <DataTemplate>
                                                    <TextBlock HorizontalAlignment="Right" Text="{Binding Qty, ConverterCulture={x:Static local:Define.ConverterCulture}, Mode=OneWay, StringFormat={x:Static local:Define.NumericFormat}, UpdateSourceTrigger=PropertyChanged}" />
                                                </DataTemplate>
                                            </DataGridTemplateColumn.CellTemplate>
                                            <DataGridTemplateColumn.CellEditingTemplate>
                                                <DataTemplate>
                                                    <cpcTextBox:TextBoxNumeric x:Name="txtQuantity"
                                                                               Width="60"
                                                                               ConverterCulture="{x:Static local:Define.ConverterCulture}"
                                                                               NumericStringFormat="{x:Static local:Define.NumericFormat}"
                                                                               Style="{DynamicResource TextBoxNumericInsideDataGridStyle}"
                                                                               Value="{Binding Qty,
                                                                                               Mode=TwoWay,
                                                                                               UpdateSourceTrigger=PropertyChanged}">
                                                        <i:Interaction.Triggers>
                                                            <i:EventTrigger EventName="LostFocus">
                                                                <command:EventToCommand Command="{Binding DataContext.QtyChangedCommand, RelativeSource={RelativeSource AncestorType={x:Type UserControl}, Mode=FindAncestor}}" CommandParameter="{Binding Qty}" />
                                                            </i:EventTrigger>
                                                        </i:Interaction.Triggers>
                                                    </cpcTextBox:TextBoxNumeric>
                                                </DataTemplate>
                                            </DataGridTemplateColumn.CellEditingTemplate>
                                        </DataGridTemplateColumn>
                                        <DataGridTemplateColumn Width="80" CellStyle="{StaticResource DataGridPriceCellStyle}">
                                            <DataGridTemplateColumn.Header>
                                                <TextBlock Text="{DynamicResource C119}" />
                                            </DataGridTemplateColumn.Header>
                                            <DataGridTemplateColumn.CellTemplate>
                                                <DataTemplate>
                                                    <TextBlock HorizontalAlignment="Right" Text="{Binding SalePrice, ConverterCulture={x:Static local:Define.ConverterCulture}, Mode=OneWay, StringFormat={x:Static local:Define.CurrencyFormat}}" />
                                                </DataTemplate>
                                            </DataGridTemplateColumn.CellTemplate>
                                            <DataGridTemplateColumn.CellEditingTemplate>
                                                <DataTemplate>
                                                    <cpcTextBox:TextBoxMoney x:Name="txtSalePrice"
                                                                             ConverterCulture="{x:Static local:Define.ConverterCulture}"
                                                                             CurrencyStringFormat="{x:Static local:Define.CurrencyFormat}"
                                                                             Style="{DynamicResource TextBoxMoneyInsideDataGridStyle}"
                                                                             Value="{Binding SalePrice,
                                                                                             Mode=TwoWay,
                                                                                             UpdateSourceTrigger=PropertyChanged}" />
                                                </DataTemplate>
                                            </DataGridTemplateColumn.CellEditingTemplate>
                                        </DataGridTemplateColumn>
                                        <DataGridTemplateColumn Width="75">
                                            <DataGridTemplateColumn.Header>
                                                <TextBlock Text="{DynamicResource C118}" />
                                            </DataGridTemplateColumn.Header>
                                            <DataGridTemplateColumn.CellTemplate>
                                                <DataTemplate>
                                                    <TextBlock Text="{Binding UnitName, Mode=OneWay}" />
                                                </DataTemplate>
                                            </DataGridTemplateColumn.CellTemplate>
                                            <DataGridTemplateColumn.CellEditingTemplate>
                                                <DataTemplate>
                                                    <ComboBox x:Name="cmbUnit"
                                                              DisplayMemberPath="Name"
                                                              ItemsSource="{Binding ProductUOMCollection,
                                                                                    Mode=OneWay}"
                                                              SelectedValue="{Binding UOMId,
                                                                                      Mode=TwoWay,
                                                                                      UpdateSourceTrigger=PropertyChanged}"
                                                              SelectedValuePath="UOMId"
                                                              Style="{DynamicResource ComboBoxInsideDataGridStyle}" />
                                                </DataTemplate>
                                            </DataGridTemplateColumn.CellEditingTemplate>
                                        </DataGridTemplateColumn>
                                        <DataGridTemplateColumn Width="75" IsReadOnly="True">
                                            <DataGridTemplateColumn.Header>
                                                <TextBlock Text="{DynamicResource C122}" />
                                            </DataGridTemplateColumn.Header>
                                            <DataGridTemplateColumn.CellTemplate>
                                                <DataTemplate>
                                                    <TextBlock x:Name="tblSubTotal"
                                                               HorizontalAlignment="Right"
                                                               Text="{Binding SubTotal,
                                                                              ConverterCulture={x:Static local:Define.ConverterCulture},
                                                                              Mode=OneWay,
                                                                              StringFormat={x:Static local:Define.CurrencyFormat}}" />
                                                </DataTemplate>
                                            </DataGridTemplateColumn.CellTemplate>
                                        </DataGridTemplateColumn>
                                        <DataGridTextColumn Width="75">
                                            <DataGridTextColumn.Header>
                                                <TextBlock Text="{DynamicResource C152}" />
                                            </DataGridTextColumn.Header>
                                            <DataGridTextColumn.ElementStyle>
                                                <Style TargetType="{x:Type TextBlock}">
                                                    <Setter Property="Text" Value="{Binding OnHandQty, ConverterCulture={x:Static local:Define.ConverterCulture}, Mode=OneWay, StringFormat={x:Static local:Define.DecimalFormat}}" />
                                                    <Style.Triggers>
                                                        <DataTrigger Binding="{Binding OnHandQty, Mode=OneWay}" Value="0">
                                                            <Setter Property="Text" Value="{Binding OnHandQty, ConverterCulture={x:Static local:Define.ConverterCulture}, Mode=OneWay, StringFormat={x:Static local:Define.IntegerFormat}}" />
                                                        </DataTrigger>
                                                    </Style.Triggers>
                                                </Style>
                                            </DataGridTextColumn.ElementStyle>
                                        </DataGridTextColumn>
                                    </cpcDataGrid:DataGridControl.Columns>
                                </cpcDataGrid:DataGridControl>
                                <Grid x:Name="grdQuotationSubTotal"
                                      Grid.Row="3"
                                      Margin="10,0"
                                      VerticalAlignment="Top"
                                      IsEnabled="{Binding IsAllowChangeOrder,
                                                          Mode=OneWay}">
                                    <Grid.ColumnDefinitions>
                                        <ColumnDefinition Width="58" />
                                        <ColumnDefinition Width="119" />
                                        <ColumnDefinition />
                                        <ColumnDefinition Width="61" />
                                        <ColumnDefinition Width="115" />
                                        <ColumnDefinition Width="88" />
                                        <ColumnDefinition Width="80" />
                                    </Grid.ColumnDefinitions>
                                    <Grid.RowDefinitions>
                                        <RowDefinition Height="25" />
                                        <RowDefinition Height="25" />
                                        <RowDefinition Height="25" />
                                        <RowDefinition Height="25" />
                                        <RowDefinition Height="9" />
                                        <RowDefinition Height="40" />
                                        <RowDefinition Height="40" />
                                    </Grid.RowDefinitions>
                                    <TextBlock x:Name="txtblQuotationSaleRep"
                                               Grid.Row="1"
                                               HorizontalAlignment="Left"
                                               VerticalAlignment="Center"
                                               Style="{DynamicResource TextBlockNormal}"
                                               Text="{DynamicResource SO_TextBlock_SalesRep}"
                                               TextWrapping="NoWrap"
                                               d:LayoutOverrides="HorizontalAlignment">
                                        <!--  when user choise booking channel is website, Sales rep will be collapsed  -->
                                        <TextBlock.Visibility>
                                            <Binding ElementName="cmbTransType"
                                                     Mode="OneWay"
                                                     Path="SelectedItem.Flag"
                                                     UpdateSourceTrigger="PropertyChanged">
                                                <Binding.Converter>
                                                    <converter:BoolToVisibilityConverter FalseToVisibility="Visible" />
                                                </Binding.Converter>
                                            </Binding>
                                        </TextBlock.Visibility>
                                    </TextBlock>
                                    <TextBox x:Name="txtblSaleRep"
                                             Grid.Row="1"
                                             Grid.Column="1"
                                             Width="120"
                                             Height="21"
                                             Margin="0"
                                             IsReadOnly="True"
                                             Text="{Binding SelectedSaleOrder.SaleRep,
                                                            Mode=OneWay}"
                                             TextWrapping="NoWrap"
                                             Visibility="{Binding Visibility,
                                                                  ElementName=txtblQuotationSaleRep}" />
                                    <TextBlock x:Name="txtblRemark1"
                                               Grid.Column="2"
                                               Margin="20,0,0,0"
                                               HorizontalAlignment="Left"
                                               VerticalAlignment="Center"
                                               Style="{DynamicResource TextBlockNormal}"
                                               Text="{DynamicResource C102}"
                                               TextWrapping="NoWrap" />
                                    <TextBox x:Name="txtRemark1"
                                             Grid.Row="1"
                                             Grid.RowSpan="3"
                                             Grid.Column="2"
                                             Margin="20,2"
                                             VerticalContentAlignment="Top"
                                             AcceptsReturn="True"
                                             HorizontalScrollBarVisibility="Auto"
                                             Padding="2"
                                             Text="{Binding SelectedSaleOrder.Remark,
                                                            Mode=TwoWay,
                                                            UpdateSourceTrigger=PropertyChanged}"
                                             TextWrapping="Wrap"
                                             VerticalScrollBarVisibility="Auto" />
                                    <StackPanel x:Name="stkpTaxLocationCode"
                                                Grid.Row="5"
                                                Grid.ColumnSpan="4"
                                                HorizontalAlignment="Left"
                                                VerticalAlignment="Top"
                                                Orientation="Horizontal"
                                                d:LayoutOverrides="GridBox">
                                        <StackPanel.Visibility>
                                            <Binding Mode="OneWay"
                                                     Path="SelectedSaleOrder.IsTaxExemption"
                                                     UpdateSourceTrigger="PropertyChanged">
                                                <Binding.Converter>
                                                    <converter:BoolToVisibilityConverter FalseToVisibility="Visible" />
                                                </Binding.Converter>
                                            </Binding>
                                        </StackPanel.Visibility>
                                        <TextBlock x:Name="txtblTaxLocation2"
                                                   HorizontalAlignment="Left"
                                                   FontWeight="Bold"
                                                   Foreground="#FFFEFF00"
                                                   Style="{DynamicResource TextBlockNormal}"
                                                   Text="{DynamicResource SO_TextBlock_TaxLocation}"
                                                   TextWrapping="NoWrap" />
                                        <TextBlock x:Name="txtblBindingTaxLocation"
                                                   Margin="10,0,0,0"
                                                   HorizontalAlignment="Left"
                                                   FontWeight="Bold"
                                                   Foreground="#FFFEFF00"
                                                   Style="{DynamicResource TextBlockNormal}"
                                                   Text="{Binding SelectedSaleOrder.TaxLocationModel.Name,
                                                                  Mode=OneWay}"
                                                   TextWrapping="NoWrap" />
                                        <TextBlock x:Name="txtblTaxCode"
                                                   Margin="10,0,0,0"
                                                   HorizontalAlignment="Left"
                                                   FontWeight="Bold"
                                                   Foreground="#FFFEFF00"
                                                   Style="{DynamicResource TextBlockNormal}"
                                                   Text="{DynamicResource C144}"
                                                   TextWrapping="NoWrap" />
                                        <TextBlock x:Name="txtblBindingTaxCode"
                                                   Margin="10,0,0,0"
                                                   HorizontalAlignment="Left"
                                                   FontWeight="Bold"
                                                   Foreground="#FFFEFF00"
                                                   Style="{DynamicResource TextBlockNormal}"
                                                   Text="{Binding SelectedSaleOrder.TaxCode,
                                                                  Mode=OneWay}"
                                                   TextWrapping="NoWrap" />
                                    </StackPanel>
                                    <StackPanel x:Name="stkpTaxExcemption"
                                                Grid.Row="5"
                                                Grid.ColumnSpan="4"
                                                HorizontalAlignment="Left"
                                                VerticalAlignment="Top"
                                                Orientation="Horizontal"
                                                d:LayoutOverrides="GridBox">
                                        <StackPanel.Visibility>
                                            <Binding Mode="OneWay" Path="SelectedSaleOrder.IsTaxExemption">
                                                <Binding.Converter>
                                                    <converter:BoolToVisibilityConverter FalseToVisibility="Collapsed" />
                                                </Binding.Converter>
                                            </Binding>
                                        </StackPanel.Visibility>
                                        <TextBlock x:Name="txtblTaxExcemption"
                                                   HorizontalAlignment="Left"
                                                   FontWeight="Bold"
                                                   Foreground="#FFFEFF00"
                                                   Style="{DynamicResource TextBlockNormal}"
                                                   Text="{DynamicResource SO_TextBlock_TaxExcemption}"
                                                   TextWrapping="NoWrap" />
                                        <TextBlock x:Name="txtblTaxExcemptionNo"
                                                   Margin="10,0,0,0"
                                                   HorizontalAlignment="Left"
                                                   FontWeight="Bold"
                                                   Foreground="#FFFEFF00"
                                                   Style="{DynamicResource TextBlockNormal}"
                                                   Text="{DynamicResource C144}"
                                                   TextWrapping="NoWrap" />
                                        <TextBlock x:Name="txtblBindingTaxExcemptionNo"
                                                   Margin="10,0,0,0"
                                                   HorizontalAlignment="Left"
                                                   FontWeight="Bold"
                                                   Foreground="#FFFEFF00"
                                                   Style="{DynamicResource TextBlockNormal}"
                                                   Text="{Binding SelectedSaleOrder.TaxExemption,
                                                                  Mode=OneWay}"
                                                   TextWrapping="NoWrap" />
                                    </StackPanel>
                                    <TextBlock x:Name="txtblPriceLevel2"
                                               Grid.Column="3"
                                               HorizontalAlignment="Left"
                                               VerticalAlignment="Center"
                                               Style="{DynamicResource TextBlockNormal}"
                                               Text="{DynamicResource C157}"
                                               TextWrapping="NoWrap" />
                                    <ComboBox x:Name="cmbPriceLevel2"
                                              Grid.Column="4"
                                              Margin="0,2"
                                              VerticalAlignment="Stretch"
                                              DisplayMemberPath="Text"
                                              ItemsSource="{x:Static helper:Common.MarkdownPriceLevels}"
                                              SelectedValue="{Binding SelectedSaleOrder.PriceSchemaId,
                                                                      Mode=TwoWay,
                                                                      UpdateSourceTrigger=PropertyChanged}"
                                              SelectedValuePath="ObjValue" />
                                    <TextBlock x:Name="txtblOrderTabSubTotal"
                                               Grid.Column="5"
                                               Margin="10,0,0,0"
                                               HorizontalAlignment="Left"
                                               VerticalAlignment="Center"
                                               Style="{DynamicResource TextBlockNormal}"
                                               Text="{DynamicResource C112}"
                                               TextWrapping="NoWrap" />
                                    <cpcTextBox:TextBoxMoney x:Name="txtOrderTabSubTotal"
                                                             Grid.RowSpan="1"
                                                             Grid.Column="6"
                                                             Height="21"
                                                             Margin="0,1,0,3"
                                                             HorizontalContentAlignment="Right"
                                                             ConverterCulture="{x:Static local:Define.ConverterCulture}"
                                                             CurrencyStringFormat="{x:Static local:Define.CurrencyFormat}"
                                                             IsReadOnly="True"
                                                             Padding="2,0,2,0"
                                                             TextWrapping="NoWrap"
                                                             Value="{Binding SelectedSaleOrder.SubTotal,
                                                                             Mode=OneWay}" />
                                    <TextBlock x:Name="txtblOrderTabTaxleft"
                                               Grid.Row="1"
                                               Grid.Column="3"
                                               HorizontalAlignment="Left"
                                               VerticalAlignment="Center"
                                               Style="{DynamicResource TextBlockNormal}"
                                               Text="{DynamicResource SO_TextBlock_Tax}"
                                               TextWrapping="NoWrap" />
                                    <cpcTextBox:TextBoxNumeric x:Name="txtOrderTabTaxPercent"
                                                               Grid.Row="1"
                                                               Grid.RowSpan="1"
                                                               Grid.Column="4"
                                                               Width="35"
                                                               Margin="0,2"
                                                               HorizontalAlignment="Left"
                                                               ConverterCulture="{x:Static local:Define.ConverterCulture}"
                                                               IsReadOnly="True"
                                                               NumericStringFormat="{}{0:N0}"
                                                               Padding="2,0,2,0"
                                                               TextWrapping="NoWrap"
                                                               Value="{Binding SelectedSaleOrder.TaxPercent,
                                                                               Mode=TwoWay,
                                                                               UpdateSourceTrigger=PropertyChanged}" />
                                    <TextBlock x:Name="txtblOrderTabTaxPercent"
                                               Grid.Row="1"
                                               Grid.Column="4"
                                               Margin="40,0,0,0"
                                               HorizontalAlignment="Left"
                                               VerticalAlignment="Center"
                                               Style="{DynamicResource TextBlockNormal}"
                                               Text="%"
                                               TextWrapping="NoWrap" />
                                    <TextBlock x:Name="txtblOrderTabTaxAmount"
                                               Grid.Row="1"
                                               Grid.Column="5"
                                               Margin="10,0,0,0"
                                               HorizontalAlignment="Left"
                                               VerticalAlignment="Center"
                                               Style="{DynamicResource TextBlockNormal}"
                                               Text="{DynamicResource SO_TextBlock_Tax}"
                                               TextWrapping="NoWrap" />
                                    <cpcTextBox:TextBoxMoney x:Name="txtOrderTabTax"
                                                             Grid.Row="1"
                                                             Grid.RowSpan="1"
                                                             Grid.Column="6"
                                                             Margin="0,2"
                                                             HorizontalContentAlignment="Right"
                                                             ConverterCulture="{x:Static local:Define.ConverterCulture}"
                                                             CurrencyStringFormat="{x:Static local:Define.CurrencyFormat}"
                                                             IsReadOnly="True"
                                                             Padding="2,0,2,0"
                                                             TextWrapping="NoWrap"
                                                             Value="{Binding SelectedSaleOrder.TaxAmount,
                                                                             Mode=TwoWay,
                                                                             UpdateSourceTrigger=PropertyChanged}" />

                                    <Button x:Name="btnPaid"
                                            Grid.Row="2"
                                            Grid.Column="5"
                                            Width="75"
                                            Height="21"
                                            Margin="6,0,0,0"
                                            HorizontalAlignment="Left"
                                            VerticalAlignment="Center"
                                            Command="{Binding OpenServiceFeeDetailCommand}"
                                            Style="{DynamicResource ButtonSystem}"
                                            Visibility="Visible">
                                        <StackPanel x:Name="stkpBtnPaid"
                                                    HorizontalAlignment="Center"
                                                    VerticalAlignment="Center"
                                                    Orientation="Horizontal">
                                            <TextBlock x:Name="txtblServiceFee"
                                                       Grid.Row="2"
                                                       Grid.Column="5"
                                                       Margin="0,0,5,0"
                                                       VerticalAlignment="Center"
                                                       Style="{DynamicResource TextBlockNormal}"
                                                       Text="{DynamicResource SO_TextBlock_ServiceFee}"
                                                       TextWrapping="NoWrap" />
                                            <ed:RegularPolygon Width="5.5"
                                                               Height="6"
                                                               Margin="0,2,0,0"
                                                               VerticalAlignment="Center"
                                                               Fill="White"
                                                               InnerRadius="1"
                                                               PointCount="3"
                                                               RenderTransformOrigin="0.5,0.5"
                                                               Stretch="Fill">
                                                <ed:RegularPolygon.RenderTransform>
                                                    <TransformGroup>
                                                        <ScaleTransform />
                                                        <SkewTransform />
                                                        <RotateTransform Angle="180" />
                                                        <TranslateTransform />
                                                    </TransformGroup>
                                                </ed:RegularPolygon.RenderTransform>
                                            </ed:RegularPolygon>
                                        </StackPanel>
                                    </Button>

                                    <cpcTextBox:TextBoxMoney x:Name="txtBindingOpenACFee"
                                                             Grid.Row="2"
                                                             Grid.RowSpan="1"
                                                             Grid.Column="6"
                                                             Margin="0,2"
                                                             HorizontalContentAlignment="Right"
                                                             ConverterCulture="{x:Static local:Define.ConverterCulture}"
                                                             CurrencyStringFormat="{x:Static local:Define.CurrencyFormat}"
                                                             Padding="2,0,2,0"
                                                             TextWrapping="NoWrap"
                                                             Value="{Binding SelectedSaleOrder.LTotalFee,
                                                                             Mode=TwoWay,
                                                                             UpdateSourceTrigger=PropertyChanged}" />
                                    <!--  Style="{DynamicResource TextBlockNormal}"  -->
                                    <TextBlock x:Name="txtblOrderTabShippingHandling"
                                               Grid.Row="3"
                                               Grid.Column="5"
                                               Margin="10,0,0,0"
                                               HorizontalAlignment="Left"
                                               VerticalAlignment="Center"
                                               Style="{DynamicResource TextBlockNormal}"
                                               Text="{DynamicResource SO_TextBlock_Shipping}"
                                               TextWrapping="NoWrap" />
                                    <cpcTextBox:TextBoxMoney x:Name="txtOrderTabShippingHandling"
                                                             Grid.Row="3"
                                                             Grid.RowSpan="1"
                                                             Grid.Column="6"
                                                             Margin="0,2"
                                                             HorizontalContentAlignment="Right"
                                                             ConverterCulture="{x:Static local:Define.ConverterCulture}"
                                                             CurrencyStringFormat="{x:Static local:Define.CurrencyFormat}"
                                                             Padding="2,0,2,0"
                                                             TextWrapping="NoWrap"
                                                             Value="{Binding SelectedSaleOrder.Shipping,
                                                                             Mode=TwoWay,
                                                                             UpdateSourceTrigger=PropertyChanged}" />
                                    <Rectangle x:Name="LineOrderTotal"
                                               Grid.Row="4"
                                               Grid.Column="3"
                                               Grid.ColumnSpan="4"
                                               Height="1"
                                               Margin="2,0,0,0"
                                               HorizontalAlignment="Stretch"
                                               VerticalAlignment="Center"
                                               Fill="White" />
                                    <TextBlock x:Name="txtblOrderTotal"
                                               Grid.Row="5"
                                               Grid.Column="4"
                                               HorizontalAlignment="Right"
                                               VerticalAlignment="Center"
                                               Style="{DynamicResource TextBlockNormal}"
                                               Text="{DynamicResource C103}"
                                               TextWrapping="NoWrap" />
                                    <TextBox x:Name="txtOrderTotal"
                                             Grid.Row="5"
                                             Grid.Column="5"
                                             Grid.ColumnSpan="2"
                                             Margin="10,2,0,7"
                                             HorizontalContentAlignment="Right"
                                             IsReadOnly="True"
                                             Padding="2,0,2,0"
                                             Style="{DynamicResource TextBoxTotalStyle}"
                                             Text="{Binding SelectedSaleOrder.Total,
                                                            ConverterCulture={x:Static local:Define.ConverterCulture},
                                                            Mode=OneWay,
                                                            StringFormat={x:Static local:Define.CurrencyFormat}}"
                                             TextWrapping="NoWrap" />

                                    <TextBlock x:Name="txtblBalance"
                                               Grid.Row="7"
                                               Grid.Column="4"
                                               HorizontalAlignment="Right"
                                               VerticalAlignment="Center"
                                               Style="{DynamicResource TextBlockNormal}"
                                               Text="{DynamicResource C108}"
                                               TextWrapping="NoWrap"
                                               d:LayoutOverrides="GridBox" />
                                    <TextBox x:Name="txtBalance"
                                             Grid.Row="6"
                                             Grid.Column="5"
                                             Grid.ColumnSpan="2"
                                             Margin="10,2,0,7"
                                             HorizontalContentAlignment="Right"
                                             Foreground="Red"
                                             IsReadOnly="True"
                                             Padding="2,0,2,0"
                                             Style="{DynamicResource TextBoxTotalStyle}"
                                             Text="{Binding SelectedSaleOrder.Balance,
                                                            ConverterCulture={x:Static local:Define.ConverterCulture},
                                                            Mode=OneWay,
                                                            StringFormat={x:Static local:Define.CurrencyFormat}}"
                                             TextWrapping="NoWrap"
                                             d:LayoutOverrides="GridBox" />
                                </Grid>
                            </Grid>
                        </Border>
                    </Grid>
                </Grid>
            </Grid>
        </wpfControl:BusyIndicator>

    </Grid>
</UserControl>