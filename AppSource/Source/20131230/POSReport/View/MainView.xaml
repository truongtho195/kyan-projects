<r:RibbonWindow xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
                xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
                xmlns:r="clr-namespace:Microsoft.Windows.Controls.Ribbon;assembly=RibbonControlsLibrary"
                xmlns:cr="clr-namespace:SAPBusinessObjects.WPF.Viewer;assembly=SAPBusinessObjects.WPF.Viewer"
                xmlns:Custom="http://schemas.microsoft.com/winfx/2006/xaml/presentation/shell"
                xmlns:function="clr-namespace:CPC.POSReport.Function"
                xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
                xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006" x:Name="Window"
                mc:Ignorable="d"
                x:Class="CPC.POSReport.View.Main"
                xmlns:obj="clr-namespace:CPC.POSReport.Model"
                xmlns:ExtendWPFToolKit="clr-namespace:Xceed.Wpf.Toolkit;assembly=WPFToolkit.Extended"
                xmlns:Microsoft_Windows_Controls_Ribbon_Primitives="clr-namespace:Microsoft.Windows.Controls.Ribbon.Primitives;assembly=RibbonControlsLibrary"
                xmlns:i="clr-namespace:System.Windows.Interactivity;assembly=System.Windows.Interactivity"
                xmlns:System="clr-namespace:System;assembly=mscorlib"
                xmlns:themeClassic="clr-namespace:Microsoft.Windows.Themes;assembly=PresentationFramework.Classic"
                xmlns:behaviour="clr-namespace:CPC.POSReport.Function.Behaviour"
                Icon="/Report.ico"
                WindowState="Maximized"
                Title="POS Report"
                Height="768"
                Width="1024"
                Background="{DynamicResource UserControlBackground}">
    <r:RibbonWindow.Resources>
        <ContextMenu x:Key="contextTreeView"
                     Tag="{Binding PlacementTarget.Tag,RelativeSource={RelativeSource Mode=Self}}"
                     StaysOpen="true">
            <MenuItem Header="New (Alt + N)"
                      Command="{Binding Tag.NewReportCommand, RelativeSource={RelativeSource AncestorType=ContextMenu, Mode=FindAncestor}}">
                <MenuItem.Icon>
                    <Rectangle Fill="{DynamicResource NewItem}"
                               Height="13"
                               Width="13" />
                </MenuItem.Icon>
            </MenuItem>
            <MenuItem Header="Edit (Alt + E)"
                      Command="{Binding Tag.EditReportCommand, RelativeSource={RelativeSource AncestorType=ContextMenu, Mode=FindAncestor}}">
                <MenuItem.Icon>
                    <Rectangle Fill="{DynamicResource Edit}"
                               Height="13"
                               Width="13" />
                </MenuItem.Icon>
            </MenuItem>
            <MenuItem Header="Change group (Alt + G)"
                      Command="{Binding Tag.ChangeGroupReportCommand, RelativeSource={RelativeSource AncestorType=ContextMenu, Mode=FindAncestor}}">
                <MenuItem.Icon>
                    <Rectangle Fill="{DynamicResource ChangeGroup}"
                               Height="13"
                               Width="13" />
                </MenuItem.Icon>
            </MenuItem>
            <MenuItem Header="Delete  (Alt + D)"
                      Command="{Binding Tag.DeleteReportCommand, RelativeSource={RelativeSource AncestorType=ContextMenu, Mode=FindAncestor}}">
                <MenuItem.Icon>
                    <Rectangle Fill="{DynamicResource Delete}"
                               Height="13"
                               Width="13" />
                </MenuItem.Icon>
            </MenuItem>
            <MenuItem Header="Preview (Alt + V)"
                      Command="{Binding Tag.PreviewReportCommand, RelativeSource={RelativeSource AncestorType=ContextMenu,Mode=FindAncestor}}">
                <MenuItem.Icon>
                    <Rectangle Fill="{DynamicResource Preview}"
                               Height="13"
                               Width="13" />
                </MenuItem.Icon>
            </MenuItem>
            <MenuItem Header="Print (Alt + P)"
                      Command="{Binding Tag.PrintDirectCommand, RelativeSource={RelativeSource AncestorType=ContextMenu, Mode=FindAncestor}}">
                <MenuItem.Icon>
                    <Rectangle Fill="{DynamicResource Print}"
                               Height="13"
                               Width="13" />
                </MenuItem.Icon>
            </MenuItem>
            <MenuItem Header="Assign authorize report (Alt + A)"
                      Command="{Binding Tag.ReportPermissionCommand, RelativeSource={RelativeSource AncestorType=ContextMenu, Mode=FindAncestor}}">
                <MenuItem.Icon>
                    <Rectangle Fill="{DynamicResource AssignAuthorizeReport}"
                               Height="13"
                               Width="13" />
                </MenuItem.Icon>
            </MenuItem>

            <MenuItem Header="No show report (Alt + H)"
                      Command="{Binding Tag.NoShowReportCommand, RelativeSource={RelativeSource AncestorType=ContextMenu, Mode=FindAncestor}}">
                <MenuItem.Icon>
                    <Rectangle Fill="{DynamicResource NoShowReport}"
                               Height="13"
                               Width="13" />
                </MenuItem.Icon>
            </MenuItem>
        </ContextMenu>
        <function:ImageConverter x:Key="imageConverter"></function:ImageConverter>
        <function:RibbonImageConverter x:Key="ribbonImageConverter" />
        <Style x:Key="CellMidleRight">
            <Setter Property="FrameworkElement.Margin"
                    Value="0,0,5,0"></Setter>
            <Setter Property="FrameworkElement.HorizontalAlignment"
                    Value="Right"></Setter>
            <Setter Property="FrameworkElement.VerticalAlignment"
                    Value="Center"></Setter>
        </Style>
        <Style x:Key="CellMidleLeft">
            <Setter Property="FrameworkElement.Margin"
                    Value="5,0,0,0"></Setter>
            <Setter Property="FrameworkElement.VerticalAlignment"
                    Value="Center"></Setter>
        </Style>
        <Style x:Key="CellMidleCenter">
            <Setter Property="FrameworkElement.VerticalAlignment"
                    Value="Center"></Setter>
            <Setter Property="FrameworkElement.HorizontalAlignment"
                    Value="Center" ></Setter>
        </Style>
        <!--region RibbonGroup-->
        <Style TargetType="{x:Type r:RibbonGroup}">
            <Setter Property="Margin"
                    Value="1" />
            <Setter Property="Padding"
                    Value="3,0" />
            <Setter Property="FocusVisualStyle"
                    Value="{x:Null}" />
            <Setter Property="Template">
                <Setter.Value>
                    <ControlTemplate TargetType="{x:Type r:RibbonGroup}">
                        <Border x:Name="GroupBorder"
                                Margin="1,2,0,0"
                                Background="{TemplateBinding Background}"
                                BorderBrush="{DynamicResource RibbonGroupBorder}">
                            <Grid x:Name="MainGrid">
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="*" />
                                    <ColumnDefinition Width="Auto" />
                                </Grid.ColumnDefinitions>
                                <Grid.RowDefinitions>
                                    <RowDefinition Height="*" />
                                    <RowDefinition Height="Auto" />
                                    <RowDefinition Height="Auto"
                                                   MinHeight="16" />
                                </Grid.RowDefinitions>
                                <Border x:Name="PART_HotBackground"
                                        Grid.RowSpan="3"
                                        Background="{TemplateBinding MouseOverBackground}"
                                        BorderBrush="{TemplateBinding MouseOverBorderBrush}"
                                        BorderThickness="1"
                                        CornerRadius="2"
                                        Opacity="0"
                                        SnapsToDevicePixels="True" />
                                <Border x:Name="SeparatorBorder"
                                        Grid.RowSpan="3"
                                        Grid.Column="0"
                                        VerticalAlignment="Stretch"
                                        Background="{TemplateBinding Background}"
                                        BorderBrush="{TemplateBinding BorderBrush}"
                                        BorderThickness="{TemplateBinding BorderThickness}"
                                        CornerRadius="3"
                                        SnapsToDevicePixels="True" />
                                <Border Margin="2,1,2,0"
                                        Padding="3,0">
                                    <Grid>
                                        <ItemsPresenter x:Name="ItemsPresenter" />
                                        <ContentControl x:Name="TemplateContentControl"
                                                        Focusable="False"
                                                        Visibility="Collapsed" />
                                    </Grid>
                                </Border>
                                <Border x:Name="LabelSeparatorBorder"
                                        Grid.Row="1"
                                        Height="1"
                                        Margin="5,1,5,-1" />
                                <Border Grid.Row="2"
                                        Margin="1,0,1,1"
                                        Background="{DynamicResource RibbonGroupBackground}"
                                        CornerRadius="0,0,3,3">
                                    <ContentPresenter x:Name="PART_Header"
                                                      MaxHeight="16"
                                                      Margin="2,0"
                                                      HorizontalAlignment="Center"
                                                      VerticalAlignment="Center"
                                                      Content="{TemplateBinding Header}"
                                                      ContentSource="Header"
                                                      ContentStringFormat="{TemplateBinding HeaderStringFormat}"
                                                      ContentTemplate="{TemplateBinding HeaderTemplate}"
                                                      TextElement.Foreground="{DynamicResource RibbonGroupForeground}" />
                                </Border>
                            </Grid>
                        </Border>
                        <ControlTemplate.Triggers>
                            <Trigger Property="IsEnabled"
                                     Value="False">
                                <Setter TargetName="MainGrid"
                                        Property="TextElement.Foreground"
                                        Value="#FF9E9E9E" />
                            </Trigger>
                            <EventTrigger RoutedEvent="Mouse.MouseEnter">
                                <BeginStoryboard>
                                    <Storyboard>
                                        <DoubleAnimation Duration="0:0:0.2"
                                                         Storyboard.TargetName="PART_HotBackground"
                                                         Storyboard.TargetProperty="Opacity"
                                                         To="1" />
                                    </Storyboard>
                                </BeginStoryboard>
                            </EventTrigger>
                            <EventTrigger RoutedEvent="Mouse.MouseLeave">
                                <BeginStoryboard>
                                    <Storyboard>
                                        <DoubleAnimation Duration="0:0:0.4"
                                                         Storyboard.TargetName="PART_HotBackground"
                                                         Storyboard.TargetProperty="Opacity"
                                                         To="0" />
                                    </Storyboard>
                                </BeginStoryboard>
                            </EventTrigger>
                            <MultiDataTrigger>
                                <MultiDataTrigger.Conditions>
                                    <Condition Binding="{Binding IsEnabled, RelativeSource={RelativeSource Self}}"
                                               Value="False" />
                                    <Condition Binding="{Binding HighContrast}"
                                               Value="True" />
                                </MultiDataTrigger.Conditions>
                                <Setter TargetName="MainGrid"
                                        Property="TextElement.Foreground"
                                        Value="{DynamicResource {x:Static SystemColors.GrayTextBrushKey}}" />
                            </MultiDataTrigger>
                        </ControlTemplate.Triggers>
                    </ControlTemplate>
                </Setter.Value>
            </Setter>
            <Setter Property="Background"
                    Value="Transparent" />
            <Setter Property="BorderBrush"
                    Value="{Binding Ribbon.BorderBrush, RelativeSource={RelativeSource Self}}" />
            <Setter Property="MouseOverBackground">
                <Setter.Value>
                    <LinearGradientBrush StartPoint="0,0.5"
                                         EndPoint="1,0.5">
                        <GradientStop Offset="0"
                                      Color="#01FFFFFF" />
                        <GradientStop Offset="0.5"
                                      Color="#80FFFFFF" />
                        <GradientStop Offset="1"
                                      Color="#01FFFFFF" />
                    </LinearGradientBrush>
                </Setter.Value>
            </Setter>
            <Setter Property="MouseOverBorderBrush"
                    Value="Transparent" />
            <Setter Property="ToolTipService.InitialShowDelay"
                    Value="900" />
            <Setter Property="ToolTipService.ShowDuration"
                    Value="20000" />
            <Setter Property="ToolTipService.BetweenShowDelay"
                    Value="0" />
            <Style.Triggers>
                <Trigger Property="IsCollapsed"
                         Value="True">
                    <Setter Property="Template">
                        <Setter.Value>
                            <ControlTemplate TargetType="{x:Type r:RibbonGroup}">
                                <Grid x:Name="MainGrid">
                                    <r:RibbonToggleButton x:Name="PART_ToggleButton"
                                                          Margin="0,3,0,0"
                                                          Background="{TemplateBinding Background}"
                                                          Content="{TemplateBinding Header}"
                                                          ContentStringFormat="{TemplateBinding HeaderStringFormat}"
                                                          ContentTemplate="{TemplateBinding HeaderTemplate}"
                                                          IsChecked="{Binding IsDropDownOpen, Mode=TwoWay, RelativeSource={RelativeSource TemplatedParent}}"
                                                          LargeImageSource="{TemplateBinding LargeImageSource}"                                                          
                                                          SmallImageSource="{TemplateBinding SmallImageSource}">
                                        <r:RibbonToggleButton.Style>
                                            <Style TargetType="{x:Type r:RibbonToggleButton}">
                                                <Setter Property="Focusable"
                                                        Value="True" />
                                                <Setter Property="BorderBrush"
                                                        Value="{Binding BorderBrush, RelativeSource={RelativeSource FindAncestor, AncestorLevel=1, AncestorType={x:Type r:RibbonGroup}}}" />
                                                <Setter Property="MouseOverBorderBrush"
                                                        Value="Transparent" />
                                                <Setter Property="MouseOverBackground"
                                                        Value="#40FFFFFF" />
                                                <Setter Property="FocusedBackground"
                                                        Value="{Binding Ribbon.FocusedBackground, RelativeSource={RelativeSource Self}}" />
                                                <Setter Property="FocusedBorderBrush"
                                                        Value="Transparent" />
                                                <Setter Property="CheckedBackground"
                                                        Value="Transparent" />
                                                <Setter Property="CheckedBorderBrush"
                                                        Value="Transparent" />
                                                <Setter Property="ClickMode"
                                                        Value="Press" />
                                                <Setter Property="Template">
                                                    <Setter.Value>
                                                        <ControlTemplate TargetType="{x:Type r:RibbonToggleButton}">
                                                            <ControlTemplate.Resources>
                                                                <DataTemplate x:Key="{DataTemplateKey DataType={x:Type System:String}}"
                                                                              DataType="{x:Type System:String}">
                                                                    <r:RibbonTwoLineText Margin="2,4,2,0"
                                                                                         VerticalAlignment="Top"
                                                                                         LineHeight="13"
                                                                                         LineStackingStrategy="BlockLineHeight"
                                                                                         PathFill="{TemplateBinding TextElement.Foreground}"
                                                                                         r:RibbonTwoLineText.HasTwoLines="{TemplateBinding r:RibbonTwoLineText.HasTwoLines}"
                                                                                         r:RibbonTwoLineText.PathData="{TemplateBinding r:RibbonTwoLineText.PathData}"
                                                                                         Text="{Binding}"
                                                                                         TextAlignment="Center" />
                                                                </DataTemplate>
                                                            </ControlTemplate.Resources>
                                                            <Grid x:Name="MainGrid"
                                                                  SnapsToDevicePixels="True">
                                                                <Border x:Name="ButtonInnerBorder"
                                                                        Margin="1"
                                                                        BorderBrush="#FFEAF1FB"
                                                                        BorderThickness="1"
                                                                        CornerRadius="2" />
                                                                <Border x:Name="ButtonOuterBorder"
                                                                        Background="{TemplateBinding Background}"
                                                                        BorderBrush="{TemplateBinding BorderBrush}"
                                                                        BorderThickness="1"
                                                                        CornerRadius="2" />
                                                                <Border x:Name="PART_HotBackground"
                                                                        Background="{TemplateBinding MouseOverBackground}"
                                                                        BorderBrush="{TemplateBinding MouseOverBorderBrush}"
                                                                        BorderThickness="1"
                                                                        CornerRadius="2"
                                                                        Opacity="0" />
                                                                <Grid Margin="2">
                                                                    <Grid.RowDefinitions>
                                                                        <RowDefinition Height="Auto" />
                                                                        <RowDefinition />
                                                                    </Grid.RowDefinitions>
                                                                    <Border x:Name="ImageOuterBorder"
                                                                            Grid.Row="0">
                                                                        <Border x:Name="ImageMiddleBorder"
                                                                                Width="32"
                                                                                Height="32"
                                                                                Margin="3"
                                                                                HorizontalAlignment="Center"
                                                                                VerticalAlignment="Top"
                                                                                BorderBrush="#FFAEBECF"
                                                                                BorderThickness="0"
                                                                                CornerRadius="3">
                                                                            <Grid>
                                                                                <Border x:Name="ImageInnerBorder"
                                                                                        BorderBrush="#FFFCFCFC"
                                                                                        BorderThickness="0"
                                                                                        CornerRadius="3" />
                                                                                <Image x:Name="GroupImage"
                                                                                       Width="32"
                                                                                       Height="32"
                                                                                       HorizontalAlignment="Center"
                                                                                       VerticalAlignment="Center"
                                                                                       RenderOptions.BitmapScalingMode="NearestNeighbor"
                                                                                       Source="{TemplateBinding LargeImageSource}" />
                                                                            </Grid>
                                                                        </Border>
                                                                    </Border>
                                                                    <Border x:Name="LabelBorder"
                                                                            Grid.Row="1"
                                                                            Grid.RowSpan="2">
                                                                        <Border.Background>
                                                                            <RadialGradientBrush Center="0.5,0.5"
                                                                                                 GradientOrigin="0.5,1"
                                                                                                 RadiusX="1"
                                                                                                 RadiusY="0.5">
                                                                                <GradientStop Offset="0"
                                                                                              Color="#30FFFFFF" />
                                                                                <GradientStop Offset="1"
                                                                                              Color="#08808080" />
                                                                            </RadialGradientBrush>
                                                                        </Border.Background>
                                                                        <ContentPresenter Content="{TemplateBinding Content}"
                                                                                          ContentStringFormat="{TemplateBinding ContentStringFormat}"
                                                                                          ContentTemplate="{TemplateBinding ContentTemplate}"
                                                                                          r:RibbonTwoLineText.HasTwoLines="True"
                                                                                          r:RibbonTwoLineText.PathData="M0,0L2.5,3 5,0z" />
                                                                    </Border>
                                                                </Grid>
                                                            </Grid>
                                                            <ControlTemplate.Triggers>
                                                                <Trigger Property="LargeImageSource"
                                                                         Value="{x:Null}">
                                                                    <Setter TargetName="GroupImage"
                                                                            Property="Source"
                                                                            Value="{Binding SmallImageSource, RelativeSource={RelativeSource TemplatedParent}}" />
                                                                    <Setter TargetName="GroupImage"
                                                                            Property="Width"
                                                                            Value="16" />
                                                                    <Setter TargetName="GroupImage"
                                                                            Property="Height"
                                                                            Value="16" />
                                                                    <Setter TargetName="ImageMiddleBorder"
                                                                            Property="BorderThickness"
                                                                            Value="1" />
                                                                    <Setter TargetName="ImageMiddleBorder"
                                                                            Property="Background">
                                                                        <Setter.Value>
                                                                            <LinearGradientBrush StartPoint="0,0"
                                                                                                 EndPoint="0,1">
                                                                                <GradientStop Offset="0"
                                                                                              Color="#88FFFFFF" />
                                                                                <GradientStop Offset="1"
                                                                                              Color="#88DBE7F4" />
                                                                            </LinearGradientBrush>
                                                                        </Setter.Value>
                                                                    </Setter>
                                                                    <Setter TargetName="ImageInnerBorder"
                                                                            Property="BorderThickness"
                                                                            Value="1" />
                                                                    <Setter TargetName="ImageInnerBorder"
                                                                            Property="Background"
                                                                            Value="#50FFFFFF" />
                                                                </Trigger>
                                                                <Trigger Property="IsEnabled"
                                                                         Value="False">
                                                                    <Setter TargetName="GroupImage"
                                                                            Property="Opacity"
                                                                            Value="0.5" />
                                                                    <Setter TargetName="MainGrid"
                                                                            Property="TextElement.Foreground"
                                                                            Value="#FF9E9E9E" />
                                                                </Trigger>
                                                                <DataTrigger Binding="{Binding HighContrast}"
                                                                             Value="True">
                                                                    <Setter TargetName="MainGrid"
                                                                            Property="TextElement.Foreground"
                                                                            Value="{DynamicResource {x:Static SystemColors.MenuTextBrushKey}}" />
                                                                    <Setter TargetName="ImageMiddleBorder"
                                                                            Property="Background"
                                                                            Value="Transparent" />
                                                                    <Setter TargetName="ImageMiddleBorder"
                                                                            Property="BorderThickness"
                                                                            Value="0" />
                                                                    <Setter TargetName="ImageInnerBorder"
                                                                            Property="Background"
                                                                            Value="Transparent" />
                                                                    <Setter TargetName="ImageInnerBorder"
                                                                            Property="BorderThickness"
                                                                            Value="0" />
                                                                    <Setter TargetName="PART_HotBackground"
                                                                            Property="Background"
                                                                            Value="Transparent" />
                                                                    <Setter TargetName="LabelBorder"
                                                                            Property="Background"
                                                                            Value="Transparent" />
                                                                    <Setter TargetName="ButtonOuterBorder"
                                                                            Property="Background"
                                                                            Value="Transparent" />
                                                                    <Setter TargetName="ButtonOuterBorder"
                                                                            Property="BorderBrush"
                                                                            Value="{DynamicResource {x:Static SystemColors.ControlDarkBrushKey}}" />
                                                                    <Setter TargetName="ButtonOuterBorder"
                                                                            Property="CornerRadius"
                                                                            Value="0" />
                                                                    <Setter TargetName="ButtonInnerBorder"
                                                                            Property="CornerRadius"
                                                                            Value="0" />
                                                                    <Setter TargetName="ButtonInnerBorder"
                                                                            Property="BorderThickness"
                                                                            Value="0,1,0,0" />
                                                                </DataTrigger>
                                                                <MultiDataTrigger>
                                                                    <MultiDataTrigger.Conditions>
                                                                        <Condition Binding="{Binding HighContrast}"
                                                                                   Value="True" />
                                                                        <Condition Binding="{Binding IsMouseOver, RelativeSource={RelativeSource Self}}"
                                                                                   Value="True" />
                                                                    </MultiDataTrigger.Conditions>
                                                                    <Setter TargetName="ButtonInnerBorder"
                                                                            Property="Background"
                                                                            Value="{DynamicResource {x:Static SystemColors.HighlightBrushKey}}" />
                                                                    <Setter TargetName="ButtonInnerBorder"
                                                                            Property="BorderThickness"
                                                                            Value="1" />
                                                                    <Setter TargetName="MainGrid"
                                                                            Property="TextElement.Foreground"
                                                                            Value="{DynamicResource {x:Static SystemColors.HighlightTextBrushKey}}" />
                                                                </MultiDataTrigger>
                                                                <MultiDataTrigger>
                                                                    <MultiDataTrigger.Conditions>
                                                                        <Condition Binding="{Binding HighContrast}"
                                                                                   Value="True" />
                                                                        <Condition Binding="{Binding IsKeyboardFocused, RelativeSource={RelativeSource Self}}"
                                                                                   Value="True" />
                                                                    </MultiDataTrigger.Conditions>
                                                                    <Setter TargetName="ButtonInnerBorder"
                                                                            Property="Background"
                                                                            Value="{DynamicResource {x:Static SystemColors.HighlightBrushKey}}" />
                                                                    <Setter TargetName="ButtonInnerBorder"
                                                                            Property="BorderThickness"
                                                                            Value="1" />
                                                                    <Setter TargetName="MainGrid"
                                                                            Property="TextElement.Foreground"
                                                                            Value="{DynamicResource {x:Static SystemColors.HighlightTextBrushKey}}" />
                                                                </MultiDataTrigger>
                                                                <MultiDataTrigger>
                                                                    <MultiDataTrigger.Conditions>
                                                                        <Condition Binding="{Binding HighContrast}"
                                                                                   Value="True" />
                                                                        <Condition Binding="{Binding IsChecked, RelativeSource={RelativeSource Self}}"
                                                                                   Value="True" />
                                                                    </MultiDataTrigger.Conditions>
                                                                    <Setter TargetName="ButtonOuterBorder"
                                                                            Property="Background"
                                                                            Value="{DynamicResource {x:Static SystemColors.HighlightBrushKey}}" />
                                                                    <Setter TargetName="MainGrid"
                                                                            Property="TextElement.Foreground"
                                                                            Value="{DynamicResource {x:Static SystemColors.HighlightTextBrushKey}}" />
                                                                </MultiDataTrigger>
                                                                <MultiTrigger>
                                                                    <MultiTrigger.Conditions>
                                                                        <Condition Property="IsMouseOver"
                                                                                   Value="True" />
                                                                        <Condition Property="IsChecked"
                                                                                   Value="False" />
                                                                    </MultiTrigger.Conditions>
                                                                    <Setter TargetName="PART_HotBackground"
                                                                            Property="Opacity"
                                                                            Value="1" />
                                                                </MultiTrigger>
                                                                <MultiDataTrigger>
                                                                    <MultiDataTrigger.Conditions>
                                                                        <Condition Binding="{Binding HighContrast}"
                                                                                   Value="False" />
                                                                        <Condition Binding="{Binding IsKeyboardFocused, RelativeSource={RelativeSource Self}}"
                                                                                   Value="True" />
                                                                        <Condition Binding="{Binding IsChecked, RelativeSource={RelativeSource Self}}"
                                                                                   Value="False" />
                                                                    </MultiDataTrigger.Conditions>
                                                                    <Setter TargetName="PART_HotBackground"
                                                                            Property="Opacity"
                                                                            Value="1" />
                                                                    <Setter TargetName="PART_HotBackground"
                                                                            Property="Background"
                                                                            Value="{Binding FocusedBackground, RelativeSource={RelativeSource TemplatedParent}}" />
                                                                    <Setter TargetName="PART_HotBackground"
                                                                            Property="BorderBrush"
                                                                            Value="{Binding FocusedBorderBrush, RelativeSource={RelativeSource TemplatedParent}}" />
                                                                </MultiDataTrigger>
                                                                <MultiDataTrigger>
                                                                    <MultiDataTrigger.Conditions>
                                                                        <Condition Binding="{Binding HighContrast}"
                                                                                   Value="False" />
                                                                        <Condition Binding="{Binding IsChecked, RelativeSource={RelativeSource Self}}"
                                                                                   Value="True" />
                                                                    </MultiDataTrigger.Conditions>
                                                                    <Setter TargetName="PART_HotBackground"
                                                                            Property="Opacity"
                                                                            Value="1" />
                                                                    <Setter TargetName="PART_HotBackground"
                                                                            Property="Background"
                                                                            Value="{Binding CheckedBackground, RelativeSource={RelativeSource TemplatedParent}}" />
                                                                    <Setter TargetName="PART_HotBackground"
                                                                            Property="BorderBrush"
                                                                            Value="{Binding CheckedBorderBrush, RelativeSource={RelativeSource TemplatedParent}}" />
                                                                    <Setter TargetName="ImageOuterBorder"
                                                                            Property="Background"
                                                                            Value="#20BBBBBB" />
                                                                    <Setter TargetName="LabelBorder"
                                                                            Property="Background">
                                                                        <Setter.Value>
                                                                            <RadialGradientBrush Center="0.5,1"
                                                                                                 GradientOrigin="0.5,0.95"
                                                                                                 RadiusX="0.9"
                                                                                                 RadiusY="0.5">
                                                                                <GradientStop Offset="0"
                                                                                              Color="#AAFFFFFF" />
                                                                                <GradientStop Offset="1"
                                                                                              Color="#40BBBBBB" />
                                                                            </RadialGradientBrush>
                                                                        </Setter.Value>
                                                                    </Setter>
                                                                </MultiDataTrigger>
                                                                <MultiDataTrigger>
                                                                    <MultiDataTrigger.Conditions>
                                                                        <Condition Binding="{Binding IsEnabled, RelativeSource={RelativeSource Self}}"
                                                                                   Value="False" />
                                                                        <Condition Binding="{Binding HighContrast}"
                                                                                   Value="True" />
                                                                    </MultiDataTrigger.Conditions>
                                                                    <Setter TargetName="MainGrid"
                                                                            Property="TextElement.Foreground"
                                                                            Value="{DynamicResource {x:Static SystemColors.GrayTextBrushKey}}" />
                                                                </MultiDataTrigger>
                                                            </ControlTemplate.Triggers>
                                                        </ControlTemplate>
                                                    </Setter.Value>
                                                </Setter>
                                            </Style>
                                        </r:RibbonToggleButton.Style>
                                    </r:RibbonToggleButton>
                                    <Popup x:Name="PART_Popup"
                                           AllowsTransparency="True"
                                           Focusable="False"
                                           IsOpen="{Binding IsDropDownOpen, RelativeSource={RelativeSource TemplatedParent}}"
                                           Placement="Bottom"
                                           PopupAnimation="{DynamicResource {x:Static SystemParameters.MenuPopupAnimationKey}}">
                                        <themeClassic:SystemDropShadowChrome x:Name="Shdw"
                                                                             CornerRadius="2"
                                                                             Focusable="True"
                                                                             FocusVisualStyle="{x:Null}"
                                                                             KeyTipService.IsKeyTipScope="True"
                                                                             RenderOptions.ClearTypeHint="Enabled"
                                                                             SnapsToDevicePixels="True"
                                                                             Color="Transparent">
                                            <Grid x:Name="PopupGrid"
                                                  Height="{TemplateBinding ActualHeight}"
                                                  Margin="0,1.5,0,0">
                                                <Grid.RowDefinitions>
                                                    <RowDefinition Height="*" />
                                                    <RowDefinition Height="Auto"
                                                                   MinHeight="16" />
                                                </Grid.RowDefinitions>
                                                <Border x:Name="PopupBorder"
                                                        Grid.RowSpan="2"
                                                        Background="{TemplateBinding Background}"
                                                        BorderBrush="{Binding Ribbon.BorderBrush, RelativeSource={RelativeSource TemplatedParent}}"
                                                        BorderThickness="1" />
                                                <Border x:Name="PART_HotBackground"
                                                        Grid.RowSpan="2"
                                                        Background="{TemplateBinding MouseOverBackground}"
                                                        BorderBrush="{TemplateBinding MouseOverBorderBrush}"
                                                        BorderThickness="1"
                                                        CornerRadius="2"
                                                        Opacity="0"
                                                        SnapsToDevicePixels="True" />
                                                <Border x:Name="PART_RibbonControlsHostBorder"
                                                        Margin="2,3.5,2,0"
                                                        Padding="3,0">
                                                    <Grid>
                                                        <ItemsPresenter x:Name="ItemsPresenter"
                                                                        Grid.IsSharedSizeScope="True"
                                                                        KeyboardNavigation.DirectionalNavigation="Cycle"
                                                                        KeyboardNavigation.TabNavigation="Cycle"
                                                                        SnapsToDevicePixels="True" />
                                                        <ContentControl x:Name="TemplateContentControl"
                                                                        Focusable="False"
                                                                        Visibility="Collapsed" />
                                                    </Grid>
                                                </Border>
                                                <Grid Grid.Row="1"
                                                      Margin="2,0,2,1">
                                                    <ContentPresenter x:Name="PART_Header"
                                                                      MaxHeight="15"
                                                                      Margin="2,0"
                                                                      HorizontalAlignment="Center"
                                                                      VerticalAlignment="Center"
                                                                      Content="{TemplateBinding Header}"
                                                                      ContentSource="Header"
                                                                      ContentStringFormat="{TemplateBinding HeaderStringFormat}"
                                                                      ContentTemplate="{TemplateBinding HeaderTemplate}"
                                                                      TextElement.Foreground="#FF9E9E9E" />
                                                </Grid>
                                            </Grid>
                                        </themeClassic:SystemDropShadowChrome>
                                    </Popup>
                                </Grid>
                                <ControlTemplate.Triggers>
                                    <MultiDataTrigger>
                                        <MultiDataTrigger.Conditions>
                                            <Condition Binding="{Binding HighContrast}"
                                                       Value="False" />
                                            <Condition Binding="{Binding Background, RelativeSource={RelativeSource Self}}"
                                                       Value="Transparent" />
                                        </MultiDataTrigger.Conditions>
                                        <Setter TargetName="PopupBorder"
                                                Property="Background"
                                                Value="{Binding Ribbon.Background, RelativeSource={RelativeSource TemplatedParent}}" />
                                    </MultiDataTrigger>
                                    <Trigger Property="IsEnabled"
                                             Value="False">
                                        <Setter TargetName="MainGrid"
                                                Property="TextElement.Foreground"
                                                Value="#FF9E9E9E" />
                                    </Trigger>
                                    <DataTrigger Binding="{Binding HighContrast}"
                                                 Value="True">
                                        <Setter TargetName="MainGrid"
                                                Property="TextElement.Foreground"
                                                Value="{DynamicResource {x:Static SystemColors.MenuTextBrushKey}}" />
                                        <Setter TargetName="PART_HotBackground"
                                                Property="Background"
                                                Value="Transparent" />
                                        <Setter TargetName="PART_Popup"
                                                Property="PopupAnimation"
                                                Value="None" />
                                        <Setter TargetName="PopupBorder"
                                                Property="BorderBrush"
                                                Value="{DynamicResource {x:Static SystemColors.ControlDarkBrushKey}}" />
                                        <Setter TargetName="PopupBorder"
                                                Property="Background"
                                                Value="{DynamicResource {x:Static SystemColors.ControlBrushKey}}" />
                                        <Setter TargetName="Shdw"
                                                Property="CornerRadius"
                                                Value="0" />
                                    </DataTrigger>
                                    <Trigger SourceName="PART_Popup"
                                             Property="HasDropShadow"
                                             Value="True">
                                        <Setter TargetName="Shdw"
                                                Property="Margin"
                                                Value="0,0,5,5" />
                                        <Setter TargetName="Shdw"
                                                Property="Color"
                                                Value="#71000000" />
                                    </Trigger>
                                    <Trigger SourceName="PART_Popup"
                                             Property="IsOpen"
                                             Value="False">
                                        <Setter TargetName="PART_Popup"
                                                Property="PopupAnimation"
                                                Value="None" />
                                    </Trigger>
                                    <EventTrigger RoutedEvent="Mouse.MouseEnter"
                                                  SourceName="Shdw">
                                        <BeginStoryboard>
                                            <Storyboard>
                                                <DoubleAnimation Duration="0:0:0.2"
                                                                 Storyboard.TargetName="PART_HotBackground"
                                                                 Storyboard.TargetProperty="Opacity"
                                                                 To="1" />
                                            </Storyboard>
                                        </BeginStoryboard>
                                    </EventTrigger>
                                    <EventTrigger RoutedEvent="Mouse.MouseLeave"
                                                  SourceName="Shdw">
                                        <BeginStoryboard>
                                            <Storyboard>
                                                <DoubleAnimation Duration="0:0:0.4"
                                                                 Storyboard.TargetName="PART_HotBackground"
                                                                 Storyboard.TargetProperty="Opacity"
                                                                 To="0" />
                                            </Storyboard>
                                        </BeginStoryboard>
                                    </EventTrigger>
                                    <Trigger Property="IsInQuickAccessToolBar"
                                             Value="True">
                                        <Setter TargetName="PopupGrid"
                                                Property="Height"
                                                Value="91" />
                                        <Setter TargetName="PART_ToggleButton"
                                                Property="Style">
                                            <Setter.Value>
                                                <Style TargetType="{x:Type r:RibbonToggleButton}">
                                                    <Setter Property="RenderOptions.BitmapScalingMode"
                                                            Value="NearestNeighbor" />
                                                    <Setter Property="Focusable"
                                                            Value="True" />
                                                    <Setter Property="BorderBrush"
                                                            Value="#80808080" />
                                                    <Setter Property="Background"
                                                            Value="#AAFFFFFF" />
                                                    <Setter Property="MouseOverBorderBrush"
                                                            Value="Transparent" />
                                                    <Setter Property="MouseOverBackground">
                                                        <Setter.Value>
                                                            <LinearGradientBrush StartPoint="0,0"
                                                                                 EndPoint="1,1">
                                                                <GradientStop Offset="0"
                                                                              Color="#80FFFFFF" />
                                                                <GradientStop Offset="0.5"
                                                                              Color="#60FFFFFF" />
                                                                <GradientStop Offset="1"
                                                                              Color="#40808080" />
                                                            </LinearGradientBrush>
                                                        </Setter.Value>
                                                    </Setter>
                                                    <Setter Property="FocusedBackground"
                                                            Value="{Binding Ribbon.FocusedBackground, RelativeSource={RelativeSource Self}}" />
                                                    <Setter Property="FocusedBorderBrush"
                                                            Value="Transparent" />
                                                    <Setter Property="CheckedBackground">
                                                        <Setter.Value>
                                                            <LinearGradientBrush StartPoint="0,0"
                                                                                 EndPoint="1,1">
                                                                <GradientStop Offset="0"
                                                                              Color="#80808080" />
                                                                <GradientStop Offset="1"
                                                                              Color="#80FFFFFF" />
                                                            </LinearGradientBrush>
                                                        </Setter.Value>
                                                    </Setter>
                                                    <Setter Property="CheckedBorderBrush"
                                                            Value="Transparent" />
                                                    <Setter Property="Margin"
                                                            Value="0,-1,0,0" />
                                                    <Setter Property="ClickMode"
                                                            Value="Press" />
                                                    <Setter Property="Template">
                                                        <Setter.Value>
                                                            <ControlTemplate TargetType="{x:Type r:RibbonToggleButton}">
                                                                <Border x:Name="OuterBorder"
                                                                        Background="{TemplateBinding Background}"
                                                                        BorderBrush="{TemplateBinding BorderBrush}"
                                                                        BorderThickness="1"
                                                                        CornerRadius="3">
                                                                    <Grid>
                                                                        <Border x:Name="InnerBorder"
                                                                                Background="{TemplateBinding MouseOverBackground}"
                                                                                BorderBrush="{TemplateBinding MouseOverBorderBrush}"
                                                                                CornerRadius="3"
                                                                                Opacity="0" />
                                                                        <Image x:Name="GroupImage"
                                                                               Width="16"
                                                                               Height="16"
                                                                               Margin="3,2"
                                                                               HorizontalAlignment="Center"
                                                                               VerticalAlignment="Center"
                                                                               RenderOptions.BitmapScalingMode="{TemplateBinding RenderOptions.BitmapScalingMode}"
                                                                               Source="{TemplateBinding SmallImageSource}" />
                                                                    </Grid>
                                                                </Border>
                                                                <ControlTemplate.Triggers>
                                                                    <Trigger Property="IsEnabled"
                                                                             Value="False">
                                                                        <Setter TargetName="GroupImage"
                                                                                Property="Opacity"
                                                                                Value="0.5" />
                                                                    </Trigger>
                                                                    <MultiDataTrigger>
                                                                        <MultiDataTrigger.Conditions>
                                                                            <Condition Binding="{Binding HighContrast}"
                                                                                       Value="False" />
                                                                            <Condition Binding="{Binding Background, RelativeSource={RelativeSource Self}}"
                                                                                       Value="Transparent" />
                                                                        </MultiDataTrigger.Conditions>
                                                                        <Setter TargetName="OuterBorder"
                                                                                Property="Background"
                                                                                Value="{Binding Ribbon.Background, RelativeSource={RelativeSource TemplatedParent}}" />
                                                                    </MultiDataTrigger>
                                                                    <MultiDataTrigger>
                                                                        <MultiDataTrigger.Conditions>
                                                                            <Condition Binding="{Binding HighContrast}"
                                                                                       Value="False" />
                                                                            <Condition Binding="{Binding IsMouseOver, RelativeSource={RelativeSource Self}}"
                                                                                       Value="True" />
                                                                            <Condition Binding="{Binding IsChecked, RelativeSource={RelativeSource Self}}"
                                                                                       Value="False" />
                                                                        </MultiDataTrigger.Conditions>
                                                                        <Setter TargetName="InnerBorder"
                                                                                Property="Opacity"
                                                                                Value="1" />
                                                                        <Setter TargetName="OuterBorder"
                                                                                Property="Background"
                                                                                Value="Transparent" />
                                                                    </MultiDataTrigger>
                                                                    <MultiDataTrigger>
                                                                        <MultiDataTrigger.Conditions>
                                                                            <Condition Binding="{Binding HighContrast}"
                                                                                       Value="False" />
                                                                            <Condition Binding="{Binding IsKeyboardFocused, RelativeSource={RelativeSource Self}}"
                                                                                       Value="True" />
                                                                            <Condition Binding="{Binding IsChecked, RelativeSource={RelativeSource Self}}"
                                                                                       Value="False" />
                                                                        </MultiDataTrigger.Conditions>
                                                                        <Setter TargetName="InnerBorder"
                                                                                Property="Opacity"
                                                                                Value="1" />
                                                                        <Setter TargetName="InnerBorder"
                                                                                Property="Background"
                                                                                Value="{Binding FocusedBackground, RelativeSource={RelativeSource TemplatedParent}}" />
                                                                        <Setter TargetName="InnerBorder"
                                                                                Property="BorderBrush"
                                                                                Value="{Binding FocusedBorderBrush, RelativeSource={RelativeSource TemplatedParent}}" />
                                                                        <Setter TargetName="OuterBorder"
                                                                                Property="Background"
                                                                                Value="Transparent" />
                                                                    </MultiDataTrigger>
                                                                    <MultiDataTrigger>
                                                                        <MultiDataTrigger.Conditions>
                                                                            <Condition Binding="{Binding HighContrast}"
                                                                                       Value="False" />
                                                                            <Condition Binding="{Binding IsChecked, RelativeSource={RelativeSource Self}}"
                                                                                       Value="True" />
                                                                        </MultiDataTrigger.Conditions>
                                                                        <Setter TargetName="InnerBorder"
                                                                                Property="Background"
                                                                                Value="{Binding CheckedBackground, RelativeSource={RelativeSource TemplatedParent}}" />
                                                                        <Setter TargetName="InnerBorder"
                                                                                Property="BorderBrush"
                                                                                Value="{Binding CheckedBorderBrush, RelativeSource={RelativeSource TemplatedParent}}" />
                                                                        <Setter TargetName="InnerBorder"
                                                                                Property="Opacity"
                                                                                Value="1" />
                                                                        <Setter TargetName="OuterBorder"
                                                                                Property="Background"
                                                                                Value="Transparent" />
                                                                        <Setter TargetName="OuterBorder"
                                                                                Property="BorderBrush"
                                                                                Value="#AA808080" />
                                                                    </MultiDataTrigger>
                                                                    <DataTrigger Binding="{Binding HighContrast}"
                                                                                 Value="True">
                                                                        <Setter TargetName="OuterBorder"
                                                                                Property="CornerRadius"
                                                                                Value="0" />
                                                                        <Setter TargetName="OuterBorder"
                                                                                Property="BorderBrush"
                                                                                Value="{DynamicResource {x:Static SystemColors.HighlightTextBrushKey}}" />
                                                                        <Setter TargetName="OuterBorder"
                                                                                Property="Background"
                                                                                Value="Transparent" />
                                                                    </DataTrigger>
                                                                    <MultiDataTrigger>
                                                                        <MultiDataTrigger.Conditions>
                                                                            <Condition Binding="{Binding HighContrast}"
                                                                                       Value="True" />
                                                                            <Condition Binding="{Binding IsMouseOver, RelativeSource={RelativeSource Self}}"
                                                                                       Value="True" />
                                                                        </MultiDataTrigger.Conditions>
                                                                        <Setter TargetName="OuterBorder"
                                                                                Property="Background"
                                                                                Value="{DynamicResource {x:Static SystemColors.HighlightBrushKey}}" />
                                                                    </MultiDataTrigger>
                                                                    <MultiDataTrigger>
                                                                        <MultiDataTrigger.Conditions>
                                                                            <Condition Binding="{Binding HighContrast}"
                                                                                       Value="True" />
                                                                            <Condition Binding="{Binding IsKeyboardFocused, RelativeSource={RelativeSource Self}}"
                                                                                       Value="True" />
                                                                        </MultiDataTrigger.Conditions>
                                                                        <Setter TargetName="OuterBorder"
                                                                                Property="Background"
                                                                                Value="{DynamicResource {x:Static SystemColors.HighlightBrushKey}}" />
                                                                    </MultiDataTrigger>
                                                                    <MultiDataTrigger>
                                                                        <MultiDataTrigger.Conditions>
                                                                            <Condition Binding="{Binding HighContrast}"
                                                                                       Value="True" />
                                                                            <Condition Binding="{Binding IsChecked, RelativeSource={RelativeSource Self}}"
                                                                                       Value="True" />
                                                                        </MultiDataTrigger.Conditions>
                                                                        <Setter TargetName="OuterBorder"
                                                                                Property="Background"
                                                                                Value="{DynamicResource {x:Static SystemColors.HighlightBrushKey}}" />
                                                                        <Setter TargetName="OuterBorder"
                                                                                Property="BorderBrush"
                                                                                Value="{DynamicResource {x:Static SystemColors.ControlDarkBrushKey}}" />
                                                                    </MultiDataTrigger>
                                                                </ControlTemplate.Triggers>
                                                            </ControlTemplate>
                                                        </Setter.Value>
                                                    </Setter>
                                                </Style>
                                            </Setter.Value>
                                        </Setter>
                                        <Setter TargetName="PART_ToggleButton"
                                                Property="Margin"
                                                Value="0" />
                                    </Trigger>
                                    <Trigger Property="IsDropDownOpen"
                                             Value="True">
                                        <Setter TargetName="MainGrid"
                                                Property="ToolTipService.IsEnabled"
                                                Value="False" />
                                    </Trigger>
                                    <MultiDataTrigger>
                                        <MultiDataTrigger.Conditions>
                                            <Condition Binding="{Binding IsEnabled, RelativeSource={RelativeSource Self}}"
                                                       Value="False" />
                                            <Condition Binding="{Binding HighContrast}"
                                                       Value="True" />
                                        </MultiDataTrigger.Conditions>
                                        <Setter TargetName="MainGrid"
                                                Property="TextElement.Foreground"
                                                Value="{DynamicResource {x:Static SystemColors.GrayTextBrushKey}}" />
                                    </MultiDataTrigger>
                                </ControlTemplate.Triggers>
                            </ControlTemplate>
                        </Setter.Value>
                    </Setter>
                </Trigger>
            </Style.Triggers>
        </Style>
        <!--endregion RibbonGroup-->
        <!--region RibbonApplicationMenuControlTemplate-->
        <ControlTemplate x:Key="RibbonApplicationMenuControlTemplate"
                         TargetType="{x:Type r:RibbonApplicationMenu}">
            <Grid x:Name="OuterGrid"
                  Focusable="False"
                  SnapsToDevicePixels="True">
                <r:RibbonToggleButton x:Name="PART_ToggleButton"
                                      Width="36"
                                      Height="36"
                                      Background="{TemplateBinding Background}"
                                      BorderBrush="{TemplateBinding BorderBrush}"
                                      BorderThickness="{TemplateBinding BorderThickness}"
                                      FocusVisualStyle="{TemplateBinding FocusVisualStyle}"
                                      IsChecked="{Binding IsDropDownOpen, Mode=TwoWay, RelativeSource={RelativeSource TemplatedParent}}"
                                      SmallImageSource="{TemplateBinding SmallImageSource}"
                                      ToolTipDescription="{TemplateBinding ToolTipDescription}"
                                      ToolTipFooterDescription="{TemplateBinding ToolTipFooterDescription}"
                                      ToolTipFooterImageSource="{TemplateBinding ToolTipFooterImageSource}"
                                      ToolTipFooterTitle="{TemplateBinding ToolTipFooterTitle}"
                                      ToolTipImageSource="{TemplateBinding ToolTipImageSource}"
                                      ToolTipTitle="{TemplateBinding ToolTipTitle}">
                    <r:RibbonToggleButton.Style>
                        <Style TargetType="{x:Type r:RibbonToggleButton}">
                            <Setter Property="BorderBrush"
                                    Value="#FF114EAF" />
                            <Setter Property="Background"
                                    Value="#FF114EAF" />
                            <Setter Property="BorderThickness"
                                    Value="1" />
                            <Setter Property="Foreground">
                                <Setter.Value>
                                    <RadialGradientBrush>
                                        <GradientStop Offset="0"
                                                      Color="LightGray" />
                                        <GradientStop Offset="0.4"
                                                      Color="White" />
                                    </RadialGradientBrush>
                                </Setter.Value>
                            </Setter>
                            <Setter Property="ClickMode"
                                    Value="Press" />
                            <Setter Property="FocusVisualStyle"
                                    Value="{x:Null}" />
                            <Setter Property="FocusManager.IsFocusScope"
                                    Value="False" />
                            <Setter Property="VerticalAlignment"
                                    Value="Bottom" />
                            <Setter Property="ToolTipService.InitialShowDelay"
                                    Value="900" />
                            <Setter Property="ToolTipService.ShowDuration"
                                    Value="20000" />
                            <Setter Property="ToolTipService.BetweenShowDelay"
                                    Value="0" />
                            <Setter Property="Template">
                                <Setter.Value>
                                    <ControlTemplate TargetType="{x:Type r:RibbonToggleButton}">
                                        <Grid Width="{Binding Width, RelativeSource={RelativeSource TemplatedParent}}"
                                              Height="{Binding Height, RelativeSource={RelativeSource TemplatedParent}}"
                                              SnapsToDevicePixels="True">
                                            <Border x:Name="OuterBorder"
                                                    HorizontalAlignment="Stretch"
                                                    VerticalAlignment="Stretch"
                                                    Background="{TemplateBinding Background}"
                                                    BorderBrush="{TemplateBinding BorderBrush}"
                                                    BorderThickness="{TemplateBinding BorderThickness}"
                                                    CornerRadius="20" />
                                            <Border x:Name="MiddleBorder"
                                                    HorizontalAlignment="Stretch"
                                                    VerticalAlignment="Stretch"
                                                    BorderBrush="Transparent"
                                                    BorderThickness="{TemplateBinding BorderThickness}"
                                                    CornerRadius="20">
                                                <Border.Background>
                                                    <LinearGradientBrush StartPoint="0,0"
                                                                         EndPoint="0,1">
                                                        <GradientStop Offset="0"
                                                                      Color="#90FFFFFF" />
                                                        <GradientStop Offset="0.5"
                                                                      Color="#30FFFFFF" />
                                                        <GradientStop Offset="0.5"
                                                                      Color="Transparent" />
                                                        <GradientStop Offset="1"
                                                                      Color="#70FFFFFF" />
                                                    </LinearGradientBrush>
                                                </Border.Background>
                                                <Border x:Name="InnerBorder"
                                                        Background="Transparent"
                                                        BorderThickness="1"
                                                        CornerRadius="20">
                                                    <Border.BorderBrush>
                                                        <LinearGradientBrush StartPoint="0,0"
                                                                             EndPoint="0,1">
                                                            <GradientStop Offset="0"
                                                                          Color="#60FFFFFF" />
                                                            <GradientStop Offset="0.5"
                                                                          Color="#20FFFFFF" />
                                                            <GradientStop Offset="0.5"
                                                                          Color="Transparent" />
                                                            <GradientStop Offset="1"
                                                                          Color="Transparent" />
                                                        </LinearGradientBrush>
                                                    </Border.BorderBrush>
                                                </Border>
                                            </Border>
                                            <StackPanel HorizontalAlignment="Center"
                                                        VerticalAlignment="Center"
                                                        Orientation="Horizontal">
                                                <Image Width="16"
                                                       Height="16"
                                                       Margin="0,-0.5,0,0"
                                                       HorizontalAlignment="Center"
                                                       VerticalAlignment="Center"
                                                       IsHitTestVisible="False"
                                                       RenderOptions.BitmapScalingMode="NearestNeighbor"
                                                       RenderOptions.EdgeMode="Aliased"
                                                       Source="/Report.ico" />
                                                <Path x:Name="DownArrow"
                                                      Margin="3.5,0,0,0"
                                                      HorizontalAlignment="Center"
                                                      VerticalAlignment="Center"
                                                      Data="M0,0L2.25,3 4.5,0z"
                                                      Fill="{TemplateBinding Foreground}"
                                                      StrokeThickness="0.5"
                                                      Visibility="Collapsed">
                                                    <Path.RenderTransform>
                                                        <ScaleTransform ScaleX="1.5"
                                                                        ScaleY="1.5" />
                                                    </Path.RenderTransform>
                                                    <Path.Stroke>
                                                        <LinearGradientBrush StartPoint="0,0"
                                                                             EndPoint="0,1">
                                                            <GradientStop Offset="0"
                                                                          Color="#90FFFFFF" />
                                                            <GradientStop Offset="0.5"
                                                                          Color="#30FFFFFF" />
                                                            <GradientStop Offset="0.5"
                                                                          Color="Transparent" />
                                                            <GradientStop Offset="1"
                                                                          Color="#70FFFFFF" />
                                                        </LinearGradientBrush>
                                                    </Path.Stroke>
                                                </Path>
                                            </StackPanel>
                                        </Grid>
                                        <ControlTemplate.Triggers>
                                            <MultiTrigger>
                                                <MultiTrigger.Conditions>
                                                    <Condition Property="IsKeyboardFocused"
                                                               Value="True" />
                                                    <Condition Property="IsChecked"
                                                               Value="False" />
                                                </MultiTrigger.Conditions>
                                                <Setter TargetName="MiddleBorder"
                                                        Property="BorderBrush"
                                                        Value="#80FFFFFF" />
                                                <Setter TargetName="MiddleBorder"
                                                        Property="Background">
                                                    <Setter.Value>
                                                        <LinearGradientBrush StartPoint="0,0"
                                                                             EndPoint="0,1">
                                                            <GradientStop Offset="0"
                                                                          Color="#A0FFFFFF" />
                                                            <GradientStop Offset="0.5"
                                                                          Color="#60FFFFFF" />
                                                            <GradientStop Offset="0.5"
                                                                          Color="Transparent" />
                                                            <GradientStop Offset="1"
                                                                          Color="#D0FFFFFF" />
                                                        </LinearGradientBrush>
                                                    </Setter.Value>
                                                </Setter>
                                                <Setter TargetName="InnerBorder"
                                                        Property="BorderBrush">
                                                    <Setter.Value>
                                                        <LinearGradientBrush StartPoint="0,0"
                                                                             EndPoint="0,1">
                                                            <GradientStop Offset="0"
                                                                          Color="#90FFFFFF" />
                                                            <GradientStop Offset="0.5"
                                                                          Color="#20FFFFFF" />
                                                            <GradientStop Offset="0.5"
                                                                          Color="Transparent" />
                                                            <GradientStop Offset="1"
                                                                          Color="Transparent" />
                                                        </LinearGradientBrush>
                                                    </Setter.Value>
                                                </Setter>
                                            </MultiTrigger>
                                            <MultiTrigger>
                                                <MultiTrigger.Conditions>
                                                    <Condition Property="IsMouseOver"
                                                               Value="True" />
                                                    <Condition Property="IsChecked"
                                                               Value="False" />
                                                </MultiTrigger.Conditions>
                                                <Setter TargetName="MiddleBorder"
                                                        Property="BorderBrush"
                                                        Value="#80FFFFFF" />
                                                <Setter TargetName="MiddleBorder"
                                                        Property="Background">
                                                    <Setter.Value>
                                                        <LinearGradientBrush StartPoint="0,0"
                                                                             EndPoint="0,1">
                                                            <GradientStop Offset="0"
                                                                          Color="#A0FFFFFF" />
                                                            <GradientStop Offset="0.5"
                                                                          Color="#60FFFFFF" />
                                                            <GradientStop Offset="0.5"
                                                                          Color="Transparent" />
                                                            <GradientStop Offset="1"
                                                                          Color="#D0FFFFFF" />
                                                        </LinearGradientBrush>
                                                    </Setter.Value>
                                                </Setter>
                                                <Setter TargetName="InnerBorder"
                                                        Property="BorderBrush">
                                                    <Setter.Value>
                                                        <LinearGradientBrush StartPoint="0,0"
                                                                             EndPoint="0,1">
                                                            <GradientStop Offset="0"
                                                                          Color="#90FFFFFF" />
                                                            <GradientStop Offset="0.5"
                                                                          Color="#20FFFFFF" />
                                                            <GradientStop Offset="0.5"
                                                                          Color="Transparent" />
                                                            <GradientStop Offset="1"
                                                                          Color="Transparent" />
                                                        </LinearGradientBrush>
                                                    </Setter.Value>
                                                </Setter>
                                            </MultiTrigger>
                                            <DataTrigger Binding="{Binding HighContrast}"
                                                         Value="True">
                                                <Setter TargetName="OuterBorder"
                                                        Property="BorderBrush"
                                                        Value="{DynamicResource {x:Static SystemColors.ControlLightLightBrushKey}}" />
                                                <Setter TargetName="OuterBorder"
                                                        Property="Background"
                                                        Value="{DynamicResource {x:Static SystemColors.ControlBrushKey}}" />
                                                <Setter TargetName="OuterBorder"
                                                        Property="CornerRadius"
                                                        Value="0" />
                                                <Setter TargetName="MiddleBorder"
                                                        Property="BorderBrush"
                                                        Value="Transparent" />
                                                <Setter TargetName="MiddleBorder"
                                                        Property="Background"
                                                        Value="Transparent" />
                                                <Setter TargetName="MiddleBorder"
                                                        Property="CornerRadius"
                                                        Value="0" />
                                                <Setter TargetName="InnerBorder"
                                                        Property="BorderBrush"
                                                        Value="Transparent" />
                                                <Setter TargetName="InnerBorder"
                                                        Property="Background"
                                                        Value="Transparent" />
                                                <Setter TargetName="InnerBorder"
                                                        Property="CornerRadius"
                                                        Value="0" />
                                                <Setter TargetName="DownArrow"
                                                        Property="Stroke"
                                                        Value="{DynamicResource {x:Static SystemColors.ControlBrushKey}}" />
                                                <Setter TargetName="DownArrow"
                                                        Property="Fill"
                                                        Value="{DynamicResource {x:Static SystemColors.ControlDarkDarkBrushKey}}" />
                                            </DataTrigger>
                                        </ControlTemplate.Triggers>
                                    </ControlTemplate>
                                </Setter.Value>
                            </Setter>
                        </Style>
                    </r:RibbonToggleButton.Style>
                </r:RibbonToggleButton>
                <Border x:Name="CenterBorder"
                        Height="1"
                        Margin="-1,-1,0,0"
                        HorizontalAlignment="Stretch"
                        VerticalAlignment="Top" />
                <Popup x:Name="PART_Popup"
                       AllowsTransparency="True"
                       IsOpen="{Binding IsDropDownOpen, RelativeSource={RelativeSource TemplatedParent}}"
                       PopupAnimation="{DynamicResource {x:Static SystemParameters.MenuPopupAnimationKey}}"
                       SnapsToDevicePixels="True">
                    <themeClassic:SystemDropShadowChrome x:Name="Shadow"
                                                         KeyTipService.IsKeyTipScope="True"
                                                         RenderOptions.ClearTypeHint="Enabled"
                                                         Color="Transparent">
                        <Grid>
                            <Border x:Name="PopupBorder"
                                    Background="{Binding Ribbon.Background, RelativeSource={RelativeSource FindAncestor, AncestorLevel=1, AncestorType={x:Type r:RibbonMenuButton}}}"
                                    BorderBrush="{Binding Ribbon.BorderBrush, RelativeSource={RelativeSource FindAncestor, AncestorLevel=1, AncestorType={x:Type r:RibbonMenuButton}}}"
                                    BorderThickness="1"
                                    CornerRadius="2">
                                <Grid>
                                    <Grid.RowDefinitions>
                                        <RowDefinition Height="24" />
                                        <RowDefinition Height="*" />
                                        <RowDefinition Height="Auto" />
                                    </Grid.RowDefinitions>
                                    <Border x:Name="HeaderBorder"
                                            Background="Transparent"
                                            BorderBrush="{Binding Ribbon.BorderBrush, RelativeSource={RelativeSource FindAncestor, AncestorLevel=1, AncestorType={x:Type r:RibbonMenuButton}}}"
                                            BorderThickness="0,0,0,1"
                                            CornerRadius="2,2,0,0" />
                                    <Border x:Name="HeaderOverlayBorder"
                                            BorderBrush="#80FFFFFF"
                                            BorderThickness="0,0,0,1"
                                            CornerRadius="2,2,0,0">
                                        <Border.Background>
                                            <LinearGradientBrush StartPoint="0,0"
                                                                 EndPoint="0,1">
                                                <GradientStop Offset="0"
                                                              Color="#A0FFFFFF" />
                                                <GradientStop Offset="0.5"
                                                              Color="#60FFFFFF" />
                                                <GradientStop Offset="0.5"
                                                              Color="Transparent" />
                                                <GradientStop Offset="1"
                                                              Color="#D0FFFFFF" />
                                            </LinearGradientBrush>
                                        </Border.Background>
                                    </Border>
                                    <Grid Grid.Row="1">
                                        <Grid.ColumnDefinitions>
                                            <ColumnDefinition Width="Auto" />
                                            <ColumnDefinition Width="2" />
                                            <ColumnDefinition Width="300" />
                                        </Grid.ColumnDefinitions>
                                        <Border x:Name="MainPaneBorder"
                                                Background="#B8FFFFFF">
                                            <Grid>
                                                <Grid.RowDefinitions>
                                                    <RowDefinition Height="Auto" />
                                                    <RowDefinition />
                                                    <RowDefinition Height="Auto" />
                                                </Grid.RowDefinitions>
                                                <ScrollViewer x:Name="PART_SubMenuScrollViewer"
                                                              Grid.Row="1"
                                                              CanContentScroll="True"
                                                              Style="{DynamicResource {ComponentResourceKey ResourceId=MenuScrollViewer, TypeInTargetAssembly={x:Type FrameworkElement}}}">
                                                    <Grid RenderOptions.ClearTypeHint="Enabled">
                                                        <Canvas x:Name="BackgroundCanvas"
                                                                Width="0"
                                                                Height="0"
                                                                HorizontalAlignment="Left"
                                                                VerticalAlignment="Top">
                                                            <Rectangle x:Name="OpaqueRect"
                                                                       Width="{Binding ActualWidth, ElementName=MainPaneBorder}"
                                                                       Height="{Binding ActualHeight, ElementName=MainPaneBorder}"
                                                                       Fill="{Binding Background, ElementName=MainPaneBorder}"
                                                                       RadiusX="2"
                                                                       RadiusY="2" />
                                                            <Rectangle x:Name="OverlayRect"
                                                                       Width="{Binding ActualWidth, ElementName=MainPaneBorder}"
                                                                       Height="{Binding ActualHeight, ElementName=MainPaneBorder}"
                                                                       Fill="{Binding Background, ElementName=MainPaneBorder}"
                                                                       RadiusX="2"
                                                                       RadiusY="2" />
                                                        </Canvas>
                                                        <ItemsPresenter x:Name="ItemsPresenter"
                                                                        Grid.IsSharedSizeScope="True" />
                                                    </Grid>
                                                </ScrollViewer>
                                                <Border x:Name="ResizeControl"
                                                        Grid.Row="2"
                                                        Background="#FFE5EFF9"
                                                        BorderBrush="{Binding Ribbon.BorderBrush, RelativeSource={RelativeSource TemplatedParent}}"
                                                        BorderThickness="0,1,0,0"
                                                        Visibility="Collapsed">
                                                    <Thumb x:Name="PART_ResizeThumb">
                                                        <Thumb.Style>
                                                            <Style TargetType="{x:Type Thumb}">
                                                                <Setter Property="Width"
                                                                        Value="11" />
                                                                <Setter Property="Height"
                                                                        Value="11" />
                                                                <Setter Property="VerticalAlignment"
                                                                        Value="Bottom" />
                                                                <Setter Property="HorizontalAlignment"
                                                                        Value="Right" />
                                                                <Setter Property="Cursor"
                                                                        Value="SizeNWSE" />
                                                                <Setter Property="Template">
                                                                    <Setter.Value>
                                                                        <ControlTemplate TargetType="{x:Type Thumb}">
                                                                            <Border Background="Transparent">
                                                                                <Path Margin="0,0,2,2"
                                                                                      Data="M9,0L11,0 11,11 0,11 0,9 3,9 3,6 6,6 6,3 9,3z">
                                                                                    <Path.Fill>
                                                                                        <DrawingBrush TileMode="Tile"
                                                                                                      Viewbox="0,0,3,3"
                                                                                                      ViewboxUnits="Absolute"
                                                                                                      Viewport="0,0,3,3"
                                                                                                      ViewportUnits="Absolute">
                                                                                            <DrawingBrush.Drawing>
                                                                                                <DrawingGroup>
                                                                                                    <GeometryDrawing Brush="#FF6C747D"
                                                                                                                     Geometry="M0,0L2,0 2,2 0,2z" />
                                                                                                </DrawingGroup>
                                                                                            </DrawingBrush.Drawing>
                                                                                        </DrawingBrush>
                                                                                    </Path.Fill>
                                                                                </Path>
                                                                            </Border>
                                                                        </ControlTemplate>
                                                                    </Setter.Value>
                                                                </Setter>
                                                                <Style.Triggers>
                                                                    <Trigger Property="FlowDirection"
                                                                             Value="RightToLeft">
                                                                        <Setter Property="Cursor"
                                                                                Value="SizeNESW" />
                                                                    </Trigger>
                                                                </Style.Triggers>
                                                            </Style>
                                                        </Thumb.Style>
                                                    </Thumb>
                                                </Border>
                                            </Grid>
                                        </Border>
                                        <Border x:Name="PART_SubmenuPlaceholder"
                                                Grid.Column="2"
                                                Height="{Binding ActualHeight, ElementName=MainPaneBorder}"
                                                Background="#80FFFFFF">
                                            <ContentPresenter x:Name="PART_AuxiliaryPaneContentPresenter"
                                                              Content="{TemplateBinding AuxiliaryPaneContent}"
                                                              ContentSource="AuxiliaryPaneContent"
                                                              ContentTemplate="{TemplateBinding AuxiliaryPaneContentTemplate}" />
                                        </Border>
                                        <Border x:Name="VerticalBorder"
                                                Grid.Column="1"
                                                Width="2"
                                                HorizontalAlignment="Left"
                                                Background="White"
                                                BorderBrush="{Binding Ribbon.BorderBrush, RelativeSource={RelativeSource FindAncestor, AncestorLevel=1, AncestorType={x:Type r:RibbonMenuButton}}}"
                                                BorderThickness="1,0,0,0" />
                                        <Border x:Name="VerticalOverlayBorder"
                                                Grid.Column="1"
                                                Width="2"
                                                HorizontalAlignment="Left"
                                                Background="Transparent"
                                                BorderBrush="#80FFFFFF"
                                                BorderThickness="1,0,0,0" />
                                    </Grid>
                                    <Border x:Name="FooterBorder"
                                            Grid.Row="2"
                                            Background="Transparent"
                                            BorderBrush="{Binding Ribbon.BorderBrush, RelativeSource={RelativeSource FindAncestor, AncestorLevel=1, AncestorType={x:Type r:RibbonMenuButton}}}"
                                            BorderThickness="0,1,0,0"
                                            CornerRadius="0,0,2,2">
                                        <Border x:Name="FooterBackgroundOverlayBorder"
                                                BorderBrush="Transparent"
                                                CornerRadius="0,0,2,2">
                                            <Border.Background>
                                                <LinearGradientBrush StartPoint="0,0"
                                                                     EndPoint="0,1">
                                                    <GradientStop Offset="0"
                                                                  Color="#A0FFFFFF" />
                                                    <GradientStop Offset="0.2"
                                                                  Color="#90FFFFFF" />
                                                    <GradientStop Offset="0.4"
                                                                  Color="#80FFFFFF" />
                                                    <GradientStop Offset="0.6"
                                                                  Color="#50FFFFFF" />
                                                    <GradientStop Offset="0.8"
                                                                  Color="Transparent" />
                                                    <GradientStop Offset="1"
                                                                  Color="#30FFFFFF" />
                                                </LinearGradientBrush>
                                            </Border.Background>
                                            <ContentPresenter x:Name="PART_FooterPaneContentPresenter"
                                                              MinHeight="12"
                                                              Margin="2"
                                                              Content="{TemplateBinding FooterPaneContent}"
                                                              ContentSource="FooterPaneContent"
                                                              ContentTemplate="{TemplateBinding FooterPaneContentTemplate}" />
                                        </Border>
                                    </Border>
                                    <Border x:Name="FooterOverlayBorder"
                                            HorizontalAlignment="Stretch"
                                            VerticalAlignment="Stretch"
                                            Background="Transparent"
                                            BorderBrush="#80FFFFFF"
                                            BorderThickness="0,1,0,0"
                                            CornerRadius="0,0,2,2" />
                                </Grid>
                            </Border>
                            <Canvas>
                                <r:RibbonToggleButton x:Name="PART_PopupToggleButton"
                                                      Canvas.Left="3"
                                                      Canvas.Top="-24"
                                                      Width="{Binding Width, RelativeSource={RelativeSource TemplatedParent}}"
                                                      Height="{Binding Height, RelativeSource={RelativeSource TemplatedParent}}"
                                                      AutomationProperties.Name="{Binding (AutomationProperties.Name), RelativeSource={RelativeSource TemplatedParent}}"
                                                      Background="{TemplateBinding Background}"
                                                      BorderBrush="{TemplateBinding BorderBrush}"
                                                      BorderThickness="{TemplateBinding BorderThickness}"
                                                      Focusable="False"
                                                      IsChecked="{Binding IsDropDownOpen, RelativeSource={RelativeSource TemplatedParent}}">
                                    <r:RibbonToggleButton.Style>
                                        <Style TargetType="{x:Type r:RibbonToggleButton}">
                                            <Setter Property="BorderBrush"
                                                    Value="#FF114EAF" />
                                            <Setter Property="Background"
                                                    Value="#FF114EAF" />
                                            <Setter Property="BorderThickness"
                                                    Value="1" />
                                            <Setter Property="Foreground">
                                                <Setter.Value>
                                                    <RadialGradientBrush>
                                                        <GradientStop Offset="0"
                                                                      Color="LightGray" />
                                                        <GradientStop Offset="0.4"
                                                                      Color="White" />
                                                    </RadialGradientBrush>
                                                </Setter.Value>
                                            </Setter>
                                            <Setter Property="ClickMode"
                                                    Value="Press" />
                                            <Setter Property="FocusVisualStyle"
                                                    Value="{x:Null}" />
                                            <Setter Property="FocusManager.IsFocusScope"
                                                    Value="False" />
                                            <Setter Property="VerticalAlignment"
                                                    Value="Bottom" />
                                            <Setter Property="ToolTipService.InitialShowDelay"
                                                    Value="900" />
                                            <Setter Property="ToolTipService.ShowDuration"
                                                    Value="20000" />
                                            <Setter Property="ToolTipService.BetweenShowDelay"
                                                    Value="0" />
                                            <Setter Property="Template">
                                                <Setter.Value>
                                                    <ControlTemplate TargetType="{x:Type r:RibbonToggleButton}">
                                                        <Grid Width="{Binding Width, RelativeSource={RelativeSource TemplatedParent}}"
                                                              Height="{Binding Height, RelativeSource={RelativeSource TemplatedParent}}"
                                                              SnapsToDevicePixels="True">
                                                            <Border x:Name="OuterBorder"
                                                                    HorizontalAlignment="Stretch"
                                                                    VerticalAlignment="Stretch"
                                                                    Background="{TemplateBinding Background}"
                                                                    BorderBrush="{TemplateBinding BorderBrush}"
                                                                    BorderThickness="{TemplateBinding BorderThickness}"
                                                                    CornerRadius="0,2,0,0" />
                                                            <Border x:Name="MiddleBorder"
                                                                    HorizontalAlignment="Stretch"
                                                                    VerticalAlignment="Stretch"
                                                                    BorderBrush="Transparent"
                                                                    BorderThickness="{TemplateBinding BorderThickness}"
                                                                    CornerRadius="0,2,0,0">
                                                                <Border.Background>
                                                                    <LinearGradientBrush StartPoint="0,0"
                                                                                         EndPoint="0,1">
                                                                        <GradientStop Offset="0"
                                                                                      Color="#90FFFFFF" />
                                                                        <GradientStop Offset="0.5"
                                                                                      Color="#30FFFFFF" />
                                                                        <GradientStop Offset="0.5"
                                                                                      Color="Transparent" />
                                                                        <GradientStop Offset="1"
                                                                                      Color="#70FFFFFF" />
                                                                    </LinearGradientBrush>
                                                                </Border.Background>
                                                                <Border x:Name="InnerBorder"
                                                                        Background="Transparent"
                                                                        BorderThickness="1"
                                                                        CornerRadius="0,2,0,0">
                                                                    <Border.BorderBrush>
                                                                        <LinearGradientBrush StartPoint="0,0"
                                                                                             EndPoint="0,1">
                                                                            <GradientStop Offset="0"
                                                                                          Color="#60FFFFFF" />
                                                                            <GradientStop Offset="0.5"
                                                                                          Color="#20FFFFFF" />
                                                                            <GradientStop Offset="0.5"
                                                                                          Color="Transparent" />
                                                                            <GradientStop Offset="1"
                                                                                          Color="Transparent" />
                                                                        </LinearGradientBrush>
                                                                    </Border.BorderBrush>
                                                                </Border>
                                                            </Border>
                                                            <StackPanel HorizontalAlignment="Center"
                                                                        VerticalAlignment="Center"
                                                                        Orientation="Horizontal">
                                                                <Image Width="16"
                                                                       Height="16"
                                                                       Margin="0,-0.5,0,0"
                                                                       HorizontalAlignment="Center"
                                                                       VerticalAlignment="Center"
                                                                       IsHitTestVisible="False"
                                                                       RenderOptions.BitmapScalingMode="NearestNeighbor"
                                                                       RenderOptions.EdgeMode="Aliased"
                                                                       Source="{Binding SmallImageSource, RelativeSource={RelativeSource FindAncestor, AncestorLevel=1, AncestorType={x:Type r:RibbonApplicationMenu}}}" />
                                                                <Path x:Name="DownArrow"
                                                                      Margin="3.5,0,0,0"
                                                                      HorizontalAlignment="Center"
                                                                      VerticalAlignment="Center"
                                                                      Data="M0,0L2.25,3 4.5,0z"
                                                                      Fill="{TemplateBinding Foreground}"
                                                                      StrokeThickness="0.5">
                                                                    <Path.RenderTransform>
                                                                        <ScaleTransform ScaleX="1.5"
                                                                                        ScaleY="1.5" />
                                                                    </Path.RenderTransform>
                                                                    <Path.Stroke>
                                                                        <LinearGradientBrush StartPoint="0,0"
                                                                                             EndPoint="0,1">
                                                                            <GradientStop Offset="0"
                                                                                          Color="#90FFFFFF" />
                                                                            <GradientStop Offset="0.5"
                                                                                          Color="#30FFFFFF" />
                                                                            <GradientStop Offset="0.5"
                                                                                          Color="Transparent" />
                                                                            <GradientStop Offset="1"
                                                                                          Color="#70FFFFFF" />
                                                                        </LinearGradientBrush>
                                                                    </Path.Stroke>
                                                                </Path>
                                                            </StackPanel>
                                                        </Grid>
                                                        <ControlTemplate.Triggers>
                                                            <MultiTrigger>
                                                                <MultiTrigger.Conditions>
                                                                    <Condition Property="IsKeyboardFocused"
                                                                               Value="True" />
                                                                    <Condition Property="IsChecked"
                                                                               Value="False" />
                                                                </MultiTrigger.Conditions>
                                                                <Setter TargetName="MiddleBorder"
                                                                        Property="BorderBrush"
                                                                        Value="#80FFFFFF" />
                                                                <Setter TargetName="MiddleBorder"
                                                                        Property="Background">
                                                                    <Setter.Value>
                                                                        <LinearGradientBrush StartPoint="0,0"
                                                                                             EndPoint="0,1">
                                                                            <GradientStop Offset="0"
                                                                                          Color="#A0FFFFFF" />
                                                                            <GradientStop Offset="0.5"
                                                                                          Color="#60FFFFFF" />
                                                                            <GradientStop Offset="0.5"
                                                                                          Color="Transparent" />
                                                                            <GradientStop Offset="1"
                                                                                          Color="#D0FFFFFF" />
                                                                        </LinearGradientBrush>
                                                                    </Setter.Value>
                                                                </Setter>
                                                                <Setter TargetName="InnerBorder"
                                                                        Property="BorderBrush">
                                                                    <Setter.Value>
                                                                        <LinearGradientBrush StartPoint="0,0"
                                                                                             EndPoint="0,1">
                                                                            <GradientStop Offset="0"
                                                                                          Color="#90FFFFFF" />
                                                                            <GradientStop Offset="0.5"
                                                                                          Color="#20FFFFFF" />
                                                                            <GradientStop Offset="0.5"
                                                                                          Color="Transparent" />
                                                                            <GradientStop Offset="1"
                                                                                          Color="Transparent" />
                                                                        </LinearGradientBrush>
                                                                    </Setter.Value>
                                                                </Setter>
                                                            </MultiTrigger>
                                                            <MultiTrigger>
                                                                <MultiTrigger.Conditions>
                                                                    <Condition Property="IsMouseOver"
                                                                               Value="True" />
                                                                    <Condition Property="IsChecked"
                                                                               Value="False" />
                                                                </MultiTrigger.Conditions>
                                                                <Setter TargetName="MiddleBorder"
                                                                        Property="BorderBrush"
                                                                        Value="#80FFFFFF" />
                                                                <Setter TargetName="MiddleBorder"
                                                                        Property="Background">
                                                                    <Setter.Value>
                                                                        <LinearGradientBrush StartPoint="0,0"
                                                                                             EndPoint="0,1">
                                                                            <GradientStop Offset="0"
                                                                                          Color="#A0FFFFFF" />
                                                                            <GradientStop Offset="0.5"
                                                                                          Color="#60FFFFFF" />
                                                                            <GradientStop Offset="0.5"
                                                                                          Color="Transparent" />
                                                                            <GradientStop Offset="1"
                                                                                          Color="#D0FFFFFF" />
                                                                        </LinearGradientBrush>
                                                                    </Setter.Value>
                                                                </Setter>
                                                                <Setter TargetName="InnerBorder"
                                                                        Property="BorderBrush">
                                                                    <Setter.Value>
                                                                        <LinearGradientBrush StartPoint="0,0"
                                                                                             EndPoint="0,1">
                                                                            <GradientStop Offset="0"
                                                                                          Color="#90FFFFFF" />
                                                                            <GradientStop Offset="0.5"
                                                                                          Color="#20FFFFFF" />
                                                                            <GradientStop Offset="0.5"
                                                                                          Color="Transparent" />
                                                                            <GradientStop Offset="1"
                                                                                          Color="Transparent" />
                                                                        </LinearGradientBrush>
                                                                    </Setter.Value>
                                                                </Setter>
                                                            </MultiTrigger>
                                                            <DataTrigger Binding="{Binding HighContrast}"
                                                                         Value="True">
                                                                <Setter TargetName="OuterBorder"
                                                                        Property="BorderBrush"
                                                                        Value="{DynamicResource {x:Static SystemColors.ControlLightLightBrushKey}}" />
                                                                <Setter TargetName="OuterBorder"
                                                                        Property="Background"
                                                                        Value="{DynamicResource {x:Static SystemColors.ControlBrushKey}}" />
                                                                <Setter TargetName="OuterBorder"
                                                                        Property="CornerRadius"
                                                                        Value="0" />
                                                                <Setter TargetName="MiddleBorder"
                                                                        Property="BorderBrush"
                                                                        Value="Transparent" />
                                                                <Setter TargetName="MiddleBorder"
                                                                        Property="Background"
                                                                        Value="Transparent" />
                                                                <Setter TargetName="MiddleBorder"
                                                                        Property="CornerRadius"
                                                                        Value="0" />
                                                                <Setter TargetName="InnerBorder"
                                                                        Property="BorderBrush"
                                                                        Value="Transparent" />
                                                                <Setter TargetName="InnerBorder"
                                                                        Property="Background"
                                                                        Value="Transparent" />
                                                                <Setter TargetName="InnerBorder"
                                                                        Property="CornerRadius"
                                                                        Value="0" />
                                                                <Setter TargetName="DownArrow"
                                                                        Property="Stroke"
                                                                        Value="{DynamicResource {x:Static SystemColors.ControlBrushKey}}" />
                                                                <Setter TargetName="DownArrow"
                                                                        Property="Fill"
                                                                        Value="{DynamicResource {x:Static SystemColors.ControlDarkDarkBrushKey}}" />
                                                            </DataTrigger>
                                                        </ControlTemplate.Triggers>
                                                    </ControlTemplate>
                                                </Setter.Value>
                                            </Setter>
                                        </Style>
                                    </r:RibbonToggleButton.Style>
                                </r:RibbonToggleButton>
                            </Canvas>
                        </Grid>
                    </themeClassic:SystemDropShadowChrome>
                </Popup>
            </Grid>
            <ControlTemplate.Triggers>
                <Trigger SourceName="PART_SubMenuScrollViewer"
                         Property="CanContentScroll"
                         Value="False">
                    <Setter TargetName="OpaqueRect"
                            Property="Canvas.Top"
                            Value="{Binding VerticalOffset, ElementName=PART_SubMenuScrollViewer}" />
                    <Setter TargetName="OpaqueRect"
                            Property="Canvas.Left"
                            Value="{Binding HorizontalOffset, ElementName=PART_SubMenuScrollViewer}" />
                    <Setter TargetName="OverlayRect"
                            Property="Canvas.Top"
                            Value="{Binding VerticalOffset, ElementName=PART_SubMenuScrollViewer}" />
                    <Setter TargetName="OverlayRect"
                            Property="Canvas.Left"
                            Value="{Binding HorizontalOffset, ElementName=PART_SubMenuScrollViewer}" />
                </Trigger>
                <Trigger Property="HasGallery"
                         Value="True">
                    <Setter TargetName="PART_SubMenuScrollViewer"
                            Property="HorizontalScrollBarVisibility"
                            Value="Disabled" />
                    <Setter TargetName="PART_SubMenuScrollViewer"
                            Property="VerticalScrollBarVisibility"
                            Value="Disabled" />
                </Trigger>
                <MultiTrigger>
                    <MultiTrigger.Conditions>
                        <Condition Property="CanUserResizeHorizontally"
                                   Value="True" />
                        <Condition Property="CanUserResizeVertically"
                                   Value="True" />
                    </MultiTrigger.Conditions>
                    <Setter TargetName="ResizeControl"
                            Property="Visibility"
                            Value="Visible" />
                </MultiTrigger>
                <MultiTrigger>
                    <MultiTrigger.Conditions>
                        <Condition Property="CanUserResizeHorizontally"
                                   Value="False" />
                        <Condition Property="CanUserResizeVertically"
                                   Value="True" />
                    </MultiTrigger.Conditions>
                    <Setter TargetName="ResizeControl"
                            Property="Visibility"
                            Value="Visible" />
                    <Setter TargetName="PART_ResizeThumb"
                            Property="Style">
                        <Setter.Value>
                            <Style TargetType="{x:Type Thumb}">
                                <Setter Property="Height"
                                        Value="11" />
                                <Setter Property="Cursor"
                                        Value="SizeNS" />
                                <Setter Property="Template">
                                    <Setter.Value>
                                        <ControlTemplate TargetType="{x:Type Thumb}">
                                            <Border Background="Transparent">
                                                <Path Margin="0,0,2,2"
                                                      HorizontalAlignment="Center"
                                                      VerticalAlignment="Bottom">
                                                    <Path.Data>
                                                        <RectangleGeometry Rect="0,0,11,3" />
                                                    </Path.Data>
                                                    <Path.Fill>
                                                        <DrawingBrush TileMode="Tile"
                                                                      Viewbox="0,0,3,3"
                                                                      ViewboxUnits="Absolute"
                                                                      Viewport="0,0,3,3"
                                                                      ViewportUnits="Absolute">
                                                            <DrawingBrush.Drawing>
                                                                <DrawingGroup>
                                                                    <GeometryDrawing Brush="#FF6C747D"
                                                                                     Geometry="M0,0L2,0 2,2 0,2z" />
                                                                </DrawingGroup>
                                                            </DrawingBrush.Drawing>
                                                        </DrawingBrush>
                                                    </Path.Fill>
                                                </Path>
                                            </Border>
                                        </ControlTemplate>
                                    </Setter.Value>
                                </Setter>
                            </Style>
                        </Setter.Value>
                    </Setter>
                </MultiTrigger>
                <Trigger Property="IsDropDownPositionedAbove"
                         Value="True">
                    <Setter TargetName="ResizeControl"
                            Property="Grid.Row"
                            Value="0" />
                    <Setter TargetName="ResizeControl"
                            Property="BorderThickness"
                            Value="0,0,0,1" />
                </Trigger>
                <MultiTrigger>
                    <MultiTrigger.Conditions>
                        <Condition Property="IsDropDownPositionedAbove"
                                   Value="True" />
                        <Condition Property="CanUserResizeHorizontally"
                                   Value="True" />
                        <Condition Property="CanUserResizeVertically"
                                   Value="True" />
                    </MultiTrigger.Conditions>
                    <Setter TargetName="PART_ResizeThumb"
                            Property="Style">
                        <Setter.Value>
                            <Style TargetType="{x:Type Thumb}">
                                <Setter Property="Width"
                                        Value="11" />
                                <Setter Property="Height"
                                        Value="11" />
                                <Setter Property="VerticalAlignment"
                                        Value="Top" />
                                <Setter Property="HorizontalAlignment"
                                        Value="Right" />
                                <Setter Property="Cursor"
                                        Value="SizeNESW" />
                                <Setter Property="Template">
                                    <Setter.Value>
                                        <ControlTemplate TargetType="{x:Type Thumb}">
                                            <Border Background="Transparent">
                                                <Path Margin="0,2,2,0"
                                                      Data="M0,0L0,3 3,3 3,6 6,6 6,9 9,9 9,11 11,11 11,0z">
                                                    <Path.Fill>
                                                        <DrawingBrush TileMode="Tile"
                                                                      Viewbox="0,0,3,3"
                                                                      ViewboxUnits="Absolute"
                                                                      Viewport="0,0,3,3"
                                                                      ViewportUnits="Absolute">
                                                            <DrawingBrush.Drawing>
                                                                <DrawingGroup>
                                                                    <GeometryDrawing Brush="#FF6C747D"
                                                                                     Geometry="M0,0L2,0 2,2 0,2z" />
                                                                </DrawingGroup>
                                                            </DrawingBrush.Drawing>
                                                        </DrawingBrush>
                                                    </Path.Fill>
                                                </Path>
                                            </Border>
                                        </ControlTemplate>
                                    </Setter.Value>
                                </Setter>
                                <Style.Triggers>
                                    <Trigger Property="FlowDirection"
                                             Value="RightToLeft">
                                        <Setter Property="Cursor"
                                                Value="SizeNWSE" />
                                    </Trigger>
                                </Style.Triggers>
                            </Style>
                        </Setter.Value>
                    </Setter>
                </MultiTrigger>
                <Trigger SourceName="PART_Popup"
                         Property="HasDropShadow"
                         Value="True">
                    <Setter TargetName="Shadow"
                            Property="Margin"
                            Value="0,0,5,5" />
                    <Setter TargetName="Shadow"
                            Property="Color"
                            Value="#71000000" />
                </Trigger>
                <Trigger SourceName="PART_Popup"
                         Property="IsOpen"
                         Value="False">
                    <Setter TargetName="PART_Popup"
                            Property="PopupAnimation"
                            Value="None" />
                </Trigger>
                <DataTrigger Binding="{Binding HighContrast}"
                             Value="True">
                    <Setter TargetName="BackgroundCanvas"
                            Property="Visibility"
                            Value="Collapsed" />
                    <Setter TargetName="PART_Popup"
                            Property="PopupAnimation"
                            Value="None" />
                    <Setter TargetName="Shadow"
                            Property="Color"
                            Value="Transparent" />
                    <Setter TargetName="OuterGrid"
                            Property="TextElement.Foreground"
                            Value="{DynamicResource {x:Static SystemColors.ControlTextBrushKey}}" />
                    <Setter TargetName="PopupBorder"
                            Property="BorderBrush"
                            Value="{DynamicResource {x:Static SystemColors.ControlTextBrushKey}}" />
                    <Setter TargetName="PopupBorder"
                            Property="Background"
                            Value="{DynamicResource {x:Static SystemColors.ControlBrushKey}}" />
                    <Setter TargetName="PopupBorder"
                            Property="CornerRadius"
                            Value="0" />
                    <Setter TargetName="HeaderBorder"
                            Property="BorderBrush"
                            Value="{DynamicResource {x:Static SystemColors.ControlTextBrushKey}}" />
                    <Setter TargetName="HeaderBorder"
                            Property="CornerRadius"
                            Value="0" />
                    <Setter TargetName="HeaderOverlayBorder"
                            Property="BorderBrush"
                            Value="Transparent" />
                    <Setter TargetName="HeaderOverlayBorder"
                            Property="Background"
                            Value="Transparent" />
                    <Setter TargetName="HeaderOverlayBorder"
                            Property="CornerRadius"
                            Value="0" />
                    <Setter TargetName="MainPaneBorder"
                            Property="Background"
                            Value="Transparent" />
                    <Setter TargetName="PART_SubmenuPlaceholder"
                            Property="Background"
                            Value="Transparent" />
                    <Setter TargetName="VerticalBorder"
                            Property="BorderBrush"
                            Value="{DynamicResource {x:Static SystemColors.ControlLightLightBrushKey}}" />
                    <Setter TargetName="VerticalBorder"
                            Property="Background"
                            Value="Transparent" />
                    <Setter TargetName="VerticalOverlayBorder"
                            Property="BorderBrush"
                            Value="Transparent" />
                    <Setter TargetName="FooterBorder"
                            Property="BorderBrush"
                            Value="{DynamicResource {x:Static SystemColors.ControlTextBrushKey}}" />
                    <Setter TargetName="FooterBorder"
                            Property="CornerRadius"
                            Value="0" />
                    <Setter TargetName="FooterOverlayBorder"
                            Property="BorderBrush"
                            Value="Transparent" />
                    <Setter TargetName="FooterOverlayBorder"
                            Property="CornerRadius"
                            Value="0" />
                    <Setter TargetName="FooterBackgroundOverlayBorder"
                            Property="Background"
                            Value="Transparent" />
                    <Setter TargetName="FooterBackgroundOverlayBorder"
                            Property="CornerRadius"
                            Value="0" />
                    <Setter TargetName="ResizeControl"
                            Property="BorderBrush"
                            Value="{DynamicResource {x:Static SystemColors.ControlTextBrushKey}}" />
                    <Setter TargetName="ResizeControl"
                            Property="Background"
                            Value="{DynamicResource {x:Static SystemColors.MenuBrushKey}}" />
                </DataTrigger>
            </ControlTemplate.Triggers>
        </ControlTemplate>
        <!--endregion RibbonApplicationMenuControlTemplate-->
        <!--region RibbonStyle-->
        <Style x:Key="RibbonStyle"
               TargetType="{x:Type r:Ribbon}">
            <Style.Resources>
                <PopupAnimation x:Key="{x:Static SystemParameters.MenuPopupAnimationKey}">Fade</PopupAnimation>
            </Style.Resources>
            <Setter Property="HorizontalContentAlignment"
                    Value="Left" />
            <Setter Property="FocusVisualStyle"
                    Value="{x:Null}" />
            <Setter Property="Background"
                    Value="#FFDFE9F5" />
            <Setter Property="BorderBrush"
                    Value="#FFB9C9DA" />
            <Setter Property="MouseOverBorderBrush"
                    Value="#FFFFB700" />
            <Setter Property="MouseOverBackground">
                <Setter.Value>
                    <LinearGradientBrush StartPoint="0,0"
                                         EndPoint="0,1">
                        <GradientStop Offset="0"
                                      Color="#FFFEFBF4" />
                        <GradientStop Offset="0.19"
                                      Color="#FFFDE7CE" />
                        <GradientStop Offset="0.39"
                                      Color="#FFFDDEB8" />
                        <GradientStop Offset="0.39"
                                      Color="#FFFFCE6B" />
                        <GradientStop Offset="0.79"
                                      Color="#FFFFDE9A" />
                        <GradientStop Offset="1"
                                      Color="#FFFFEBAA" />
                    </LinearGradientBrush>
                </Setter.Value>
            </Setter>
            <Setter Property="PressedBorderBrush"
                    Value="#FFC29B29" />
            <Setter Property="PressedBackground">
                <Setter.Value>
                    <LinearGradientBrush StartPoint="0,0"
                                         EndPoint="0,1">
                        <GradientStop Offset="0"
                                      Color="#FFE3C085" />
                        <GradientStop Offset="0.19"
                                      Color="#FFF4CC89" />
                        <GradientStop Offset="0.36"
                                      Color="#FFF5C777" />
                        <GradientStop Offset="0.36"
                                      Color="#FFF5BB56" />
                        <GradientStop Offset="0.79"
                                      Color="#FFF4CE9A" />
                        <GradientStop Offset="1"
                                      Color="#FFF3E28D" />
                    </LinearGradientBrush>
                </Setter.Value>
            </Setter>
            <Setter Property="CheckedBorderBrush"
                    Value="#FFC29B29" />
            <Setter Property="CheckedBackground">
                <Setter.Value>
                    <LinearGradientBrush StartPoint="0,0"
                                         EndPoint="0,1">
                        <GradientStop Offset="0"
                                      Color="#FFFFDCA0" />
                        <GradientStop Offset="0.18"
                                      Color="#FFFFD692" />
                        <GradientStop Offset="0.39"
                                      Color="#FFFFC45D" />
                        <GradientStop Offset="1"
                                      Color="#FFFFD178" />
                    </LinearGradientBrush>
                </Setter.Value>
            </Setter>
            <Setter Property="FocusedBorderBrush"
                    Value="#FFFFB700" />
            <Setter Property="FocusedBackground">
                <Setter.Value>
                    <LinearGradientBrush StartPoint="0,0"
                                         EndPoint="0,1">
                        <GradientStop Offset="0"
                                      Color="#FFFEFBF4" />
                        <GradientStop Offset="0.19"
                                      Color="#FFFDE7CE" />
                        <GradientStop Offset="0.39"
                                      Color="#FFFDDEB8" />
                        <GradientStop Offset="0.39"
                                      Color="#FFFFCE6B" />
                        <GradientStop Offset="0.79"
                                      Color="#FFFFDE9A" />
                        <GradientStop Offset="1"
                                      Color="#FFFFEBAA" />
                    </LinearGradientBrush>
                </Setter.Value>
            </Setter>
            <Setter Property="FontSize"
                    Value="{DynamicResource {x:Static SystemFonts.MenuFontSizeKey}}" />
            <Setter Property="FontStyle"
                    Value="{DynamicResource {x:Static SystemFonts.MenuFontStyleKey}}" />
            <Setter Property="FontWeight"
                    Value="{DynamicResource {x:Static SystemFonts.MenuFontWeightKey}}" />
            <Setter Property="FontFamily"
                    Value="{DynamicResource {x:Static SystemFonts.MenuFontFamilyKey}}" />
            <Setter Property="Foreground"
                    Value="{DynamicResource {x:Static SystemColors.MenuTextBrushKey}}" />
            <Setter Property="Template">
                <Setter.Value>
                    <ControlTemplate TargetType="{x:Type r:Ribbon}">
                        <Grid SnapsToDevicePixels="True">
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="Auto" />
                                <ColumnDefinition Width="*" />
                                <ColumnDefinition Width="Auto" />
                            </Grid.ColumnDefinitions>
                            <Grid.RowDefinitions>
                                <RowDefinition Height="Auto" />
                                <RowDefinition Height="Auto" />
                                <RowDefinition Height="Auto" />
                                <RowDefinition Height="Auto" />
                            </Grid.RowDefinitions>
                            <Border x:Name="BackgroundBorder"
                                    Grid.Row="1"
                                    Grid.RowSpan="3"
                                    Grid.ColumnSpan="3"
                                    Background="{TemplateBinding Background}"
                                    BorderBrush="{TemplateBinding BorderBrush}" />
                            <Border Grid.Row="1"
                                    Grid.ColumnSpan="3">
                                <Popup x:Name="PART_ITEMSPRESENTERPOPUP"
                                       AllowsTransparency="True"
                                       IsOpen="{Binding IsDropDownOpen, RelativeSource={RelativeSource TemplatedParent}}"
                                       PopupAnimation="{DynamicResource {x:Static SystemParameters.MenuPopupAnimationKey}}">
                                    <themeClassic:SystemDropShadowChrome x:Name="Shdw"
                                                                         Margin="0,0,5,5"
                                                                         Focusable="True"
                                                                         FocusVisualStyle="{x:Null}"
                                                                         RenderOptions.ClearTypeHint="Enabled"
                                                                         Color="Transparent">
                                        <Border x:Name="CollapsedPopupBackgroundBorder"
                                                Background="{TemplateBinding Background}">
                                            <ContentControl x:Name="popupItemsPresenterHost"
                                                            Margin="0,1,0,0"
                                                            Focusable="False"
                                                            KeyboardNavigation.DirectionalNavigation="Cycle"
                                                            KeyboardNavigation.TabNavigation="Cycle" />
                                        </Border>
                                    </themeClassic:SystemDropShadowChrome>
                                </Popup>
                            </Border>
                            <ContentControl x:Name="mainItemsPresenterHost"
                                            Grid.Row="2"
                                            Grid.ColumnSpan="3"
                                            Focusable="False">
                                <Border x:Name="groupsBorder"
                                        Height="91"
                                        BorderBrush="{TemplateBinding BorderBrush}"
                                        BorderThickness="1,0,1,1"
                                        SnapsToDevicePixels="True">
                                    <Border.Background>
                                        <LinearGradientBrush StartPoint="0.5,0"
                                                             EndPoint="0.5,1">
                                            <GradientStop Offset="0"
                                                          Color="#EEFFFFFF" />
                                            <GradientStop Offset="0.1"
                                                          Color="#BBFFFFFF" />
                                            <GradientStop Offset="0.5"
                                                          Color="#05FFFFFF" />
                                            <GradientStop Offset="1"
                                                          Color="#20FFFFFF" />
                                        </LinearGradientBrush>
                                    </Border.Background>
                                    <Border Margin="0,0,0,1"
                                            BorderBrush="#60FFFFFF"
                                            BorderThickness="0,0,0,1"
                                            SnapsToDevicePixels="True">
                                        <ItemsPresenter x:Name="ItemsPresenter" />
                                    </Border>
                                </Border>
                            </ContentControl>
                            <Border x:Name="QatBottomHost"
                                    Grid.Row="3"
                                    Grid.ColumnSpan="3"
                                    BorderBrush="{TemplateBinding BorderBrush}">
                                <ContentPresenter x:Name="QatBottomHostContentPresenter"
                                                  HorizontalAlignment="Left"
                                                  VerticalAlignment="Center"
                                                  IsHitTestVisible="True" />
                            </Border>
                            <Border x:Name="titleBarBackground"
                                    Grid.ColumnSpan="3"
                                    BorderBrush="{TemplateBinding BorderBrush}"
                                    BorderThickness="0,0,0,1"
                                    Visibility="Collapsed">
                                <Border.Background>
                                    <LinearGradientBrush StartPoint="0.5,0"
                                                         EndPoint="0.5,1">
                                        <GradientStop Offset="0"
                                                      Color="#EEFFFFFF" />
                                        <GradientStop Offset="0.1"
                                                      Color="#BBFFFFFF" />
                                        <GradientStop Offset="0.5"
                                                      Color="#05FFFFFF" />
                                        <GradientStop Offset="1"
                                                      Color="#20FFFFFF" />
                                    </LinearGradientBrush>
                                </Border.Background>
                            </Border>
                            <DockPanel Grid.Column="0"
                                       Grid.ColumnSpan="3"
                                       Height="{Binding WindowCaptionHeight}"
                                       LastChildFill="True">
                                <ContentControl x:Name="windowButtonPlaceHolder"
                                                Width="{Binding WindowCaptionButtonsLocation.Width}"
                                                Margin="3,0,0,0"
                                                DockPanel.Dock="Right"
                                                Focusable="False"
                                                IsHitTestVisible="False">
                                    <ContentControl.Visibility>
                                        <TemplateBinding Property="IsHostedInRibbonWindow">
                                            <TemplateBinding.Converter>
                                                <BooleanToVisibilityConverter />
                                            </TemplateBinding.Converter>
                                        </TemplateBinding>
                                    </ContentControl.Visibility>
                                </ContentControl>
                                <ContentControl x:Name="windowIconPadding"
                                                Width="{Binding SmallIconSize.Width}"
                                                Margin="0,0,3,0"
                                                DockPanel.Dock="Left"
                                                Focusable="False"
                                                IsHitTestVisible="False" />
                                <Microsoft_Windows_Controls_Ribbon_Primitives:RibbonTitlePanel x:Name="PART_TitlePanel">
                                    <Grid x:Name="QatTopHost">
                                        <Grid.ColumnDefinitions>
                                            <ColumnDefinition Width="Auto" />
                                            <ColumnDefinition Width="*" />
                                            <ColumnDefinition Width="Auto" />
                                        </Grid.ColumnDefinitions>
                                        <Border x:Name="QatTopHostLeftBorder"
                                                Grid.Column="0"
                                                Width="3"
                                                Margin="8,2,0,2"
                                                Background="#77222222"
                                                BorderBrush="#66CCCCCC"
                                                BorderThickness="1,0,1,0.9"
                                                CornerRadius="0,0,2,2" />
                                        <ContentPresenter x:Name="QatTopHostContentPresenter"
                                                          Grid.Column="1"
                                                          Content="{TemplateBinding QuickAccessToolBar}"
                                                          IsHitTestVisible="True" />
                                        <Border x:Name="QatTopHostRightBorder"
                                                Grid.Column="2"
                                                Width="3"
                                                Margin="0,2,1,2"
                                                Background="#77222222"
                                                BorderBrush="#66CCCCCC"
                                                BorderThickness="1,0,1,0.9"
                                                CornerRadius="0,0,2,2" />
                                    </Grid>
                                    <ContentPresenter x:Name="PART_TitleHost"
                                                      MinWidth="75"
                                                      MinHeight="{Binding WindowCaptionHeight}"
                                                      Margin="3,0"
                                                      HorizontalAlignment="{TemplateBinding HorizontalContentAlignment}"
                                                      Content="{TemplateBinding Title}"
                                                      ContentSource="Title"
                                                      ContentTemplate="{TemplateBinding TitleTemplate}"
                                                      IsHitTestVisible="False"
                                                      TextElement.FontFamily="{DynamicResource {x:Static SystemFonts.CaptionFontFamilyKey}}"
                                                      TextElement.FontSize="{DynamicResource {x:Static SystemFonts.CaptionFontSizeKey}}"
                                                      TextElement.FontWeight="{DynamicResource {x:Static SystemFonts.CaptionFontWeightKey}}"
                                                      TextElement.Foreground="{DynamicResource {x:Static SystemColors.ActiveCaptionTextBrushKey}}">
                                        <ContentPresenter.Resources>
                                            <DataTemplate x:Key="{DataTemplateKey DataType={x:Type System:String}}"
                                                          DataType="{x:Type System:String}">
                                                <TextBlock x:Name="titleTextBlock"
                                                           Margin="0,-2,0,0"
                                                           HorizontalAlignment="{TemplateBinding HorizontalAlignment}"
                                                           Text="{TemplateBinding Content}"
                                                           TextTrimming="CharacterEllipsis" />
                                                <DataTemplate.Triggers>
                                                    <MultiDataTrigger>
                                                        <MultiDataTrigger.Conditions>
                                                            <Condition Binding="{Binding IsGlassEnabled}"
                                                                       Value="True" />
                                                            <Condition Binding="{Binding IsHostedInRibbonWindow, RelativeSource={RelativeSource FindAncestor, AncestorLevel=1, AncestorType={x:Type r:Ribbon}}}"
                                                                       Value="True" />
                                                        </MultiDataTrigger.Conditions>
                                                        <Setter TargetName="titleTextBlock"
                                                                Property="Effect">
                                                            <Setter.Value>
                                                                <DropShadowEffect BlurRadius="5"
                                                                                  ShadowDepth="0"
                                                                                  Color="White" />
                                                            </Setter.Value>
                                                        </Setter>
                                                    </MultiDataTrigger>
                                                    <DataTrigger Binding="{Binding IsGlassEnabled}"
                                                                 Value="False">
                                                        <Setter TargetName="titleTextBlock"
                                                                Property="Margin"
                                                                Value="0" />
                                                        <Setter TargetName="titleTextBlock"
                                                                Property="VerticalAlignment"
                                                                Value="Center" />
                                                    </DataTrigger>
                                                    <DataTrigger Binding="{Binding HighContrast}"
                                                                 Value="True">
                                                        <Setter TargetName="titleTextBlock"
                                                                Property="Margin"
                                                                Value="0,1,0,0" />
                                                    </DataTrigger>
                                                </DataTemplate.Triggers>
                                            </DataTemplate>
                                        </ContentPresenter.Resources>
                                    </ContentPresenter>
                                    <r:RibbonContextualTabGroupItemsControl x:Name="PART_ContextualTabGroupItemsControl"
                                                                            HorizontalAlignment="Center"
                                                                            Custom:WindowChrome.IsHitTestVisibleInChrome="True"
                                                                            IsHitTestVisible="True" />
                                </Microsoft_Windows_Controls_Ribbon_Primitives:RibbonTitlePanel>
                            </DockPanel>
                            <ContentPresenter x:Name="applicationMenu"
                                              Grid.Row="1"
                                              Margin="5,-19,0,0"
                                              HorizontalAlignment="Left"
                                              VerticalAlignment="Stretch"
                                              Content="{TemplateBinding ApplicationMenu}" />
                            <r:RibbonTabHeaderItemsControl x:Name="TabHeaderItemsControl"
                                                           Grid.Row="1"
                                                           Grid.Column="1"
                                                           Margin="1,1,1,0"
                                                           HorizontalAlignment="Left"
                                                           VerticalAlignment="Top" />
                            <ContentPresenter x:Name="PART_HelpPane"
                                              Grid.Row="1"
                                              Grid.Column="2"
                                              HorizontalAlignment="Right"
                                              VerticalAlignment="Top"
                                              Content="{TemplateBinding HelpPaneContent}"
                                              ContentSource="HelpPaneContent"
                                              ContentTemplate="{TemplateBinding HelpPaneContentTemplate}" />
                        </Grid>
                        <ControlTemplate.Triggers>
                            <Trigger Property="IsCollapsed"
                                     Value="True">
                                <Setter TargetName="applicationMenu"
                                        Property="Visibility"
                                        Value="Collapsed" />
                                <Setter TargetName="QatBottomHost"
                                        Property="Visibility"
                                        Value="Collapsed" />
                                <Setter TargetName="QatTopHost"
                                        Property="Visibility"
                                        Value="Collapsed" />
                                <Setter TargetName="mainItemsPresenterHost"
                                        Property="Visibility"
                                        Value="Collapsed" />
                                <Setter TargetName="TabHeaderItemsControl"
                                        Property="Visibility"
                                        Value="Collapsed" />
                                <Setter TargetName="PART_HelpPane"
                                        Property="Visibility"
                                        Value="Collapsed" />
                                <Setter TargetName="PART_ContextualTabGroupItemsControl"
                                        Property="Visibility"
                                        Value="Collapsed" />
                                <Setter TargetName="PART_TitleHost"
                                        Property="MinWidth"
                                        Value="0" />
                            </Trigger>
                            <MultiTrigger>
                                <MultiTrigger.Conditions>
                                    <Condition Property="IsCollapsed"
                                               Value="True" />
                                    <Condition Property="IsHostedInRibbonWindow"
                                               Value="False" />
                                </MultiTrigger.Conditions>
                                <Setter Property="Visibility"
                                        Value="Collapsed" />
                            </MultiTrigger>
                            <Trigger Property="ShowQuickAccessToolBarOnTop"
                                     Value="False">
                                <Setter TargetName="QatTopHostContentPresenter"
                                        Property="Content"
                                        Value="{x:Null}" />
                                <Setter TargetName="QatTopHost"
                                        Property="Visibility"
                                        Value="Collapsed" />
                                <Setter TargetName="QatBottomHostContentPresenter"
                                        Property="Content"
                                        Value="{Binding QuickAccessToolBar, RelativeSource={RelativeSource TemplatedParent}}" />
                                <Setter TargetName="BackgroundBorder"
                                        Property="BorderThickness"
                                        Value="0,0,0,1" />
                            </Trigger>
                            <MultiDataTrigger>
                                <MultiDataTrigger.Conditions>
                                    <Condition Binding="{Binding QuickAccessToolBar.HasItems, RelativeSource={RelativeSource Self}}"
                                               Value="False" />
                                    <Condition Binding="{Binding QuickAccessToolBar.CustomizeMenuButton, RelativeSource={RelativeSource Self}}"
                                               Value="{x:Null}" />
                                </MultiDataTrigger.Conditions>
                                <Setter TargetName="QatTopHost"
                                        Property="Visibility"
                                        Value="Collapsed" />
                                <Setter TargetName="QatBottomHost"
                                        Property="Visibility"
                                        Value="Collapsed" />
                            </MultiDataTrigger>
                            <Trigger Property="IsMinimized"
                                     Value="True">
                                <Setter TargetName="mainItemsPresenterHost"
                                        Property="Content"
                                        Value="{x:Null}" />
                                <Setter TargetName="mainItemsPresenterHost"
                                        Property="Visibility"
                                        Value="Collapsed" />
                                <Setter TargetName="popupItemsPresenterHost"
                                        Property="Content"
                                        Value="{Binding ElementName=groupsBorder}" />
                                <Setter TargetName="BackgroundBorder"
                                        Property="BorderThickness"
                                        Value="0,0,0,1" />
                                <Setter TargetName="TabHeaderItemsControl"
                                        Property="Margin"
                                        Value="1,1,1,-1" />
                                <Setter TargetName="BackgroundBorder"
                                        Property="Margin"
                                        Value="0,0,0,-2" />
                                <Setter TargetName="CollapsedPopupBackgroundBorder"
                                        Property="Margin"
                                        Value="0,-1,0,0" />
                            </Trigger>
                            <Trigger Property="WindowIconVisibility"
                                     Value="Collapsed">
                                <Setter TargetName="windowIconPadding"
                                        Property="Visibility"
                                        Value="Collapsed" />
                                <Setter TargetName="QatTopHostLeftBorder"
                                        Property="Visibility"
                                        Value="Collapsed" />
                            </Trigger>
                            <MultiTrigger>
                                <MultiTrigger.Conditions>
                                    <Condition Property="IsMinimized"
                                               Value="True" />
                                    <Condition Property="ShowQuickAccessToolBarOnTop"
                                               Value="False" />
                                </MultiTrigger.Conditions>
                                <Setter TargetName="QatBottomHost"
                                        Property="BorderThickness"
                                        Value="0,1,0,0" />
                            </MultiTrigger>
                            <Trigger Property="IsHostedInRibbonWindow"
                                     Value="False">
                                <Setter TargetName="BackgroundBorder"
                                        Property="Grid.Row"
                                        Value="0" />
                                <Setter TargetName="BackgroundBorder"
                                        Property="Grid.RowSpan"
                                        Value="4" />
                                <Setter TargetName="titleBarBackground"
                                        Property="Visibility"
                                        Value="Visible" />
                                <Setter TargetName="windowIconPadding"
                                        Property="Visibility"
                                        Value="Collapsed" />
                                <Setter TargetName="QatTopHostLeftBorder"
                                        Property="Visibility"
                                        Value="Collapsed" />
                            </Trigger>
                            <Trigger Property="IsDropDownOpen"
                                     Value="True">
                                <Setter TargetName="BackgroundBorder"
                                        Property="BorderThickness"
                                        Value="0" />
                            </Trigger>
                            <Trigger SourceName="PART_ITEMSPRESENTERPOPUP"
                                     Property="HasDropShadow"
                                     Value="True">
                                <Setter TargetName="Shdw"
                                        Property="Color"
                                        Value="#71000000" />
                            </Trigger>
                            <MultiDataTrigger>
                                <MultiDataTrigger.Conditions>
                                    <Condition Binding="{Binding IsActive, RelativeSource={RelativeSource FindAncestor, AncestorLevel=1, AncestorType={x:Type r:RibbonWindow}}}"
                                               Value="False" />
                                    <Condition Binding="{Binding IsGlassEnabled}"
                                               Value="False" />
                                    <Condition Binding="{Binding IsHostedInRibbonWindow, RelativeSource={RelativeSource Self}}"
                                               Value="True" />
                                </MultiDataTrigger.Conditions>
                                <Setter TargetName="PART_TitleHost"
                                        Property="TextElement.Foreground"
                                        Value="{DynamicResource {x:Static SystemColors.InactiveCaptionTextBrushKey}}" />
                            </MultiDataTrigger>
                            <DataTrigger Binding="{Binding HighContrast}"
                                         Value="True">
                                <Setter TargetName="BackgroundBorder"
                                        Property="Background"
                                        Value="{DynamicResource {x:Static SystemColors.ControlBrushKey}}" />
                                <Setter TargetName="BackgroundBorder"
                                        Property="BorderBrush"
                                        Value="{DynamicResource {x:Static SystemColors.ControlDarkBrushKey}}" />
                                <Setter TargetName="groupsBorder"
                                        Property="Background"
                                        Value="Transparent" />
                                <Setter TargetName="groupsBorder"
                                        Property="BorderBrush"
                                        Value="{DynamicResource {x:Static SystemColors.ControlDarkBrushKey}}" />
                                <Setter TargetName="groupsBorder"
                                        Property="Height"
                                        Value="94" />
                                <Setter TargetName="QatBottomHost"
                                        Property="BorderBrush"
                                        Value="{DynamicResource {x:Static SystemColors.ControlDarkBrushKey}}" />
                                <Setter TargetName="titleBarBackground"
                                        Property="Background"
                                        Value="Transparent" />
                                <Setter TargetName="titleBarBackground"
                                        Property="BorderBrush"
                                        Value="{DynamicResource {x:Static SystemColors.ControlDarkBrushKey}}" />
                                <Setter TargetName="CollapsedPopupBackgroundBorder"
                                        Property="Background"
                                        Value="{DynamicResource {x:Static SystemColors.ControlBrushKey}}" />
                                <Setter TargetName="PART_ITEMSPRESENTERPOPUP"
                                        Property="PopupAnimation"
                                        Value="None" />
                                <Setter TargetName="QatTopHostLeftBorder"
                                        Property="Margin"
                                        Value="10,1,2,2" />
                                <Setter TargetName="QatTopHostLeftBorder"
                                        Property="Width"
                                        Value="1" />
                                <Setter TargetName="QatTopHostLeftBorder"
                                        Property="BorderThickness"
                                        Value="0" />
                                <Setter TargetName="QatTopHostLeftBorder"
                                        Property="CornerRadius"
                                        Value="0" />
                                <Setter TargetName="QatTopHostLeftBorder"
                                        Property="Background"
                                        Value="{DynamicResource {x:Static SystemColors.ControlDarkDarkBrushKey}}" />
                                <Setter TargetName="QatTopHostRightBorder"
                                        Property="Margin"
                                        Value="0,1,2,2" />
                                <Setter TargetName="QatTopHostRightBorder"
                                        Property="Width"
                                        Value="1" />
                                <Setter TargetName="QatTopHostRightBorder"
                                        Property="BorderThickness"
                                        Value="0" />
                                <Setter TargetName="QatTopHostRightBorder"
                                        Property="CornerRadius"
                                        Value="0" />
                                <Setter TargetName="QatTopHostRightBorder"
                                        Property="Background"
                                        Value="{DynamicResource {x:Static SystemColors.ControlDarkDarkBrushKey}}" />
                            </DataTrigger>
                            <DataTrigger Binding="{Binding UxThemeName}"
                                         Value="Aero">
                                <Setter TargetName="QatTopHost"
                                        Property="Margin"
                                        Value="0,-3,0,0" />
                                <Setter TargetName="QatTopHostLeftBorder"
                                        Property="Margin"
                                        Value="3,3,0,5" />
                                <Setter TargetName="QatTopHostLeftBorder"
                                        Property="Background"
                                        Value="#81444444" />
                                <Setter TargetName="QatTopHostLeftBorder"
                                        Property="BorderBrush"
                                        Value="#69EEEEEE" />
                                <Setter TargetName="QatTopHostRightBorder"
                                        Property="Margin"
                                        Value="0,3,1,5" />
                                <Setter TargetName="QatTopHostRightBorder"
                                        Property="Background"
                                        Value="#81444444" />
                                <Setter TargetName="QatTopHostRightBorder"
                                        Property="BorderBrush"
                                        Value="#69EEEEEE" />
                            </DataTrigger>
                            <MultiDataTrigger>
                                <MultiDataTrigger.Conditions>
                                    <Condition Binding="{Binding UxThemeName}"
                                               Value="Aero" />
                                    <Condition Binding="{Binding WindowState, RelativeSource={RelativeSource FindAncestor, AncestorLevel=1, AncestorType={x:Type r:RibbonWindow}}}"
                                               Value="Maximized" />
                                </MultiDataTrigger.Conditions>
                                <Setter TargetName="QatTopHost"
                                        Property="Margin"
                                        Value="0" />
                            </MultiDataTrigger>
                        </ControlTemplate.Triggers>
                    </ControlTemplate>
                </Setter.Value>
            </Setter>
        </Style>
        <Style x:Key="StatusBarItem"
        	TargetType="{x:Type StatusBarItem}">
        	<Setter Property="Padding"
        		Value="1" />
        	<Setter Property="Background"
        		Value="Transparent" />
        	<Setter Property="HorizontalContentAlignment"
        		Value="Left" />
        	<Setter Property="VerticalContentAlignment"
        		Value="Center" />
        	<Setter Property="Template">
        		<Setter.Value>
        			<ControlTemplate TargetType="{x:Type StatusBarItem}">
        				<Border BorderBrush="{DynamicResource Bottom_TitleBar_Border}"
        					BorderThickness="1,1,0,0">
        					<Border Width="Auto"
        						Height="Auto"
        						Background="{TemplateBinding Background}"
        						BorderBrush="{DynamicResource Bottom_TitleBar_Border2}"
        						BorderThickness="0,0,1,1"
        						SnapsToDevicePixels="true">
        						<ContentPresenter HorizontalAlignment="{TemplateBinding HorizontalContentAlignment}"
        							VerticalAlignment="{TemplateBinding VerticalContentAlignment}"
        							SnapsToDevicePixels="{TemplateBinding SnapsToDevicePixels}" />
        					</Border>
        				</Border>
        				<ControlTemplate.Triggers>
        					<Trigger Property="IsEnabled"
        						Value="false">
        						<Setter Property="Foreground"
        							Value="{DynamicResource {x:Static SystemColors.GrayTextBrushKey}}" />
        					</Trigger>
        				</ControlTemplate.Triggers>
        			</ControlTemplate>
        		</Setter.Value>
        	</Setter>
        </Style>
        <Style x:Key="StatusBarItemTextBlock"
        	TargetType="{x:Type TextBlock}">
        	<Setter Property="TextWrapping"
        		Value="NoWrap" />
        	<Setter Property="TextTrimming"
        		Value="None" />
        	<Setter Property="FontSize"
        		Value="11" />
        	<Setter Property="Foreground"
        		Value="{DynamicResource Bottom_TitleBar_Foreground}" />
        	<Setter Property="FontFamily"
        		Value="Tahoma" />
        </Style>
        <!--endregion RibbonStyle-->        
    </r:RibbonWindow.Resources>
    <r:RibbonWindow.InputBindings>
        <KeyBinding Modifiers="Alt" Key="E"  Command="{Binding EditReportCommand}" />
        <KeyBinding Modifiers="Alt" Key="N" Command="{Binding NewReportCommand}" />
        <KeyBinding Modifiers="Alt" Key="D"  Command="{Binding DeleteReportCommand}" />
        <KeyBinding Modifiers="Alt" Key="H" Command="{Binding NoShowReportCommand}" />
        <KeyBinding Modifiers="Alt" Key="S"  Command="{Binding SaveReportCommand}" />
        <KeyBinding Modifiers="Alt" Key="V" Command="{Binding PreviewReportCommand}" />
        <KeyBinding Modifiers="Alt" Key="P" Command="{Binding PrintDirectCommand}" />
        <KeyBinding Modifiers="Alt" Key="G" Command="{Binding ChangeGroupReportCommand}" />
        <KeyBinding Modifiers="Alt" Key="A"  Command="{Binding ReportPermissionCommand}" />
        <KeyBinding Modifiers="Alt" Key="C" Command="{Binding ChangePasswordCommand}" />
        <KeyBinding Modifiers="Alt" Key="U"  Command="{Binding PermissionCommand}" />
        <KeyBinding Modifiers="Alt" Key="L"  Command="{Binding LogOutCommand}" />
        <KeyBinding Key="F3"  Command="{Binding OpenShorcutViewCommand}" />                    
    </r:RibbonWindow.InputBindings>
    <ExtendWPFToolKit:BusyIndicator IsBusy="{Binding IsBuzy,Mode=OneWay}">
        <Grid x:Name="LayoutRoot">
            <Grid.RowDefinitions>
                <RowDefinition Height="Auto" />
                <RowDefinition Height="*" />
            </Grid.RowDefinitions>
            <r:Ribbon DockPanel.Dock="Top"
                      Background="{DynamicResource Ribbon_Tab_Background}"
                      BorderBrush="{DynamicResource Ribbon_Tab_Border}"
                      FontFamily="Tahoma"
                      FontSize="11"
                      Foreground="{DynamicResource Ribbon_Tab_Foreground}"
                      IsMinimized="True"
                      Style="{DynamicResource RibbonStyle}"
                      WindowIconVisibility="Hidden">
                <r:Ribbon.TitleTemplate>
                    <DataTemplate>
                        <Grid Height="22">
                            <TextBlock Width="{Binding ActualWidth, ElementName=Window}"
                                       Margin="0,0,0,0"
                                       VerticalAlignment="Center"
                                       FontFamily="Tahoma"
                                       FontSize="12"
                                       Foreground="White"
                                       Padding="0,0,0,4"
                                       TextAlignment="Center"><Run Text="POS Report" />
                            </TextBlock>
                        </Grid>
                    </DataTemplate>

                </r:Ribbon.TitleTemplate>
                <r:Ribbon.ApplicationMenu>
                    <r:RibbonApplicationMenu Width="36"
                                             Height="36"
                                             CanUserResizeVertically="True" 
                                             CanUserResizeHorizontally="True"
                                             CanAddToQuickAccessToolBarDirectly="False"                                             
                                             Background="{DynamicResource ApplicationMenuToggleButton_Background}"
                                             BorderBrush="{DynamicResource ApplicationMenuToggleButton_Border}"
                                             Template="{DynamicResource RibbonApplicationMenuControlTemplate}">
                        <r:RibbonApplicationMenuItem ImageSource="\Image\RibbonImages\Gray\RibbonChangePassword.png"
                                                     Header="Change Password (Alt + C)"
                                                     Command="{Binding ChangePasswordCommand}" />
                        <r:RibbonApplicationMenuItem ImageSource="\Image\RibbonImages\Gray\RibbonCreateWorkPermission.png"
                                                     Header="Permission (Alt + U)"
                                                     Command="{Binding PermissionCommand}" />
                        <r:RibbonApplicationMenuItem ImageSource="\Image\RibbonImages\Gray\RibbonLogout.png"
                                                     Header="Log Out (Alt + L)"
                                                     Command="{Binding LogOutCommand}" />
                        <r:RibbonSeparator />
                        <r:RibbonApplicationMenuItem ImageSource="\Image\RibbonImages\Gray\RibbonExit.png"
                                                     Header="Exit Application"
                                                     Click="Exit_Click"
                                                     Command="{Binding ExitCommand}" />											 
                    </r:RibbonApplicationMenu>
                </r:Ribbon.ApplicationMenu>
            </r:Ribbon>

            <Grid x:Name="grdMain" Grid.Row="1" Background="{DynamicResource UserControl_Background_ReportImage}">
            	<Grid.RowDefinitions>
            		 <RowDefinition x:Name="RibbonRow"
                                   Height="Auto" />
                    <RowDefinition x:Name="ClientRow" />
                    <RowDefinition x:Name="StatusRow"
                                   Height="Auto" />
            	</Grid.RowDefinitions>
                <Border x:Name="brdSubReport"
                        Margin="5"
                        BorderBrush="{DynamicResource TabControlBorder}"
                        BorderThickness="1"
                        Background="{DynamicResource TabControlBackground}" Grid.Row="1">
                    <Grid x:Name="grdSubReport">
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="270" />
                            <ColumnDefinition Width="*" />
                        </Grid.ColumnDefinitions>

                        <TabControl ItemsSource="{Binding GroupReportModelCollection}"
                                    SelectedValuePath="Id"
                                    DisplayMemberPath="Name"
                                    IsSynchronizedWithCurrentItem="True"
                                    SelectedItem="{Binding GroupReportModel}"
                                    Margin="5"
                                    x:Name="TabReport">
                            <TabControl.ContentTemplate>
                                <DataTemplate>
                                    <TreeView x:Name="tvReport1"
                                              ContextMenu="{StaticResource contextTreeView}"
                                              Tag="{Binding DataContext, RelativeSource={RelativeSource AncestorType=TabControl}}"
                                              Background="#00000000"
                                              BorderBrush="#00000000"
                                              ItemsSource="{Binding RootReportColection}">
                                        <TreeView.Resources>
                                            <function:BindingProxy x:Key="proxy"
                                                                   Data="{Binding}" />
                                            <HierarchicalDataTemplate DataType="{x:Type obj:rpt_ReportModel}"
                                                                      ItemsSource="{Binding Children}">
                                                <StackPanel x:Name="stkpTreeviewItem1"
                                                            HorizontalAlignment="Left"
                                                            Orientation="Horizontal">
                                                    <!--<Rectangle x:Name="OpenFolder" Fill="{DynamicResource OpenFoler}" Height="13" Width="13" Visibility="{Binding IsShowOpenFolder}"/>-->
                                                    <Rectangle x:Name="CloseFolder"
                                                               Fill="{DynamicResource CloseFolder}"
                                                               Height="13"
                                                               Width="13"
                                                               Visibility="{Binding IsShowCloseFolder}" />
                                                    <Rectangle Fill="{DynamicResource Document}"
                                                               Height="10"
                                                               Width="10"
                                                               Visibility="{Binding IsShowDocument}" />
                                                    <Rectangle x:Name="OK"
                                                               Fill="{DynamicResource OK}"
                                                               Height="10"
                                                               Width="10"
                                                               Visibility="{Binding IsShowOK}" />
                                                    <TextBlock TextWrapping="NoWrap"
                                                               VerticalAlignment="Center"
                                                               HorizontalAlignment="Left"
                                                               Text="{Binding Path=Name}"
                                                               Style="{DynamicResource TreeviewItemTextBlock}"
                                                               Margin="3,0,0,0" />
                                                </StackPanel>
                                            </HierarchicalDataTemplate>
                                        </TreeView.Resources>
                                        <i:Interaction.Triggers>
                                            <i:EventTrigger EventName="SelectedItemChanged">
                                                <i:InvokeCommandAction Command="{Binding DataContext.SelectedItemChanged,RelativeSource={RelativeSource Mode=FindAncestor,AncestorLevel=1,AncestorType=Window}}"
                                                                       CommandParameter="{Binding ElementName=tvReport1}"></i:InvokeCommandAction>
                                            </i:EventTrigger>
                                            <i:EventTrigger EventName="GotFocus">
                                                <i:InvokeCommandAction Command="{Binding DataContext.GotFocusCommand,RelativeSource={RelativeSource Mode=FindAncestor,AncestorLevel=1,AncestorType=Window}}"
                                                                       CommandParameter="{Binding ElementName=tvReport1}"></i:InvokeCommandAction>
                                            </i:EventTrigger>
                                        </i:Interaction.Triggers>
                                    </TreeView>
                                </DataTemplate>
                            </TabControl.ContentTemplate>
                            <i:Interaction.Triggers>
                                <i:EventTrigger EventName="SelectionChanged">
                                    <i:InvokeCommandAction Command="{Binding DataContext.ChangeMajorGroupCommand,RelativeSource={RelativeSource AncestorLevel=1,AncestorType=Window,Mode=FindAncestor}}"
                                                           CommandParameter="{Binding SelectedItem, ElementName=TabReport}">
                                    </i:InvokeCommandAction>
                                </i:EventTrigger>
                            </i:Interaction.Triggers>
                        </TabControl>

                        <Rectangle Fill="{DynamicResource Spilter_Line_Background}"
                                   HorizontalAlignment="Right"
                                   x:Name="LineSpliter"
                                   Margin="0"
                                   Width="1" />
                        <Grid x:Name="grdReport"
                              Grid.Column="1">
                            <Grid x:Name="grdContentReport"
                                  Background="#19FFFFFF">
                                <Grid.RowDefinitions>
                                    <RowDefinition Height="Auto" />
                                    <RowDefinition />
                                </Grid.RowDefinitions>
                                <Grid x:Name="grdSubContentReport">
                                    <Grid.RowDefinitions>
                                        <RowDefinition Height="163" />
                                        <RowDefinition Height="50" />
                                    </Grid.RowDefinitions>
                                    <GroupBox Visibility="{Binding IsShowPrintProperty}"
                                              x:Name="gbPrintProperty"
                                              Margin="10,10,10,0"
                                              VerticalAlignment="Top"
                                              Height="152">
                                        <GroupBox.Header>
                                            <StackPanel x:Name="stkpPrintProperty"
                                                        Orientation="Horizontal">
                                                <TextBlock x:Name="txtblPrintProperties"
                                                           Text="Print Properties:"
                                                           TextWrapping="NoWrap"
                                                           Style="{DynamicResource GroupboxTextBlock}"
                                                           d:LayoutOverrides="Width" />
                                                <TextBlock x:Name="txtblBindingPrintProperties"
                                                           Text="{Binding ReportModel.Name}"
                                                           TextWrapping="NoWrap"
                                                           Style="{DynamicResource GroupboxTextBlock}"
                                                           d:LayoutOverrides="Width"
                                                           Margin="5,0,0,0" />
                                            </StackPanel>
                                        </GroupBox.Header>
                                        <Grid x:Name="grdContentPrintProperty"
                                              d:LayoutOverrides="GridBox"
                                              Margin="0,4,0,0">
                                            <Grid.ColumnDefinitions>
                                                <ColumnDefinition Width="95" />
                                                <ColumnDefinition />
                                            </Grid.ColumnDefinitions>
                                            <Grid.RowDefinitions>
                                                <RowDefinition Height="25" />
                                                <RowDefinition Height="25" />
                                                <RowDefinition Height="25" />
                                                <RowDefinition Height="25" />
                                                <RowDefinition Height="25" />
                                            </Grid.RowDefinitions>
                                            <TextBlock x:Name="txtblPrinterName1"
                                                       Text="Printer Name:"
                                                       TextWrapping="NoWrap"
                                                       HorizontalAlignment="Left"
                                                       Style="{DynamicResource TextBlockNormal}"
                                                       VerticalAlignment="Center"
                                                       Margin="10,0,0,0" />
                                            <TextBlock x:Name="txtblBindingPrinterName"
                                                       Text="{Binding CurrentPrinter}"
                                                       TextWrapping="NoWrap"
                                                       FontWeight="Bold"
                                                       HorizontalAlignment="Left"
                                                       Style="{DynamicResource TextBlockNormal}"
                                                       VerticalAlignment="Center"
                                                       Margin="0"
                                                       Grid.Column="2" />
                                            <TextBlock x:Name="txtblPaperSize1"
                                                       Text="Paper Size:"
                                                       TextWrapping="NoWrap"
                                                       HorizontalAlignment="Left"
                                                       Style="{DynamicResource TextBlockNormal}"
                                                       VerticalAlignment="Center"
                                                       Margin="10,0,0,0"
                                                       Grid.Row="1" />
                                            <TextBlock x:Name="txtblBindingPaperSize"
                                                       Text="{Binding ReportModel.PaperName}"
                                                       TextWrapping="NoWrap"
                                                       FontWeight="Bold"
                                                       HorizontalAlignment="Left"
                                                       Style="{DynamicResource TextBlockNormal}"
                                                       VerticalAlignment="Center"
                                                       Margin="0"
                                                       Grid.Row="1"
                                                       Grid.Column="1" />
                                            <TextBlock x:Name="txtblNoCopy1"
                                                       Text="No. Copy:"
                                                       TextWrapping="NoWrap"
                                                       HorizontalAlignment="Left"
                                                       Style="{DynamicResource TextBlockNormal}"
                                                       VerticalAlignment="Center"
                                                       Margin="175,0,0,0"
                                                       Grid.Row="1"
                                                       Grid.Column="1" />
                                            <TextBlock x:Name="txtblBindingNoCopy"
                                                       Text="{Binding ReportModel.PrintCopy}"
                                                       TextWrapping="NoWrap"
                                                       FontWeight="Bold"
                                                       HorizontalAlignment="Left"
                                                       Style="{DynamicResource TextBlockNormal}"
                                                       VerticalAlignment="Center"
                                                       Margin="235,0,0,0"
                                                       Grid.Row="1"
                                                       Grid.Column="1" />
                                            <TextBlock x:Name="txtblPrintTimes"
                                                       Text="Print Times:"
                                                       TextWrapping="NoWrap"
                                                       HorizontalAlignment="Left"
                                                       Style="{DynamicResource TextBlockNormal}"
                                                       VerticalAlignment="Center"
                                                       Margin="10,0,0,0"
                                                       Grid.Row="2" />
                                            <TextBlock x:Name="txtblBindingPrintTimes"
                                                       Text="{Binding ReportModel.PrintTimes}"
                                                       TextWrapping="NoWrap"
                                                       FontWeight="Bold"
                                                       HorizontalAlignment="Left"
                                                       Style="{DynamicResource TextBlockNormal}"
                                                       VerticalAlignment="Center"
                                                       Margin="0"
                                                       Grid.Row="2"
                                                       Grid.Column="1" />
                                            <TextBlock x:Name="txtblScreenTimes"
                                                       Text="Screen Times:"
                                                       TextWrapping="NoWrap"
                                                       HorizontalAlignment="Left"
                                                       Style="{DynamicResource TextBlockNormal}"
                                                       VerticalAlignment="Center"
                                                       Margin="175,0,0,0"
                                                       Grid.Row="2"
                                                       Grid.Column="1" />

                                            <TextBlock x:Name="txtblBindingScreenTimes"
                                                       Text="{Binding ReportModel.ScreenTimes}"
                                                       TextWrapping="NoWrap"
                                                       FontWeight="Bold"
                                                       HorizontalAlignment="Left"
                                                       Style="{DynamicResource TextBlockNormal}"
                                                       VerticalAlignment="Center"
                                                       Margin="250,0,0,0"
                                                       Grid.Row="2"
                                                       Grid.Column="1" />
                                            <TextBlock x:Name="txtblReportFile1"
                                                       Text="Report File:"
                                                       TextWrapping="NoWrap"
                                                       HorizontalAlignment="Left"
                                                       Style="{DynamicResource TextBlockNormal}"
                                                       VerticalAlignment="Center"
                                                       Margin="10,0,0,0"
                                                       Grid.Row="3" />
                                            <TextBlock x:Name="txtblBindingReportFile"
                                                       Text="{Binding ReportModel.FormatFile}"
                                                       TextWrapping="NoWrap"
                                                       FontWeight="Bold"
                                                       HorizontalAlignment="Left"
                                                       Style="{DynamicResource TextBlockNormal}"
                                                       VerticalAlignment="Center"
                                                       Margin="0"
                                                       Grid.Row="3"
                                                       Grid.Column="1" />
                                            <TextBlock x:Name="txtblLastUpdateBy"
                                                       Text="Last Update By:"
                                                       TextWrapping="NoWrap"
                                                       HorizontalAlignment="Left"
                                                       Style="{DynamicResource TextBlockNormal}"
                                                       VerticalAlignment="Center"
                                                       Margin="10,0,0,0"
                                                       Grid.Row="4" />
                                            <TextBlock x:Name="txtblBindingLastUpdateBy"
                                                       TextWrapping="NoWrap"
                                                       FontWeight="Bold"
                                                       HorizontalAlignment="Left"
                                                       Style="{DynamicResource TextBlockNormal}"
                                                       VerticalAlignment="Center"
                                                       Margin="0"
                                                       Grid.Row="4"
                                                       Grid.Column="1">
                                        <TextBlock.Text>    
                                            <MultiBinding StringFormat="{}{0} {1}">
                                                <Binding Path="ReportModel.UserUpdated" />
                                                <Binding Path="ReportModel.DateUpdated" />
                                            </MultiBinding>
                                        </TextBlock.Text>
                                            </TextBlock>
                                        </Grid>
                                    </GroupBox>
                                    <StackPanel VerticalAlignment="Center"
                                                Visibility="{Binding IsShowPrintButtonGroup}"
                                                Height="Auto"
                                                x:Name="stkpBtnReport"
                                                Orientation="Horizontal"
                                                HorizontalAlignment="Left"
                                                Margin="10,0,0,0"
                                                Grid.Row="1"
                                                Width="478">
                                        <Button Command="{Binding PrintPropertyCommand}"
                                                Visibility="{Binding IsShowPrintButtonGroup}"
                                                x:Name="btnPrintProperty"
                                                Height="28"
                                                Width="110"
                                                Margin="0">
                                            <StackPanel HorizontalAlignment="Center"
                                                        x:Name="stkpBtnPrintProperty"
                                                        VerticalAlignment="Center"
                                                        Orientation="Horizontal">
                                                <Rectangle x:Name="imgPrintProperty"
                                                           Fill="{DynamicResource PrintProperties}"
                                                           Height="20"
                                                           Width="20" />
                                                <TextBlock Margin="5,0,0,0"
                                                           x:Name="txtblPrintProperty"
                                                           VerticalAlignment="Center"
                                                           Text="Print Property"
                                                           TextWrapping="NoWrap"
                                                           Style="{DynamicResource ButtonTextBlock}" />
                                            </StackPanel>
                                        </Button>
                                        <Button Command="{Binding PrintDirectCommand}"
                                                Visibility="{Binding IsShowPrintButtonGroup}"
                                                x:Name="btnPrintDirect"
                                                Height="28"
                                                Width="112"
                                                Margin="10,0,0,0">
                                            <StackPanel HorizontalAlignment="Center"
                                                        x:Name="stkpBtnPrintDirect"
                                                        VerticalAlignment="Center"
                                                        Orientation="Horizontal">
                                                <Rectangle x:Name="imgPrintDirect"
                                                           Fill="{DynamicResource Print}"
                                                           Height="20"
                                                           Width="20" />
                                                <TextBlock Margin="5,0,0,0"
                                                           VerticalAlignment="Center"
                                                           Text="Print Direct"
                                                           TextWrapping="NoWrap"
                                                           x:Name="txtblPrintDirect"
                                                           Style="{DynamicResource ButtonTextBlock}" />
                                            </StackPanel>
                                        </Button>
                                        <Button Command="{Binding ScreenCommand}"
                                                Visibility="{Binding IsShowPrintButtonGroup}"
                                                x:Name="btnScreen"
                                                Height="28"
                                                Width="112"
                                                Margin="10,0,0,0">
                                            <StackPanel HorizontalAlignment="Center"
                                                        x:Name="stkpBtnScreen"
                                                        VerticalAlignment="Center"
                                                        Orientation="Horizontal">
                                                <Rectangle x:Name="imgScreen"
                                                           Fill="{DynamicResource Screen}"
                                                           Height="20"
                                                           Width="20" />
                                                <TextBlock Margin="5,0,0,0"
                                                           VerticalAlignment="Center"
                                                           Text="Screen"
                                                           TextWrapping="NoWrap"
                                                           x:Name="txtblScreen"
                                                           Style="{DynamicResource ButtonTextBlock}" />
                                            </StackPanel>
                                        </Button>
                                        <Button Command="{Binding SetCopyCommand}"
                                                Visibility="{Binding IsShowPrintButtonGroup}"
                                                x:Name="btnSetCopy"
                                                Height="28"
                                                Width="112"
                                                Margin="10,0,0,0">
                                            <StackPanel HorizontalAlignment="Center"
                                                        x:Name="stkpBtnSetCopy"
                                                        VerticalAlignment="Center"
                                                        Orientation="Horizontal">
                                                <Rectangle x:Name="imgSetCopy"
                                                           Fill="{DynamicResource SetCopy}"
                                                           Height="20"
                                                           Width="20" />
                                                <TextBlock Margin="5,0,0,0"
                                                           VerticalAlignment="Center"
                                                           Text="Set Copies"
                                                           TextWrapping="NoWrap"
                                                           x:Name="txtblSetCopy"
                                                           Style="{DynamicResource ButtonTextBlock}" />
                                            </StackPanel>
                                        </Button>
                                    </StackPanel>
                                </Grid>
                                <Grid x:Name="grdPrintProperty">
                                    <Grid.RowDefinitions>
                                        <RowDefinition Height="87" />
                                        <RowDefinition Height="50" />
                                    </Grid.RowDefinitions>
                                    <GroupBox Visibility="{Binding IsShowChangePrintProperty}"
                                              x:Name="gbChangePrintProperty"
                                              Margin="10,10,10,0"
                                              VerticalAlignment="Top">
                                        <GroupBox.Header>
                                            <TextBlock x:Name="txtblChangePrintProperty"
                                                       Text="Change Print Property"
                                                       TextWrapping="NoWrap"
                                                       Style="{DynamicResource GroupboxTextBlock}" />
                                        </GroupBox.Header>
                                        <Grid x:Name="grdContentChangePrintProperty"
                                              d:LayoutOverrides="GridBox"
                                              Margin="0,4,0,0">
                                            <Grid.ColumnDefinitions>
                                                <ColumnDefinition Width="90" />
                                                <ColumnDefinition />
                                            </Grid.ColumnDefinitions>
                                            <Grid.RowDefinitions>
                                                <RowDefinition Height="25" />
                                                <RowDefinition Height="25" />
                                                <RowDefinition Height="0" />
                                            </Grid.RowDefinitions>
                                            <TextBlock x:Name="txtblPrinterName2"
                                                       Text="Printer Name"
                                                       TextWrapping="NoWrap"
                                                       HorizontalAlignment="Left"
                                                       Style="{DynamicResource TextBlockNormal}"
                                                       VerticalAlignment="Center"
                                                       Margin="10,0,0,0" />
                                            <ComboBox x:Name="cmbPrinterName2"
                                                      ItemsSource="{Binding InstalledPrinters}"
                                                      SelectedItem="{Binding ReportModel.PrinterName, UpdateSourceTrigger=PropertyChanged,Mode=TwoWay}"
                                                      Margin="0,2,10,2"
                                                      Grid.Column="1"
                                                      Width="250"
                                                      HorizontalAlignment="Left" />
                                            <TextBlock x:Name="txtblNoCopy2"
                                                       Text="No. Copy"
                                                       TextWrapping="NoWrap"
                                                       HorizontalAlignment="Left"
                                                       Style="{DynamicResource TextBlockNormal}"
                                                       VerticalAlignment="Center"
                                                       Margin="10,0,0,0"
                                                       Grid.Row="1" />
                                            <TextBox x:Name="txtNoCopy2"
                                                     Margin="0,2"
                                                     TextWrapping="NoWrap"
                                                     Grid.Column="1"
                                                     MaxLength="4"
                                                     TextAlignment="Right"
                                                     Text="{Binding ReportModel.PrintCopy, UpdateSourceTrigger=PropertyChanged,Mode=TwoWay}"
                                                     Padding="2,0,2,0"
                                                     Grid.Row="1"
                                                     HorizontalAlignment="Left"
                                                     Width="50"
                                                     
                                                     Height="21" />
                                            <CheckBox x:Name="cbSetasdefaultprinter"
                                                      IsThreeState="False"
                                                      IsChecked="{Binding ReportModel.IsDefaultPrinter,Mode=TwoWay}"
                                                      Content="Set as default printer"
                                                      Grid.Column="1"
                                                      Margin="126,2,0,2"
                                                      Grid.Row="1"
                                                      HorizontalAlignment="Left"
                                                      VerticalAlignment="Center" />
                                        </Grid>
                                    </GroupBox>
                                    <StackPanel Visibility="{Binding IsShowChangePrintProperty}"
                                                VerticalAlignment="Center"
                                                Height="Auto"
                                                x:Name="stkpBtn"
                                                Orientation="Horizontal"
                                                HorizontalAlignment="Left"
                                                Grid.Row="1"
                                                Margin="10,0,0,0">
                                        <Button x:Name="btnOK"
                                                Height="28"
                                                Width="80"
                                                Command="{Binding ChangePrintPropertyCommand}">
                                            <StackPanel HorizontalAlignment="Center"
                                                        x:Name="stkpBtnOK"
                                                        VerticalAlignment="Center"
                                                        Orientation="Horizontal">
                                                <Rectangle x:Name="imgOK"
                                                           Fill="{DynamicResource OK}"
                                                           Height="20"
                                                           Width="20" />
                                                <TextBlock Margin="5,0,0,0"
                                                           VerticalAlignment="Center"
                                                           Text="OK"
                                                           TextWrapping="NoWrap"
                                                           x:Name="txtblOK"
                                                           Style="{DynamicResource ButtonTextBlock}" />
                                            </StackPanel>
                                        </Button>
                                        <Button x:Name="btnCancel"
                                                Command="{Binding CancelChangePrintPropertyCommand}"
                                                Height="28"
                                                Width="80"
                                                Margin="10,0,0,0">
                                            <StackPanel HorizontalAlignment="Center"
                                                        x:Name="stkpBtnCancel"
                                                        VerticalAlignment="Center"
                                                        Orientation="Horizontal">
                                                <Rectangle x:Name="imgCancel"
                                                           Fill="{DynamicResource Cancel}"
                                                           Height="20"
                                                           Width="20" />
                                                <TextBlock Margin="5,0,0,0"
                                                           x:Name="txtblExit"
                                                           VerticalAlignment="Center"
                                                           Text="Cancel"
                                                           TextWrapping="NoWrap"
                                                           Style="{DynamicResource ButtonTextBlock}" />
                                            </StackPanel>
                                        </Button>
                                    </StackPanel>
                                </Grid>
                                <Grid x:Name="grdSetCopies"
                                      Visibility="{Binding IsShowSetCopy}">
                                    <Grid.RowDefinitions>
                                        <RowDefinition Height="200" />
                                        <RowDefinition Height="50" />
                                    </Grid.RowDefinitions>
                                    <GroupBox x:Name="gbCopiesTo"
                                              Margin="10,10,10,0">
                                        <GroupBox.Header>
                                            <TextBlock x:Name="txtblPrintProperties1"
                                                       Text="Copies To"
                                                       TextWrapping="NoWrap"
                                                       Style="{DynamicResource GroupboxTextBlock}" />
                                        </GroupBox.Header>
                                        <Grid x:Name="grdgbCopiesTo"
                                              Margin="0,4,0,0">
                                            <Grid.RowDefinitions>
                                                <RowDefinition Height="Auto"
                                                               MinHeight="5.7" />
                                                <RowDefinition />

                                            </Grid.RowDefinitions>
                                            <DataGrid ItemsSource="{Binding CCReportModelCollection, Mode=TwoWay,UpdateSourceTrigger=PropertyChanged}"
                                                      AutoGenerateColumns="False"
                                                      CanUserAddRows="False"
                                                      IsReadOnly="True"
                                                      CanUserDeleteRows="False"
                                                      IsSynchronizedWithCurrentItem="True"
                                                      x:Name="dtgrdCopiesTo"
                                                      SelectedItem="{Binding ReportModel}"
                                                      Style="{DynamicResource DatagridWithRowHeader}"
                                                      Margin="5,0,5,5"
                                                      SelectionMode="Single"
                                                      Grid.Row="2">
                                                <DataGrid.Columns>
                                                    <DataGridTextColumn Header="Code"
                                                                        Binding="{Binding Code}"
                                                                        ElementStyle="{StaticResource CellMidleLeft}"
                                                                        Width="35"
                                                                        d:IsHidden="True" />
                                                    <DataGridTextColumn Header="Name"
                                                                        Binding="{Binding Name}"
                                                                        ElementStyle="{StaticResource CellMidleLeft}"
                                                                        Width="200"
                                                                        d:IsHidden="True" />
                                                    <DataGridTextColumn Header="CC. Name"
                                                                        Binding="{Binding CCReport}"
                                                                        ElementStyle="{StaticResource CellMidleLeft}"
                                                                        Width="*"
                                                                        d:IsHidden="True" />                                                </DataGrid.Columns>
                                            </DataGrid>
                                        </Grid>
                                    </GroupBox>
                                    <StackPanel VerticalAlignment="Center"
                                                Height="Auto"
                                                x:Name="stkpBtnNewDeleteHide"
                                                HorizontalAlignment="Left"
                                                Orientation="Horizontal"
                                                Margin="10,0,0,0"
                                                d:LayoutOverrides="GridBox"
                                                Grid.Row="2">
                                        <Button Command="{Binding NewSetCopyCommand}"
                                                x:Name="btnEdit1"
                                                Height="28"
                                                Width="80"
                                                Margin="0">
                                            <StackPanel HorizontalAlignment="Center"
                                                        x:Name="stkpBtnEdit1"
                                                        VerticalAlignment="Center"
                                                        Orientation="Horizontal">
                                                <Rectangle x:Name="imgEdit1"
                                                           Fill="{DynamicResource Edit}"
                                                           Height="20"
                                                           Width="20" />
                                                <TextBlock Margin="5,0,0,0"
                                                           x:Name="txtblEdit1"
                                                           VerticalAlignment="Center"
                                                           Text="Edit"
                                                           TextWrapping="NoWrap"
                                                           Style="{DynamicResource ButtonTextBlock}" />
                                            </StackPanel>
                                        </Button>
                                        <Button Command="{Binding DeleteSetCopyCommand}"
                                                x:Name="btnDelete1"
                                                Height="28"
                                                Width="80"
                                                Margin="10,0,0,0">
                                            <StackPanel HorizontalAlignment="Center"
                                                        x:Name="stkpBtnDelete1"
                                                        VerticalAlignment="Center"
                                                        Orientation="Horizontal">
                                                <Rectangle x:Name="imgDelete1"
                                                           Fill="{DynamicResource Delete}"
                                                           Height="20"
                                                           Width="20" />
                                                <TextBlock Margin="5,0,0,0"
                                                           VerticalAlignment="Center"
                                                           Text="Delete"
                                                           TextWrapping="NoWrap"
                                                           x:Name="txtblDelete1"
                                                           Style="{DynamicResource ButtonTextBlock}" />
                                            </StackPanel>
                                        </Button>
                                        <Button Command="{Binding HideSetCopyCommand}"
                                                x:Name="btnHide"
                                                Height="28"
                                                Width="80"
                                                Margin="10,0,0,0">
                                            <StackPanel HorizontalAlignment="Center"
                                                        x:Name="stkpBtnHide"
                                                        VerticalAlignment="Center"
                                                        Orientation="Horizontal">
                                                <Rectangle x:Name="imgHide"
                                                           Fill="{DynamicResource Hide}"
                                                           Height="20"
                                                           Width="20" />
                                                <TextBlock Margin="5,0,0,0"
                                                           VerticalAlignment="Center"
                                                           Text="Hide"
                                                           TextWrapping="NoWrap"
                                                           x:Name="txtblScreen1"
                                                           Style="{DynamicResource ButtonTextBlock}" />
                                            </StackPanel>
                                        </Button>
                                    </StackPanel>
                                </Grid>

                                <TabControl Visibility="{Binding IsShowSampleReport}"
                                            x:Name="TabSampleHistoryReport"
                                            Margin="10,0,10,10"
                                            Grid.Row="1">
                                    <TabItem x:Name="tabitemSampleReport"
                                             Header="Sample Report">
                                        <Grid x:Name="grdSampleReport">
                                            <Grid>
                                                <Image Name="reportImage"
                                                       Cursor="Hand"
                                                       Source="{Binding ReportModel.SamplePicture, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged, 
                                            Converter={StaticResource ResourceKey=imageConverter}}"
                                                       Stretch="Uniform">
                                                    <i:Interaction.Triggers>
                                                        <i:EventTrigger EventName="MouseLeftButtonUp">
                                                            <i:InvokeCommandAction Command="{Binding DataContext.ShowImageReportCommand,RelativeSource={RelativeSource AncestorLevel=1,AncestorType=Window,Mode=FindAncestor}}">
                                                            </i:InvokeCommandAction>
                                                        </i:EventTrigger>
                                                    </i:Interaction.Triggers>
                                                </Image>
                                            </Grid>
                                            <Border Visibility="Hidden">
                                                <Image Name="cursor"
                                                       Source="/Image/zoom.png"
                                                       Width="60"
                                                       Height="100"></Image>
                                            </Border>
                                        </Grid>
                                    </TabItem>
                                    <TabItem x:Name="tabitemHistoryPrintedList"
                                             Header="History Printed List">
                                        <Grid x:Name="grdHistoryPrintedList1_Copy">
                                            <Grid.RowDefinitions>
                                                <RowDefinition Height="Auto"
                                                               MinHeight="5.7" />
                                                <RowDefinition />
                                            </Grid.RowDefinitions>
                                            <DataGrid ItemsSource="{Binding PrintedCollection}"
                                                      AutoGenerateColumns="False"
                                                      CanUserAddRows="False"
                                                      IsReadOnly="True"
                                                      CanUserDeleteRows="False"
                                                      IsSynchronizedWithCurrentItem="True"
                                                      SelectionMode="Single"
                                                      SelectedItem="{Binding PrintedModel}"
                                                      x:Name="dtgrdHistoryPrintedList_Copy1"                                                      
                                                      Style="{DynamicResource DatagridWithRowHeader}"
                                                      Margin="5,0,5,5" 
                                                      Grid.Row="1">
                                                <DataGrid.Columns>
                                                    <DataGridTextColumn Header="File Name"
                                                                        Binding="{Binding FileName}"
                                                                        ElementStyle="{StaticResource CellMidleLeft}"
                                                                        Width="250"
                                                                        d:IsHidden="True" />
													<DataGridTextColumn Header="Date Printed"
                                                                        Binding="{Binding CreatedDate}"
                                                                        ElementStyle="{StaticResource CellMidleCenter}"
                                                                        Width="150"
                                                                        d:IsHidden="True" />
                                                                                                        
                                                </DataGrid.Columns>
                                                <i:Interaction.Triggers>
                                                    <i:EventTrigger EventName="MouseDoubleClick">
                                                        <i:InvokeCommandAction Command="{Binding DataContext.OpenPdfFileCommand,RelativeSource={RelativeSource AncestorLevel=1,AncestorType=Window,Mode=FindAncestor}}">                                                            
                                                        </i:InvokeCommandAction>
                                                    </i:EventTrigger>
                                                </i:Interaction.Triggers>
                                            </DataGrid>
                                        </Grid>
                                    </TabItem>
                                </TabControl>
                            </Grid>
                            <Grid x:Name="mainGrid"
                                  Visibility="{Binding IsShowMainGrid}">
                                <GroupBox Visibility="{Binding IsShowHiddenReport}"
                                          x:Name="gbAuthorize"
                                          Grid.Column="4"
                                          Margin="10">
                                    <GroupBox.Header>
                                        <TextBlock x:Name="txtblAuthorize"
                                                   Text="No Show Report List"
                                                   TextWrapping="NoWrap"
                                                   Style="{DynamicResource GroupboxTextBlock}" />
                                    </GroupBox.Header>
                                    <Grid x:Name="grdgbAuthorize"
                                          Margin="0,4,0,0">
                                        <Grid.RowDefinitions>
                                            <RowDefinition Height="Auto"
                                                           MinHeight="5.7" />
                                            <RowDefinition Height="Auto" />
                                            <RowDefinition />
                                        </Grid.RowDefinitions>
                                        <StackPanel Orientation="Horizontal"
                                                    Margin="0,10,0,10"
                                                    HorizontalAlignment="Left">
                                            <Button Command="{Binding ShowHiddenReportCommand}"
                                                    x:Name="btnShowHiddenReport"
                                                    Height="28"
                                                    Width="80"
                                                    Margin="10,0,0,0">
                                                <StackPanel HorizontalAlignment="Center"
                                                            x:Name="stkpBtnShowHiddenReport"
                                                            VerticalAlignment="Center"
                                                            Orientation="Horizontal">
                                                    <Rectangle x:Name="imgShowHiddenReport"
                                                               Fill="{DynamicResource Save}"
                                                               Height="20"
                                                               Width="20" />
                                                    <TextBlock Margin="5,0,0,0"
                                                               x:Name="txtblShowHiddenReport"
                                                               VerticalAlignment="Center"
                                                               Text="Save"
                                                               TextWrapping="NoWrap"
                                                               Style="{DynamicResource ButtonTextBlock}" />
                                                </StackPanel>
                                            </Button>
                                            <Button Command="{Binding DeleteHiddenReportCommand}"
                                                    x:Name="btnDeleteHiddenReport"
                                                    Height="28"
                                                    Width="80"
                                                    Margin="10,0,0,0">
                                                <StackPanel HorizontalAlignment="Center"
                                                            x:Name="stkpBtnDeleteHiddenReport"
                                                            VerticalAlignment="Center"
                                                            Orientation="Horizontal">
                                                    <Rectangle x:Name="imgDeleteHiddenReport"
                                                               Fill="{DynamicResource Delete}"
                                                               Height="20"
                                                               Width="20" />
                                                    <TextBlock Margin="5,0,0,0"
                                                               x:Name="txtblDeleteHiddenReport"
                                                               VerticalAlignment="Center"
                                                               Text="Delete"
                                                               TextWrapping="NoWrap"
                                                               Style="{DynamicResource ButtonTextBlock}" />
                                                </StackPanel>
                                            </Button>
                                        </StackPanel>
                                        <DataGrid IsSynchronizedWithCurrentItem="True"
                                                  CanUserAddRows="False"
                                                  CanUserDeleteRows="False"
                                                  ItemsSource="{Binding HiddenReportModelCollection}"
                                                  AutoGenerateColumns="False"
                                                  SelectedItem="{Binding HiddenReportModel}"
                                                  x:Name="dtgrdAuthorize"
                                                  Style="{DynamicResource DatagridWithRowHeader}"
                                                  SelectionMode="Single"
                                                  Margin="5,0,5,5"
                                                  Grid.Row="2">
                                            <DataGrid.Columns>
												<DataGridTemplateColumn Width="25">
                                                    <DataGridTemplateColumn.HeaderTemplate>
                                                        <DataTemplate>
                                                            <Grid>
                                                                <CheckBox x:Name="cbAllHiddenReport"
                                                                          HorizontalAlignment="Center"
                                                                          IsChecked="{Binding DataContext.IsCheckAllHiddenReport, RelativeSource={RelativeSource AncestorType=DataGrid,AncestorLevel=1,Mode=FindAncestor}, UpdateSourceTrigger=PropertyChanged, Mode=TwoWay}"
                                                                          Command="{Binding DataContext.CheckIsShowAllHiddenReportCommand, RelativeSource={RelativeSource AncestorType=DataGrid,AncestorLevel=1,Mode=FindAncestor}, UpdateSourceTrigger=PropertyChanged, Mode=TwoWay}"
                                                                          CommandParameter="{Binding ElementName=cbAllHiddenReport}">
                                                                </CheckBox>
                                                            </Grid>
                                                        </DataTemplate>
                                                    </DataGridTemplateColumn.HeaderTemplate>
                                                    <DataGridTemplateColumn.CellTemplate>
                                                        <DataTemplate>
                                                            <CheckBox x:Name="cbHiddenReport"
                                                                      HorizontalAlignment="Center"
                                                                      Command="{Binding DataContext.CheckIsShowHiddenReportCommand, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged,
                                                                                RelativeSource={RelativeSource AncestorLevel=1,AncestorType=DataGrid,Mode=FindAncestor}}"
                                                                      CommandParameter="{Binding ElementName=cbHiddenReport}"
                                                                      IsChecked="{Binding IsShow,UpdateSourceTrigger=PropertyChanged,Mode=TwoWay}">
                                                            </CheckBox>
                                                        </DataTemplate>
                                                    </DataGridTemplateColumn.CellTemplate>
                                                </DataGridTemplateColumn>
                                                <DataGridTextColumn Header="# Code"
                                                                    Binding="{Binding Code}"
                                                                    IsReadOnly="True"
                                                                    Width="60" />
                                                <DataGridTextColumn Header="ReportName"
                                                                    Binding="{Binding Name}"
                                                                    IsReadOnly="True"
                                                                    Width="*" />
                                                <DataGridTextColumn Header="User Created"
                                                                    Binding="{Binding UserCreated}"
                                                                    IsReadOnly="True"
                                                                    Width="150" />
                                                
                                            </DataGrid.Columns>
                                        </DataGrid>
                                    </Grid>
                                </GroupBox>
                                <Border x:Name="brdImage" Background="{DynamicResource UserControl_Background_ReportImage}" Visibility="{Binding IsShowMainScreen}"/>
                            </Grid>
                            <!--Edit report-->
                            <Grid x:Name="grdRightClick"
                                  Visibility="{Binding IsShowEditReport}"
                                  Background="#19FFFFFF">
                                <Grid.RowDefinitions>
                                    <RowDefinition Height="50" />
                                    <RowDefinition />
                                </Grid.RowDefinitions>
                                <StackPanel VerticalAlignment="Center"
                                            Height="Auto"
                                            x:Name="stkpBtnContentRightClick"
                                            Orientation="Horizontal"
                                            HorizontalAlignment="Left"
                                            Margin="10,0,0,0">
                                    <Button Command="{Binding NewReportCommand}"
                                            x:Name="btnNew"
                                            Height="28"
                                            Width="80"
                                            Margin="0">
                                        <StackPanel HorizontalAlignment="Center"
                                                    x:Name="stkpBtnNew"
                                                    VerticalAlignment="Center"
                                                    Orientation="Horizontal">
                                            <Rectangle x:Name="imgNew"
                                                       Fill="{DynamicResource New}"
                                                       Height="20"
                                                       Width="20" />
                                            <TextBlock Margin="5,0,0,0"
                                                       x:Name="txtblNew"
                                                       VerticalAlignment="Center"
                                                       Text="New"
                                                       TextWrapping="NoWrap"
                                                       Style="{DynamicResource ButtonTextBlock}" />
                                        </StackPanel>
                                    </Button>
                                    <Button Command="{Binding SaveReportCommand}"
                                            x:Name="btnSave"
                                            Height="28"
                                            Width="80"
                                            Margin="10,0,0,0">
                                        <StackPanel HorizontalAlignment="Center"
                                                    x:Name="stkpBtnSave"
                                                    VerticalAlignment="Center"
                                                    Orientation="Horizontal">
                                            <Rectangle x:Name="imgSave"
                                                       Fill="{DynamicResource Save}"
                                                       Height="20"
                                                       Width="20" />
                                            <TextBlock Margin="5,0,0,0"
                                                       x:Name="txtblSave"
                                                       VerticalAlignment="Center"
                                                       Text="Save"
                                                       TextWrapping="NoWrap"
                                                       Style="{DynamicResource ButtonTextBlock}" />
                                        </StackPanel>
                                    </Button>
                                    <Button Command="{Binding DeleteReportCommand}"
                                            x:Name="btnDelete"
                                            Height="28"
                                            Width="80"
                                            Margin="10,0,0,0">
                                        <StackPanel HorizontalAlignment="Center"
                                                    x:Name="stkpBtnDelete"
                                                    VerticalAlignment="Center"
                                                    Orientation="Horizontal">
                                            <Rectangle x:Name="imgDelete"
                                                       Fill="{DynamicResource Delete}"
                                                       Height="20"
                                                       Width="20" />
                                            <TextBlock Margin="5,0,0,0"
                                                       x:Name="txtblDelete"
                                                       VerticalAlignment="Center"
                                                       Text="Delete"
                                                       TextWrapping="NoWrap"
                                                       Style="{DynamicResource ButtonTextBlock}" />
                                        </StackPanel>
                                    </Button>
                                    <Button Command="{Binding PreviewReportCommand}"
                                            x:Name="btnPreview"
                                            Height="28"
                                            Width="80"
                                            Margin="10,0,0,0">
                                        <StackPanel HorizontalAlignment="Center"
                                                    x:Name="stkpBtnPreview"
                                                    VerticalAlignment="Center"
                                                    Orientation="Horizontal">
                                            <Rectangle x:Name="imgPreview"
                                                       Fill="{DynamicResource Preview}"
                                                       Height="20"
                                                       Width="20" />
                                            <TextBlock Margin="5,0,0,0"
                                                       VerticalAlignment="Center"
                                                       Text="Preview"
                                                       TextWrapping="NoWrap"
                                                       x:Name="txtblPreview"
                                                       Style="{DynamicResource ButtonTextBlock}" />
                                        </StackPanel>
                                    </Button>
                                    <Button Command="{Binding CloseReportCommand}"
                                            x:Name="btnClose"
                                            Height="28"
                                            Width="80"
                                            Margin="10,0,0,0">
                                        <StackPanel HorizontalAlignment="Center"
                                                    x:Name="stkpBtnClose"
                                                    VerticalAlignment="Center"
                                                    Orientation="Horizontal">
                                            <Rectangle x:Name="imgClose"
                                                       Fill="{DynamicResource Close}"
                                                       Height="20"
                                                       Width="20" />
                                            <TextBlock Margin="5,0,0,0"
                                                       x:Name="txtblClose"
                                                       VerticalAlignment="Center"
                                                       Text="Close"
                                                       TextWrapping="NoWrap"
                                                       Style="{DynamicResource ButtonTextBlock}" />
                                        </StackPanel>
                                    </Button>
                                </StackPanel>
                                <Rectangle Fill="White"
                                           HorizontalAlignment="Stretch"
                                           x:Name="Line"
                                           VerticalAlignment="Top"
                                           Height="1"
                                           Grid.Row="1"
                                           Margin="2,0" />
                                <Grid x:Name="grdContentReportRightClick"
                                      Grid.Row="6"
                                      Margin="0,10,0,0">
                                    <Grid.ColumnDefinitions>
                                        <ColumnDefinition Width="115" />
                                        <ColumnDefinition />
                                    </Grid.ColumnDefinitions>
                                    <Grid.RowDefinitions>
                                        <RowDefinition Height="25" />
                                        <RowDefinition Height="25" />
                                        <RowDefinition Height="25" />
                                        <RowDefinition Height="25" />
                                        <RowDefinition Height="25" />
                                        <RowDefinition Height="25" />
                                        <RowDefinition Height="25" />
                                        <RowDefinition Height="25" />
                                        <RowDefinition Height="25" />
                                        <RowDefinition Height="25" />
                                        <RowDefinition Height="25" />
                                        <RowDefinition Height="25" />
                                        <RowDefinition Height="25" />
                                        <RowDefinition Height="0" />
                                        <RowDefinition Height="0" />
                                        <RowDefinition />
                                    </Grid.RowDefinitions>
                                    <TextBlock x:Name="txtblReportCode"
                                               Text="Report Code"
                                               TextWrapping="NoWrap"
                                               HorizontalAlignment="Left"
                                               Style="{DynamicResource TextBlockNormal}"
                                               VerticalAlignment="Center"
                                               Margin="10,0,0,0" />
                                    <TextBox x:Name="txtReportCode"
                                             Text="{Binding ReportModel.Code, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged, ValidatesOnDataErrors=True}"
                                             behaviour:AutoFocusBehavior.IsFocused="{Binding FocusDefault, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}"
                                             Margin="0,2"
                                             MaxLength="4"
                                             TextWrapping="NoWrap"
                                             Grid.Column="1"
                                             Padding="2,0,2,0"
                                             HorizontalAlignment="Left"
                                             Width="70"                                             
                                             d:LayoutOverrides="HorizontalAlignment">
                                        <i:Interaction.Triggers>
                                            <i:EventTrigger EventName="TextChanged">
                                                <i:InvokeCommandAction Command="{Binding ReportCodeLostFocusCommand}">
                                                </i:InvokeCommandAction>
                                            </i:EventTrigger>                                                
                                        </i:Interaction.Triggers>
                                        <i:Interaction.Behaviors>
                                            <behaviour:AutoFocusBehavior />
                                        </i:Interaction.Behaviors>
                                    </TextBox>
                                    <TextBlock x:Name="txtblReportGroup"
                                               Text="Parent Report "
                                               TextWrapping="NoWrap"
                                               HorizontalAlignment="Left"
                                               Style="{DynamicResource TextBlockNormal}"
                                               Margin="136,0,0,0"
                                               Grid.Column="1"
                                               d:LayoutOverrides="Height" VerticalAlignment="Center" />
                                    <ComboBox x:Name="cmbReportGroup"
                                              ItemsSource="{Binding ParentReportModelCollection}"
                                              SelectedValuePath="Id"
                                              DisplayMemberPath="Name"
                                              SelectedValue="{Binding ReportModel.ParentId, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged,NotifyOnValidationError=False,ValidatesOnExceptions=False,ValidatesOnDataErrors=False}"
                                              Margin="216,2,0,2"
                                              Grid.Column="1"
                                              Width="157"
                                              HorizontalAlignment="Left" />
                                    <TextBlock x:Name="txtblReportName"
                                               Text="Report Name"
                                               TextWrapping="NoWrap"
                                               HorizontalAlignment="Left"
                                               Style="{DynamicResource TextBlockNormal}"
                                               VerticalAlignment="Center"
                                               Margin="10,0,0,0"
                                               Grid.Row="1" />
                                    <TextBox x:Name="cmbReportName"
                                             MaxLength="200"
                                             Text="{Binding ReportModel.Name, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged, ValidatesOnDataErrors=True}"
                                             Margin="0,2,10,2"
                                             Grid.Column="1"
                                             Grid.Row="1"
                                             HorizontalAlignment="Left"                                             
                                             Width="373">
                                    </TextBox>
                                    <TextBlock x:Name="txtblPrinterName"
                                               Text="Printer Name"
                                               TextWrapping="NoWrap"
                                               HorizontalAlignment="Left"
                                               Style="{DynamicResource TextBlockNormal}"
                                               VerticalAlignment="Center"
                                               Margin="10,0,0,0"
                                               Grid.Row="2" />
                                    <ComboBox x:Name="cmbPrinterName"
                                              ItemsSource="{Binding InstalledPrinters}"
                                              SelectedItem="{Binding ReportModel.PrinterName, Mode=TwoWay, ValidatesOnDataErrors=True}"
                                              Margin="0,2,10,2"
                                              Grid.Column="1"
                                              Grid.Row="2"
                                              HorizontalAlignment="Left"
                                              Width="373" />
                                    <TextBlock x:Name="txtblReportFile"
                                               Text="Report File"
                                               TextWrapping="NoWrap"
                                               HorizontalAlignment="Left"
                                               Style="{DynamicResource TextBlockNormal}"
                                               VerticalAlignment="Center"
                                               Margin="10,0,0,0"
                                               Grid.Row="3" />
                                    <TextBox x:Name="txtReportFile"
                                             Text="{Binding ReportModel.FormatFile, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged, ValidatesOnDataErrors=True}"
                                             Margin="0,2"
                                             MaxLength="50"
                                             TextWrapping="NoWrap"
                                             Grid.Column="1"
                                             Padding="2,0,2,0"
                                             Grid.Row="3"
                                             Width="345"                                             
                                             HorizontalAlignment="Left">
                                    </TextBox>
                                    <Button x:Name="btnReportFile"
                                            Command="{Binding ReportFileCommand}"
                                            Margin="352,2,10,2"
                                            Content="..."
                                            Grid.Row="3"
                                            Height="21"
                                            Grid.Column="1"
                                            HorizontalAlignment="Left"
                                            Width="21" />
                                    <TextBlock x:Name="txtblPaperSize"
                                               Text="Paper Size"
                                               TextWrapping="NoWrap"
                                               HorizontalAlignment="Left"
                                               Style="{DynamicResource TextBlockNormal}"
                                               VerticalAlignment="Center"
                                               Margin="10,0,0,0"
                                               Grid.Row="4" />
                                    <ComboBox x:Name="cmbPaperSize"
                                              ItemsSource="{Binding PaperSizeCollection}"
                                              SelectedValuePath="Value"
                                              DisplayMemberPath="Text"
                                              SelectedIndex="{Binding ReportModel.PaperSize, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged,ValidatesOnDataErrors=True}"
                                              Margin="0,2"
                                              Width="120"
                                              HorizontalAlignment="Left"
                                              Grid.Column="1"
                                              Grid.Row="4"
                                              IsEnabled="False"
                                              d:LayoutOverrides="HorizontalAlignment" />
                                    <TextBlock x:Name="txtblNoCopy"
                                               Text="# of Copy"
                                               TextWrapping="NoWrap"
                                               HorizontalAlignment="Left"
                                               Style="{DynamicResource TextBlockNormal}"
                                               VerticalAlignment="Center"
                                               Margin="191.556,0,0,0"
                                               Grid.Row="4"
                                               Grid.Column="1" />
                                    <TextBox x:Name="txtNoCopy"
                                             Text="{Binding ReportModel.PrintCopy, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}"
                                             Margin="253,2,10,2"
                                             TextWrapping="NoWrap"
                                             Grid.Column="1"
                                             MaxLength="4"
                                             TextAlignment="Right"
                                             Padding="2,0,2,0"
                                             Grid.Row="4"
                                             Width="120"                                             
                                             HorizontalAlignment="Left" />
                                    <TextBlock x:Name="txtblPreprocessName"
                                               Text="Preprocess Name"
                                               TextWrapping="NoWrap"
                                               HorizontalAlignment="Left"
                                               Style="{DynamicResource TextBlockNormal}"
                                               VerticalAlignment="Center"
                                               Margin="10,0,0,0"
                                               Grid.Row="5" />
                                    <TextBox x:Name="txtPreprocessName"
                                             Text="{Binding ReportModel.PreProcessName, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}"
                                             Margin="0,2"
                                             TextWrapping="NoWrap"
                                             Grid.Column="1"
                                             Padding="2,0,2,0"
                                             MaxLength="50"
                                             HorizontalAlignment="Left"
                                             Width="120"
                                             d:LayoutOverrides="HorizontalAlignment"                                             
                                             Grid.Row="5" />
                                    <TextBlock x:Name="txtblPreprocessDescription"
                                               Text="Preprocess Description"
                                               TextWrapping="NoWrap"
                                               HorizontalAlignment="Left"
                                               Style="{DynamicResource TextBlockNormal}"
                                               Margin="130,0,0,0"
                                               Grid.Row="5"
                                               Grid.Column="1"
                                               VerticalAlignment="Center" />
                                    <TextBox x:Name="txtPreprocessDescription"
                                             Text="{Binding ReportModel.PrepProcessDescription, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}"
                                             Margin="253,2,10,2"
                                             TextWrapping="NoWrap"
                                             Grid.Column="1"
                                             MaxLength="200"
                                             Padding="2,0,2,0"
                                             Grid.Row="5"
                                             Width="120"                                             
                                             HorizontalAlignment="Left" />
                                    <TextBlock x:Name="txtblReportInformation"
                                               Text="Report Information"
                                               TextWrapping="NoWrap"
                                               HorizontalAlignment="Left"
                                               Style="{DynamicResource TextBlockNormal}"
                                               Margin="10,0,0,0"
                                               Grid.Row="6"
                                               d:LayoutOverrides="Height"
                                               VerticalAlignment="Center" />
                                    <TextBox x:Name="txtReportInformation"
                                             MaxLength="200"
                                             Margin="0,2,10,2"
                                             Grid.Column="1"
                                             Grid.Row="6"
                                             VerticalContentAlignment="Top"
                                             TextWrapping="Wrap"
                                             Text="{Binding ReportModel.Remark,Mode=TwoWay,UpdateSourceTrigger=PropertyChanged}"
                                             Grid.RowSpan="3"
                                             Width="373"                                             
                                             HorizontalAlignment="Left" />
                                    <TextBlock x:Name="txtblSampleReport"
                                               Text="Sample Report"
                                               TextWrapping="NoWrap"
                                               HorizontalAlignment="Left"
                                               Style="{DynamicResource TextBlockNormal}"
                                               Margin="10,0,0,0"
                                               Grid.Row="9"
                                               d:LayoutOverrides="Height"
                                               VerticalAlignment="Center" />
                                    <Border x:Name="brdSampleReport"
                                            BorderThickness="1"
                                            Width="160"
                                            HorizontalAlignment="Left"
                                            BorderBrush="White"
                                            Background="#19FFFFFF"
                                            Grid.Column="1"
                                            Grid.Row="9"
                                            Grid.RowSpan="4"
                                            Margin="0,0,0,2">
                                        <Image Source="{Binding ReportModel.SamplePicture, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged, Converter={StaticResource ResourceKey=imageConverter}}"
                                               Stretch="Fill" />
                                    </Border>
                                    <Button Command="{Binding LoadSamplePictureReportCommand}"
                                            x:Name="btnLoadPicture"
                                            Margin="170,2,0,2"
                                            Grid.Column="1"
                                            Grid.Row="9"
                                            Width="100"
                                            HorizontalAlignment="Left">
                                        <StackPanel HorizontalAlignment="Center"
                                                    x:Name="stkpBtnLoadPicture"
                                                    VerticalAlignment="Center"
                                                    Orientation="Horizontal">
                                            <Rectangle x:Name="imgLoadPicture"
                                                       Fill="{DynamicResource Update}"
                                                       Height="18"
                                                       Width="18" />
                                            <TextBlock Margin="5,0,0,0"
                                                       VerticalAlignment="Center"
                                                       Text="Load Picture"
                                                       TextWrapping="NoWrap"
                                                       x:Name="txtblLoadPicture"
                                                       Style="{DynamicResource ButtonTextBlock}" />
                                        </StackPanel>
                                    </Button>
                                    <Button Command="{Binding ClearSamplePictureReportCommand}"
                                            x:Name="btnClearPicture"
                                            Margin="170,2,0,2"
                                            Grid.Column="1"
                                            Grid.Row="10"
                                            Width="100"
                                            HorizontalAlignment="Left">
                                        <StackPanel HorizontalAlignment="Center"
                                                    x:Name="stkpBtnClearPicture"
                                                    VerticalAlignment="Center"
                                                    Orientation="Horizontal">
                                            <Rectangle x:Name="imgClearPicture"
                                                       Fill="{DynamicResource Clear}"
                                                       Height="18"
                                                       Width="18" />
                                            <TextBlock Margin="5,0,0,0"
                                                       VerticalAlignment="Center"
                                                       Text="Clear Picture"
                                                       TextWrapping="NoWrap"
                                                       x:Name="txtblClearPicture"
                                                       Style="{DynamicResource ButtonTextBlock}" />
                                        </StackPanel>
                                    </Button>
                                </Grid>
                            </Grid>
                        </Grid>
                    </Grid>

                </Border>
                <Border x:Name="brdStatusBar"
                        Grid.Row="2"
                        Height="26"
                        Background="{DynamicResource Bottom_TitleBar_Background}"
                        BorderBrush="{DynamicResource Bottom_TitleBar_Border}"
                        BorderThickness="0,1,0,0">
                    <DockPanel>
                		<StatusBarItem Margin="3,3,0,1"
                                       Style="{DynamicResource StatusBarItem}">
                            <StackPanel x:Name="stkpUser"
                                        Margin="3,0"
                                        Orientation="Horizontal">
                                <Button x:Name="btnChangePassword"
                                        Command="{Binding ChangePasswordCommand}"
                                        Width="14"
                                        Height="14"
                                        Margin="0,0,5,0"
                                        HorizontalAlignment="Left"
                                        Style="{DynamicResource ButtonBarLock}">
                                    <Rectangle x:Name="imgLock"
                                               Width="16"
                                               Height="16"
                                               ToolTip="Change password"
                                               Fill="{DynamicResource Password}" />
                                </Button>
                                <TextBlock x:Name="tbUserLogin"
                                           Margin="0,0,2,0"
										   HorizontalAlignment="Left"
                                           Foreground="Red"
                                           Style="{DynamicResource StatusBarItemTextBlock}"
                                           Text="{Binding UserLoginName}"    
                                           ToolTip="Login name"
                                           TextWrapping="Wrap"
                                           VerticalAlignment="Center" />
                            </StackPanel>
                        </StatusBarItem>
                		<StatusBarItem Margin="2,3,0,1"
                			Style="{DynamicResource StatusBarItem}">
                			<StackPanel x:Name="stkpStore1"
                				Margin="3,0"
                				Orientation="Horizontal">
                				<Rectangle x:Name="imgWorkStation"
                					Width="14"
                					Height="14"
                					Margin="0,0,5,0"
                					Fill="{DynamicResource WorkStation}" />
                				<TextBlock x:Name="txtblServer"
                					Margin="0,0,2,0"        
                                           ToolTip="Computer name"
                					Style="{DynamicResource StatusBarItemTextBlock}"     
                                           Text="{Binding ComputerName}"
                					VerticalAlignment="Center" />
                			</StackPanel>
                		</StatusBarItem>
                		<StatusBarItem Margin="2,3,0,1"
                                       Style="{DynamicResource StatusBarItem}">
                            <StackPanel Margin="3,0"
                                        Orientation="Horizontal">
                                <Rectangle x:Name="imgDatabase"
                                           Width="14"
                                           Height="14"
                                           Margin="0,0,5,0"
                                           Fill="{DynamicResource DataBase}" />
                                <TextBlock x:Name="txtblDatabse"
                                           Margin="0,0,2,0"
                                           ToolTip="Database name"
                                           Style="{DynamicResource StatusBarItemTextBlock}"
                                           Text="{Binding DatabaseName}"
                                           VerticalAlignment="Center" />
                            </StackPanel>
                        </StatusBarItem>
						
						<StatusBarItem Margin="2,3,0,1"
                                       Style="{DynamicResource StatusBarItem}">
                            <StackPanel Margin="3,0"
                                        Orientation="Horizontal">
                                <Rectangle x:Name="imgOClock"
                                           Width="14"
                                           Height="14"
                                           Margin="0,0,5,0"
                                           Fill="{DynamicResource TaskReminder}" />
                                <TextBlock x:Name="txtblOClock"
                                           Margin="0,0,2,0"
                                           ToolTip="Current date and time"
                                           Style="{DynamicResource StatusBarItemTextBlock}"
                                           Text=""
                                           VerticalAlignment="Center" />
                            </StackPanel>
                        </StatusBarItem>
                	</DockPanel>
                </Border>
            </Grid>

        </Grid>
    </ExtendWPFToolKit:BusyIndicator>
</r:RibbonWindow>