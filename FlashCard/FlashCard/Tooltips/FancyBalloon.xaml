<UserControl xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             xmlns:tb="http://www.hardcodet.net/taskbar"
             xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
             xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
             mc:Ignorable="d"
             x:Class="FlashCard.FancyBalloon"
             xmlns:attachedCmd="clr-namespace:AttachedCommandBehavior;assembly=AttachedCommandBehavior"
             xmlns:converter="clr-namespace:FlashCard.Converters"
             x:Name="me"
             Height="150"
             Width="300">
    <UserControl.Resources>
        <!--#Region Converters-->
        <converter:BooleanToVisibilityConverter x:Key="booleanToVisibilityConverter" />
        <converter:ValueToVisibilityConverter x:Key="valueToVisibilityConverter" />
        <!--#End Region-->
        <!--#region Storyboard-->
        <Storyboard x:Key="FadeIn">
            <DoubleAnimationUsingKeyFrames BeginTime="00:00:00"
                                           Storyboard.TargetName="grid"
                                           Storyboard.TargetProperty="(UIElement.Opacity)">
                <SplineDoubleKeyFrame KeyTime="00:00:00"
                                      Value="0" />
                <SplineDoubleKeyFrame KeyTime="00:00:01"
                                      Value="0.95" />
                <SplineDoubleKeyFrame KeyTime="00:00:03"
                                      Value="0.95" />
                <!--				<SplineDoubleKeyFrame KeyTime="00:00:05" Value="0"/>-->
            </DoubleAnimationUsingKeyFrames>
        </Storyboard>
        <Storyboard x:Key="HighlightCloseButton">
            <DoubleAnimationUsingKeyFrames BeginTime="00:00:00"
                                           Storyboard.TargetName="imgClose"
                                           Storyboard.TargetProperty="(UIElement.Opacity)">
                <SplineDoubleKeyFrame KeyTime="00:00:00"
                                      Value="0.4" />
                <SplineDoubleKeyFrame KeyTime="00:00:00.3000000"
                                      Value="1" />
            </DoubleAnimationUsingKeyFrames>
        </Storyboard>
        <Storyboard x:Key="FadeCloseButton">
            <DoubleAnimationUsingKeyFrames BeginTime="00:00:00"
                                           Storyboard.TargetName="imgClose"
                                           Storyboard.TargetProperty="(UIElement.Opacity)">
                <SplineDoubleKeyFrame KeyTime="00:00:00"
                                      Value="1" />
                <SplineDoubleKeyFrame KeyTime="00:00:00.3000000"
                                      Value="0.4" />
            </DoubleAnimationUsingKeyFrames>
        </Storyboard>
        <Storyboard x:Key="FadeBack">
            <DoubleAnimationUsingKeyFrames BeginTime="00:00:00"
                                           Storyboard.TargetName="grid"
                                           Storyboard.TargetProperty="(UIElement.Opacity)">
                <SplineDoubleKeyFrame KeyTime="00:00:00"
                                      Value="1" />
                <SplineDoubleKeyFrame KeyTime="00:00:00.3000000"
                                      Value="1" />
            </DoubleAnimationUsingKeyFrames>
        </Storyboard>
        <Storyboard x:Key="FadeOut"
                    Completed="OnFadeOutCompleted">
            <DoubleAnimationUsingKeyFrames BeginTime="00:00:00"
                                           Storyboard.TargetName="grid"
                                           Storyboard.TargetProperty="(UIElement.Opacity)">
                <SplineDoubleKeyFrame KeyTime="00:00:00"
                                      Value="1" />
                <SplineDoubleKeyFrame KeyTime="00:00:00.3000000"
                                      Value="0.2" />
            </DoubleAnimationUsingKeyFrames>
        </Storyboard>
        <!--#end region Storyboard-->
    </UserControl.Resources>
    <UserControl.Triggers>
        <EventTrigger RoutedEvent="tb:TaskbarIcon.BalloonShowing">
            <BeginStoryboard Storyboard="{StaticResource FadeIn}"
                             x:Name="FadeIn_BeginStoryboard" />
        </EventTrigger>
        <EventTrigger RoutedEvent="Mouse.MouseEnter"
                      SourceName="imgClose">
            <BeginStoryboard Storyboard="{StaticResource HighlightCloseButton}"
                             x:Name="HighlightCloseButton_BeginStoryboard" />
        </EventTrigger>
        <EventTrigger RoutedEvent="Mouse.MouseLeave"
                      SourceName="imgClose">
            <BeginStoryboard Storyboard="{StaticResource FadeCloseButton}"
                             x:Name="FadeCloseButton_BeginStoryboard" />
        </EventTrigger>
        <EventTrigger RoutedEvent="Mouse.MouseEnter">
            <StopStoryboard BeginStoryboardName="FadeIn_BeginStoryboard" />
            <BeginStoryboard x:Name="FadeBack_BeginStoryboard1"
                             Storyboard="{StaticResource FadeBack}" />
        </EventTrigger>
        <EventTrigger RoutedEvent="tb:TaskbarIcon.BalloonClosing">
            <BeginStoryboard Storyboard="{StaticResource FadeOut}"
                             x:Name="FadeOut_BeginStoryboard" />
        </EventTrigger>
    </UserControl.Triggers>
    <Grid x:Name="grid"
          MinHeight="120"
          MinWidth="240"
          MouseEnter="grid_MouseEnter">
        <attachedCmd:CommandBehaviorCollection.Behaviors>
            <attachedCmd:BehaviorBinding Event="MouseEnter"
                                         Command="{Binding FancyBallonMouseEnterCommand}" />
            <attachedCmd:BehaviorBinding Event="MouseLeave"
                                         Command="{Binding FancyBallonMouseLeaveCommand}" />
        </attachedCmd:CommandBehaviorCollection.Behaviors>
        <Grid.ColumnDefinitions>
            <ColumnDefinition />
        </Grid.ColumnDefinitions>
        <Grid.RowDefinitions>
            <RowDefinition Height="47.363" />
            <RowDefinition />
            <RowDefinition Height="37.5" />
        </Grid.RowDefinitions>
        <Border x:Name="bdContent" HorizontalAlignment="Stretch"
                Margin="3,0,3,3"
                BorderThickness="1,1,1,1"
                BorderBrush="Gray"
                Opacity="0.75"
                Grid.RowSpan="3">
            <Border.Effect>
                <DropShadowEffect Color="#FF747474" />
            </Border.Effect>
            <Border.Background>
                <LinearGradientBrush EndPoint="0.5,1"
                                     StartPoint="0.5,0">
                    <GradientStop Color="#FF31889F"
                                  Offset="0" />
                    <GradientStop Color="#FF26C9DE"
                                  Offset="1" />
                </LinearGradientBrush>
            </Border.Background>
        </Border>
        <Path Fill="#FFFFFFFF"
              Stretch="Fill"
              Margin="71.98,0,33.92,8.133"
              VerticalAlignment="Bottom"
              Height="1"
              Data="M26,107 L220.04123,107"
              SnapsToDevicePixels="True" d:IsHidden="True" Visibility="Collapsed">
            <Path.Stroke>
                <LinearGradientBrush EndPoint="0.973,0.5"
                                     StartPoint="0.005,0.5">
                    <GradientStop Color="#00ECAD25"
                                  Offset="1" />
                    <GradientStop Color="#87ECAD25"
                                  Offset="0" />
                </LinearGradientBrush>
            </Path.Stroke>
        </Path>
        <StackPanel x:Name="stkNavigator"
                    Orientation="Horizontal"
                    Grid.Row="2"
                    d:LayoutOverrides="Height"
                    HorizontalAlignment="Right"
                    Margin="0,0,5,7">
            <Button Content="Previous"
                    VerticalAlignment="Center"
                    HorizontalAlignment="Left"
                    Width="51" />
            <Button Content="Next"
                    VerticalAlignment="Center"
                    HorizontalAlignment="Right"
                    Width="51" />

        </StackPanel>
        <TextBlock x:Name="tbInformation"
                   HorizontalAlignment="Left"
                   TextWrapping="Wrap"
                   Text="{Binding Path=SelectedLesson.TypeModel.Name}"
                   VerticalAlignment="Top"
                   Margin="6,6,0,0"
                   Foreground="#FFFDFDFD"
                   FontWeight="Bold" />
        <Grid x:Name="grdGrammard"
              Grid.Row="1" />
        <Grid x:Name="grdVocabulary"
              Grid.Row="1"
              Grid.RowSpan="2">
            <Grid.RowDefinitions>
                <RowDefinition />
                <RowDefinition Height="36.949" />
            </Grid.RowDefinitions>
            <TextBlock x:Name="tbWords"
                       Text="{Binding Path=SelectedLesson.LessonName}"
                       Visibility="{Binding SelectedLesson.IsBackSide,Mode=OneWay,UpdateSourceTrigger=PropertyChanged,Converter={StaticResource booleanToVisibilityConverter},ConverterParameter=false}"
                       HorizontalAlignment="Center"
                       TextWrapping="Wrap"
                       VerticalAlignment="Center"
                       FontWeight="Bold"
                       Foreground="White"
                       FontSize="16" />
            <Button x:Name="btnBackSide"
                    Content="{Binding SelectedLesson.SideName,UpdateSourceTrigger=PropertyChanged}"
                    Command="{Binding ChangeSideCommand}"
                    HorizontalAlignment="Left"
                    VerticalAlignment="Top"
                    Width="75"
                    Grid.Row="1"
                    Margin="4,5,0,0" />
            <TextBlock x:Name="tblWordBackSide"
                       Text="{Binding Path=SelectedLesson.BackSideCollection[0].Content}"
                       Visibility="{Binding SelectedLesson.IsBackSide,Mode=OneWay,UpdateSourceTrigger=PropertyChanged,Converter={StaticResource booleanToVisibilityConverter},ConverterParameter=true}"
                       HorizontalAlignment="Left"
                       TextWrapping="Wrap"
                       VerticalAlignment="Top"
                       Foreground="White"
                       Margin="10,5,0,0" />
        </Grid>
        <Grid x:Name="grdSingleChoice" Grid.RowSpan="2" Grid.Row="1" d:IsHidden="True" Visibility="Collapsed">
        	<ListBox HorizontalAlignment="Left" Margin="0,0,0,2.637" Width="100">
        		     	
			</ListBox>
        </Grid>
        <Grid x:Name="grdMultiChoice" Grid.RowSpan="2" Grid.Row="1"/>
        <Border x:Name="bdHeader" BorderBrush="#4C333332" BorderThickness="1" Margin="8,0,8,4" CornerRadius="0,0,5,5" Opacity="0.5">
        	<Border.Background>
        		<LinearGradientBrush EndPoint="0.5,1" StartPoint="0.5,0">
        			<GradientStop Color="#CCF3F0F0" Offset="0.071"/>
        			<GradientStop Color="#BFB8B5B5" Offset="0.129"/>
        			<GradientStop Color="#CCB1B1B1" Offset="0.957"/>
        			<GradientStop Color="#FFB1B1B1" Offset="1"/>
        			<GradientStop Color="#E56A6969" Offset="0"/>
        			<GradientStop Color="#C1B7B4B4" Offset="0.886"/>
        		</LinearGradientBrush>
        	</Border.Background>
        	<Border.Effect>
        		<DropShadowEffect BlurRadius="3" ShadowDepth="4" Opacity="0.5" Direction="292"/>
        	</Border.Effect>
        </Border>
        <Image HorizontalAlignment="Right"
               Margin="0,10,15,21.333"
               Width="16"
               Source="/Images/Close.png"
               Stretch="Fill"
               ToolTip="Close Balloon"
               x:Name="imgClose"
               MouseDown="imgClose_MouseDown" />
    </Grid>
</UserControl>
